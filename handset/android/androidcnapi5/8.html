<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->


<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->





        
<div class=WordSection8 style='layout-grid:15.6pt'><br clear=all
style='page-break-before:always'>

<p class=MsoNormal align=center style='text-align:center'><a name=monkeyrunner><b>monkeyrunner</b></a></p>

<p class=MsoNormal align=center style='text-align:center'>署名：译言biAji </p>

<p class=MsoNormal align=center style='text-align:center'>链接：http://developer.android.com/guide/developing/tools/monkeyrunner_concepts.html
</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>monkeyrunner工具提供了一个API，使用此API写出的程序可以在Android代码之外控制Android设备和模拟器。通过monkeyrunner，您可以写出一个Python程序去安装一个Android应用程序或测试包，运行它，向它发送模拟击键，截取它的用户界面图片，并将截图存储于工作站上。monkeyrunner工具的主要设计目的是用于测试功能/框架水平上的应用程序和设备，或用于运行单元测试套件，但您当然也可以将其用于其它目的。</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>monkeyrunner工具与(<u>UI/Application
Exerciser Monkey</u>)用户界面/应用程序测试工具，也称为monkey工具并无关联。<code>monkey</code>工具直接运行在设备或模拟器的<code>adb </code>shell中，生成用户或系统的伪随机事件流。而monkeyrunner工具则是在工作站上通过API定义的特定命令和事件控制设备或模拟器。</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>monkeyrunner工具为Android测试提供了以下特性：</p>

<p class=MsoNormal align=left style='margin-left:44.25pt;text-align:left;
text-indent:-21.0pt'>l&nbsp; 多设备控制：monkeyrunner&nbsp;&nbsp;&nbsp;&nbsp;API可以跨多个设备或模拟器实施测试套件。您可以在同一时间接上所有的设备或一次启动全部模拟器（或统统一起），依据程序依次连接到每一个，然后运行一个或多个测试。您也可以用程序启动一个配置好的模拟器，运行一个或多个测试，然后关闭模拟器。</p>

<p class=MsoNormal align=left style='margin-left:44.25pt;text-align:left;
text-indent:-21.0pt'>l&nbsp; 功能测试：&nbsp;&nbsp;&nbsp;&nbsp;monkeyrunner可以为一个应用自动贯彻一次功能测试。您提供按键或触摸事件的输入数值，然后观察输出结果的截屏。</p>

<p class=MsoNormal align=left style='margin-left:44.25pt;text-align:left;
text-indent:-21.0pt'>l&nbsp; 回归测试：monkeyrunner可以运行某个应用，并将其结果截屏与既定已知正确的结果截屏相比较，以此测试应用的稳定性。&nbsp;</p>

<p class=MsoNormal align=left style='margin-left:44.25pt;text-align:left;
text-indent:-21.0pt'>l&nbsp; 可扩展的自动化：由于monkeyrunner是一个API工具包，您可以基于Python模块和程序开发一整套系统，以此来控制Android设备。除了使用monkeyrunner&nbsp;&nbsp;&nbsp;&nbsp;API之外，您还可以使用标准的Python&nbsp;&nbsp;&nbsp;&nbsp;<code>Android
Debug Bridge这样的Android工具&nbsp;&nbsp;&nbsp;&nbsp;。&nbsp;&nbsp;&nbsp;&nbsp; </p>

<p class=MsoNormal align=left style='margin-left:44.25pt;text-align:left'>您还可以向monkeyrunner API中添加您自己的类。我们将在使用插件扩展monkeyrunner一节中对此进行详细讨论 。</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; monkeyrunner工具使用Jython（使用Java编程语言的一种Python实现）。Jython允许monkeyrunnerAPI与Android框架轻松的进行交互。使用Jython，您可以使用Python语法来获取API中的常量、类以及方法。</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><b>一个简单的</b><b>monkeyrunner</b><b>程序实例</b><b>(A
Simple monkeyrunner Program)</b></p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 以下为一个简单的monkeyrunner程序，它将会连接到一个设备，创建一个MonkeyDevice对象。使用MonkeyDevice对象，程序将安装一个Android应用包，运行其中一个活动，并向其发送按键事件。程序接下来会将结果截图，创建一个MonkeyImage对象，并使用这个对象截图将保存至.png文件。</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><img border=0 width=553 height=388
src="images/image013.jpg"></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt'><b>The monkeyrunner API</b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>monkeyrunnerAPI于com.android.monkeyrunner包中包含三个模块：</p>

<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:-21.0pt'>l&nbsp; <code>MonkeyRunner</code>：一个为monkeyrunner程序提供工具方法的类。这个类提供了用于连接monkeyrunner至设备或模拟器的方法。它还提供了用于创建一个monkeyrunner程序的用户界面以及显示内置帮助的方法。&nbsp;</p>

<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:-21.0pt'>l&nbsp; &nbsp;<code>MonkeyDevice</code>：表示一个设备或模拟器。这个类提供了安装和卸载程序包、启动一个活动以及发送键盘或触摸事件到应用程序的方法。您也可以用这个类来运行测试包。&nbsp;&nbsp;</p>

<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:-21.0pt'>l&nbsp; <code>MonkeyImage</code>：表示一个截图对象。这个类提供了截图、将位图转换成各种格式、比较两个MonkeyImage对象以及写图像到文件的方法。</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>在python程序中，您将以Python模块的形式使用这些类。monkeyrunner工具不会自动导入这些模块。您必须使用类似如下的from语句：</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><img border=0 width=434 height=38
src="images/image014.png"></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>其中，为您想要导入的类名。您可以在一个from语句中导入超过一个模块，其间以逗号分隔。</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center;text-indent:21.0pt'><b>Running monkeyrunner</b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>您可以直接使用一个代码文件运行monkeyrunner，抑或在交互式对话中输入monkeyrunner语句。不论使用哪种方式，您都需要调用SDK目录的tools子目录下的monkeyrunner命令。如果您提供一个文件名作为运行参数，则monkeyrunner将视文件内容为Python程序，并加以运行；否则，它将提供一个交互对话环境。</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>monkeyrunner命令的语法为：</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><img border=0 width=511 height=38
src="images/image015.png"></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>表 1阐释了命令的标志和参数。</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=539
 style='margin-left:26.7pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=161 valign=top style='width:120.45pt;border:solid black 1.0pt;
  border-right:solid windowtext 1.0pt;background:#DEE8F1;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'>参数</p>
  </td>
  <td width=378 valign=top style='width:10.0cm;border:solid black 1.0pt;
  border-left:none;background:#DEE8F1;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'>说明</p>
  </td>
 </tr>
 <tr>
  <td width=161 style='width:120.45pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=y2 align=center style='text-align:center;text-indent:0cm'><code>-plugin &lt;plugin_jar&gt;</code></p>
  </td>
  <td width=378 style='width:10.0cm;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'>&nbsp;（可选）指定一个内含monkeyrunner插件的<code>.jar</code>文件。欲了解更多关于monkeyrunner插件的内容，请参照(Extending
  monkeyrunner with plugins)使用插件扩展monkeyrunner。要指定多个文件，包括多次论证。如欲指定超过一个文件，可以多次使用此参数。</p>
  </td>
 </tr>
 <tr>
  <td width=161 style='width:120.45pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=y2 align=center style='text-align:center;text-indent:0cm'><code>&lt;program_filename&gt;</code></p>
  </td>
  <td width=378 style='width:10.0cm;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'>如果您指定此参数，monkeyrunner将视文件内容为Python程序并予以执行。如果此参数未予指定，则开启一个交互式会话。</p>
  </td>
 </tr>
 <tr>
  <td width=161 style='width:120.45pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=y2 align=center style='text-align:center;text-indent:0cm'><code>&lt;program_options&gt;</code></p>
  </td>
  <td width=378 style='width:10.0cm;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'>（可选）&lt;程序文件名&gt;&nbsp;所指定的程序所需的参数</p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><b>monkeyrunner</b><b>内建帮助</b><b>(monkeyrunner
Built-in Help)</b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>您可以用以下命令来生成monkeyrunner的API参考：</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img
border=0 width=381 height=40
src="images/image016.png"></p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 参数说明：</p>

<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:-21.0pt'>l&nbsp; 可以为<code>text</code>或<code>html</code>，分别代表纯文本和HTML输出。</p>

<p class=MsoNormal align=left style='margin-left:42.0pt;text-align:left;
text-indent:-21.0pt'>l&nbsp; 指定了输出文件的全路经名称。</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><b>使用插件扩展</b><b>monkeyrunner(Extending monkeyrunner with Plugins)</b></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>您可以用Java语言创建新的类，并打包成一个或多个<code>.jar</code>文件，以此来扩展monkeyrunnerAPI。您可以使用您自己写的类或者继承现有的类来扩展monkeyrunnerAPI。您还可以使用此功能来初始化monkeyrunner环境。</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 为了使monkeyrunner加载一个插件，您应当如使用如表1中所述的<code>-plugin</code>参数来调用monkeyrunner命令。</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在您编写的插件中，您可以导入或继承位于com.android.monkeyrunner包中的几个主要的monkeyrunner类：MonkeyDevice， MonkeyImage和MonkeyRunner（参见monkeyrunnerAPI
）。</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 请注意，插件无法让你访问Android的SDK。您不能导入com.android.app等包。这是因为monkeyrunner是在框架API层次之下与设备或模拟器进行交互的。</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;</p>

<p class=MsoNormal align=left style='text-align:left'><b>插件启动类</b><b>(The plugin startup class)</b></p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 用于插件的.jar文件可以指定一个类，使其在脚本执行之前就实例化。如欲指定这个类，您需要在.jar文件的manifest中添加键MonkeyRunnerStartupRunner。其值为启动时运行的类的名称。以下代码段显示了如何在一个ant构建脚本达到这样的目的：</p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img
border=0 width=521 height=115
src="images/image017.png"></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'>如欲访问monkeyrunner的运行时环境，启动类可以实现com.google.common.base.Predicate&lt;PythonInterpreter&gt;。例如，用这个类在默认的命名空间中设置一些变量：</p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt'><img border=0 width=553 height=264
src="images/image018.jpg"></p>

<p class=MsoNormal align=left style='text-align:left'>&nbsp;</p>

</div>

<br
clear=all style='page-break-before:auto'>



        



<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->