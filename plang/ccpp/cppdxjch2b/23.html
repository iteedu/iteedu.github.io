<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->


<p><div class="lpindex"><a href="index.html">首页</a><a href="22.html"> 上一页</a><a href="24.html"> 下一页</a></div>
<h2>3.7 头文件</h2>
<p>  每个标准库都有对应的头文件(header   file)，包含库中所有函数的函数原型和这些函数所需各种数据类型和常量的定义。图3.6列出了C++程序中可能包括的常用C++标准库头文件。图3．6中多次出现的宏(macro)将在第17章“预处理器”中详细介绍。以．h结尾的头文件是旧式头文件。</p>
     
<p>对每个旧式头文件，我们介绍新标准中使用的版本。  </p>
     
<p>程序员可以生成自定义头文件，自定义头文件应以．h结尾．可以用#include预处理指令包括自定义头文件。例如，square.h头文件可以用下列指令：  </p>
     
<pre class="code">#include   &quot;square.h&quot;</pre>
<p>  放在程序开头。17．2节介绍了包含头文件的其他信息。</p>

<table border="1" cellpadding="0" width="591">
  <tr>
    <td><p align="left">旧式头文件&nbsp;&nbsp;&nbsp; 说明 </p></td>
  </tr>
  <tr>
    <td><p align="left">&nbsp; 旧式头文件(本书前面使用)<br />
      &nbsp;&nbsp;(assert.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;包含增加诊断以程序调试的宏和信息。这个头文件的新版本为&lt;cassert&gt;<br />
      &nbsp; &lt;ctype.h&gt;&nbsp;&nbsp;&nbsp;&nbsp; 包含测试某些字符属性的函数原型和将小写字母变为大写字母，将大写字母变为小<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;写字母的函数原型。这个头文件的新版本为&lt;cctype&gt;<br />
      &nbsp; &lt;float.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;包含系统的浮点长度限制。这个头文件的新版本为&lt;cfloat&gt;<br />
      &nbsp; &lt;limits.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;包含系统的整数长度限制。这个头文件的新版本为&lt;climits&gt;<br />
      &nbsp; &lt;math.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 包含数学库函数的函数原型。这个头文件的新版本为&lt;cmath&gt;<br />
      &nbsp; &lt;stdio.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;包含标准输入/输出库函数的函数原型及其使用信息。这个头文件的新版本为&lt;cstdio&gt;<br />
      &nbsp; &lt;stdlib.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;包含将数字变为文本、将文本变为数字、内存分配、随机数和各种其它工具函数的函<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    数原型。这个头文件新版本为&lt;cstdlib&gt;<br />
      &nbsp; &lt;string.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;包含C语言格式的字符串处理函数的函数原型。这个头文件的新版本为&lt;cstring&gt;<br />
      &nbsp; &lt;time.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 包含操作时间和是期的函数原型和类型。这个头文件的新版本为&lt;ctime&gt;<br />
      &nbsp; &lt;iostream.h&gt;&nbsp;&nbsp;包含标准输入/输出函数的函数原型。这个头文件的新版本为&lt;iostream&gt;<br />
      &nbsp; &lt;iomanip.h&gt;&nbsp;&nbsp;&nbsp;包含能够格式化数据流的流操纵算子的函数原型。这个头文件的新版本为&lt;iomanip&gt;<br />
      &nbsp; &lt;fstream.h&gt;&nbsp;&nbsp;&nbsp;包含从磁盘文件输入输出到磁盘文件的函数原型。这个头文件的新版本为&lt;fstream&gt;<br />
      &nbsp; </p></td>
  </tr>
</table>
                             
<p>  图 3.6   常用C++标准库头文件</p>
<h2>  <a name="3.8" id="3.8"></a>3.8   随机数产生器</h2>
<p>下面要介绍一个在模拟事件和游戏的程序中常用的组件。本节和下节开发一个结构良好、包括多个函数的游戏程序。程序中要使用前面介绍的大多数控制结构。  </p>
     
<p>在赌场上，人人都关心的一个问题就是机会元素(element of   chance)，也就是赢钱的运气。这个机会元素可以用标准库中的rand函数引入计算机应用程序中。  </p>
   
<p>考虑下列语句：  </p>
     
<pre class="code">i=rand()；  </pre>
<p>  rand函数产生O到RAND_MAX之间的整数(这是&lt;stdlib.h&gt;头文件中定义的符号常量)。RAND_MAX的值至少应为32767，也就是两个字节(即16位)所能表示的最大整数值。如果rand函数真的可以随机产生整数，则每次调用rand函数时，o到RAND_MAX之间的每个数出现的机会(chance)或概率(probability)是相等的。</p>
     
<p>rand函数产生的数值范围可能与特定应用中所要求的数值范围不同。例如，模拟掷硬币的程序只要0(正面)和1(反面)，模拟投骰子的程序只要1到6之间的随机整数，视频游戏中预测飞船(有四种类型)下一个类型的程序只要1到4之间的随机整数。  </p>
     
<p>要演示rand函数，我们开发一个程序，模拟投骰子20次并打印每次的值。rand函数的函数原型见  &lt;stdlib.h&gt;。我们使用求模运算符(%)和rand函数，如下所示：</p>
     
<pre class="code">rand( ) %   6  </pre>
<p>  产生0到5的整数，称为比例缩放(scaling)。数字6称为比例因子(scalingfactor)。然后我们将产生的数值范围加1。得到所要结果。图3．7确认了产生的结果在1到6之间。</p>
<p>  要显示这些数值的出现机会近似均等．图3．8模拟投骰子6000次。1到6的每个数值大约都出</p>
<p>  现1000次。</p>
     
<p>从程序输出可见，通过比例缩放和移动，可以利用rand函数真实地模拟投骰子。注意程序用不到switch结构中提供的default   case，但我们还是加上default case，这是个良好的编程习惯。第4章数组将介绍如何把整个switch结构转换成简单的单行语句。  </p>
<pre class="code"> // Fig. 3.7: figO307.cpp
 // Shifted, scaled integers produced by 1 + rand( ) % 6
 #include &lt;iostream.h&gt;<br /> #include &lt;iomanip.h&gt;<br /> #include &lt;stdlib.h&gt;
 int main( }
 for( int i = 1; i <= 20; i ++){
 cout<< setw(10 ) << { 1 +rand( ) % 6 );
 if( i % 5 == 0 )
 cout << endl;
 }
 return O;
 }</pre>
<p>  输出结果：</p>
<p>5   5   3   5   5  </p>
   
<p>2   4   2   5     5  </p>
   
<p>5   3   2   2   1  </p>
   
<p>5   1   4   6   4  </p>
<p>图3．7 比例缩放和移动“rand()％6”产生的整数  </p>
<pre class="code">  // Fig. 3.8:fig03 08.cpp
 // Roll a six-sided die 6000 times
 #include &lt;iostream.h&gt;<br /> #include &lt;iomanip.h&gt;<br /> #include &lt;stdlib.h&gt;
  int main( )
{
 int frequencyl = 0, frequency2 = 0,
 frequency3 = 0, frequency4 = 0,
 frequency5 = 0, frequency6 = 0,
 face;
 forf( int roll = 1; roll <= 6000; roll++ ) {
 ace = 1 + rand( ) % 6;
 switch ( face ) {
 case 1:
 ++frequencyl;
 break;
 case 2:
 ++frequency2;
 break;
 case 3:
 ++frequency3;
 break;
 case 4:
 ++frequency4;
 break;
 case 5:
 ++frequeneyS;
 break;
 case 6:
 ++frequency6;
 break;
 default:
 cout << "should never get here!";
 }
 }
 cout << "Face" << setw{ 13 ) << "Frequency"
 << " 1" << setw( I3 ) << frequencyl
 << " 2" << setw( 13 ) << frequency2
 << " 3" << setw( 13 ) << frequency3
 << " 4" << setw( 13 ) << frequency4
 << " 5" << setw( 13 ) << frequency5
 << " 6" << setw( 13 ) << frequency6 << endl;
 return 0;
 } </pre>
<p>  输出结果：</p>
   
<p>Face     Frequency  </p>
   
<p>1     987  </p>
   
<p>2     984  </p>
   
<p>3     1029  </p>
   
<p>4       974  </p>
   
<p>5     1004  </p>
   
<p>6     1022  </p>
   
<p>图3．8模拟投骰子6000次  </p>
<p>测试与调试提示3．1即使能确切保证程序没有缺陷，也应在switch结 构中用一个default   case来找到错误。 </p>
<p>再次执行图3．7的程序得到：</p>
<p>  5   5   3   5   5</p>
   
<p>2   4     2   5   5  </p>
   
<p>5   3   2   2   1  </p>
   
<p>5   1   4   6     4  </p>
<p>  注意打印的数值顺序与上一次完全相同，怎么能算是随机数呢，其实，这种可重复性是rand函数的一个重要特性。调试程序时，这种可重复性提供了证明修改后程序能正确工作的关键。</p>
     
<p>rand函数实际上产生的是伪随机数(pseudo-randomnumber)。重复调用rand函数产生一系列看上去是随机的数值，但每次执行程序时，这组数值本身是可重复的。一旦程序进行彻底调试之后，就可以调整为在每次执行程序时产生不同的随机数系列。这个过程称为随机化(randomizing)，是用标准库函数srand完成的。srand函数取一个unsigned类型的整数参数并内嵌rand函数(即种子)，  </p>
<p>  就可以在每次执行程序时产生不同的随机数系列。</p>
     
<p>srand函数的使用如图3．9所示。在这个程序中，我们使用数据类型unsigned(unsigned   int的缩写)。int值至少占内存的两个字节，可以存正值或负值。unsignediht变量值也至少占内存的两个字节。2字节的unsigned   int只能取O到65535的非负值，4字节的unsignediht只能取O到4294967295的非负值，srand函数取unsigned   int值作参数。srand函数的函数原型在头文件  &lt;stdlibh&gt;新C++标准的cstdlib)中。</p>
     
<p>下面将程序运行几次并观察结果。注意，只要提供不同的种子，即可在每次执行程序时产生不同的随机数系列。  </p>
<pre class="code">// Fig. 3.9: fig0309.cpp
 // Randomizing die-rolling program

 #include &lt;iostream.h&gt;<br /> #include &lt;iomanip.h&gt;<br /> #include &lt;stdlib.h&gt;
 int main( )
 {
 unsigned seed;
 cout << "Enter seed: ";
 cin >> seed;
 srand{ seed );
 for ( int i = 1; i <= 10; i++ ) {
 cout << setw( 10 ) << 1 + rand( ) % 6;
 if ( i % 5 == 0 )
 cout << endl;
O }
 return 0;
 }</pre>
<p>输出结果：  </p>

<p>Enter seed： 67  </p>
   
<p>1   6   5     1   4  </p>
   
<p>5   6   3   1   2  </p>

   
<p>Enter seed：432  </p>
   
<p>4   2     6   4   3  </p>
   
<p>2   5   1   4   4  </p>

   
<p>Enter seed： 67  </p>
   
<p>1     6   5   1   4  </p>
   
<p>5   6   3   1   2  </p>

   
<p>图3．9投骰子随机化程序  </p>

     
<p>如果不想每次输入种子值而随机化，则要用如下语句：  </p>
   
<pre class="code">srand( time ( O )   )；  </pre>
<p>  使计算机通过时钟值自动取得种子值。time函数(上述语句中该函数的参数为0)返回当前“日历时间”的秒数，将这个值转换为无符号整数值，作为随机数产生器的种子。time函数的函数原型在&lt;time&gt;(新C++标准的ctime)中。</p>

     
<h5>性能提示 3．2  </h5>
<p>srand函数只要在程序中调用一次即可得到所需的随机化结果，多次调用是多余的，会降低程序性能。  </p>
     
<p>由rand函数直接产生的值总是取值为：  </p>
   
<pre class="code">O≤rand()≤   RAND_MAX  </pre>
<p>  前面介绍了如何用一个语句模拟投骰子，该语句如下所示：</p>
   
<pre class="code">face=1+rand( ) % 6；  </pre>
   
<p>总是对变量face指定1≤face≤6的整数(随机)。注意这个范围的宽度(即构成该范围的连续整数的个数)为6并从1开始。从上述语句可以看出，范围宽度是由求模运算符比例缩放rand的数值(6)确定的，开始值等于rand％6中加进的数值(即1)。可以将这个结果一般化，如下所示：  </p>
     
<pre class="code">n = a + rand( ) ％b；  </pre>
   
<p>其中a是位移值(等于所要的连续整数范围的开始值)，b是比例因子(即由连续整数构成的该范围的宽度)。练习中将介绍如何从一组非连续整数中随机选择整数。  </p>
   

   
<h5>常见编程错误3．16  </h5>
用srnd函数代替rand函数产生随机数是个语法错误，因为srnd函数不返回值。  </p>
<div class="rpindex"><a href="24.html"> 下一页</a><a href="22.html"> 上一页</a><a href="index.html">首页</a></div>


<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->
