<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->


<div class="lpindex"><a href="index.html">首页</a><a href="90.html"> 上一页</a><a href="92.html"> 下一页</a></div>

<H1>sprintf格式<!-- RDLabel: "sprintf格式" --></H1>
<P>Ruby的sprintf格式与C语言的sprintf(3)基本相同。但还是有些差别: 它没有针对C特有类型的修饰符,如short或long等; 它包含2进制数的指示符(%b); 它不支持sprintf的方言式的语法。</P>
<P>下面就对ruby的sprintf格式进行详细的说明。</P>
<P>sprintf格式的规格如下所示。[]中的部分是可选的。</P><pre class="code">%[指定参数$][标识符][宽度][.精度]指示符
</PRE>
<P>若想输出`%'本身时, 请这样`%%'处理。</P>
<P>下面就分别介绍一下各元素的用法。</P>
<H2>标识符<!-- RDLabel: "标识符" --></H2>
<P>标识符包括`#', `+', ` '(空格), `-'和`0'这5个。</P>

#<!-- RDLabel: "#" --> 

<P>使用2进制、8进制、16进制的指示符(`b', `o', `x', `X')时, 会分别添加"0b", "0", "0x", "0X"前缀。</P><pre class="code">p sprintf("%#b", 10) # =&gt; "0b1010"
p sprintf("%#o", 10) # =&gt; "012"
p sprintf("%#x", 10) # =&gt; "0xa"
p sprintf("%#X", 10) # =&gt; "0XA"
</PRE>
<P>对于浮点数 (`f', `e', `E', `g', `G'), 则必定在输出中添加"."。</P><pre class="code">p sprintf("%.0f", 10) # =&gt; "10"
p sprintf("%#.0f", 10) # =&gt; "10."
p sprintf("%.0e", 10) # =&gt; "1e+01"
p sprintf("%#.0e", 10) # =&gt; "1.e+01"
</PRE>
<P>`g', `G'除了具有上述特性外, 还会在末尾添加多余的0。</P><pre class="code">p sprintf("%.05g", 10) # =&gt; "10"
p sprintf("%#.05g", 10) # =&gt; "10.000"
</PRE>
+<!-- RDLabel: "+" --> 

<P>使输出字符串带上符号。如果是正数的话, 就会添加`+'。它只对数值指示符(`d', `i', `b', `o', `x', `X', `u', `f', `e', `E', `g', `G')起作用。另外, 如果是`b', `o', `x', `X', `u'的话, 则会为负数添加`-'。</P><pre class="code">p sprintf("%d", 1)   # =&gt; "1"
p sprintf("%+d", 1)  # =&gt; "+1"

p sprintf("%x", -1)  # =&gt; "..f"  # ".." 表示f无限延续
p sprintf("%+x", -1) # =&gt; "-1"
</PRE>
' '(空格)<!-- RDLabel: "' '(空格)" --> 

<P>与`+'相同, 用空格来代替正号`+'。它只对数值指示符(`d', `i', `b', `o', `x', `X', `u', `f', `e', `E', `g', `G')起作用。</P><pre class="code">p sprintf("%d", 1)   # =&gt; "1"
p sprintf("%+d", 1)  # =&gt; "+1"
p sprintf("% d", 1)  # =&gt; " 1"

p sprintf("%x", -1)  # =&gt; "..f"
p sprintf("% x", 1)  # =&gt; " 1"
p sprintf("% x", -1) # =&gt; "-1"
</PRE>
-<!-- RDLabel: "-" --> 

<P>使输出内容靠左. 若尚未指定宽度的话,则不起作用。</P>
0<!-- RDLabel: "0" --> 

<P>当输出内容靠右时, 使用`0'而并非空格来填充多余部分。</P>
<P>它只对数值指示符(`d', `i', `b', `o', `x', `X', `u', `f', `g', `G')起作用(对`e', `E'无效)</P><pre class="code">p sprintf("%010d", 10)
# =&gt; "0000000010"
</PRE>
<P>与`#'一起使用时, 输出情况如下。</P><pre class="code">p sprintf("%#010x", 10)  # =&gt; "0x0000000a"
p sprintf("%#010o", 10)  # =&gt; "0000000012"
p sprintf("%#010b", 10)  # =&gt; "0b00001010"
</PRE>
<P>它等同于下例。</P><pre class="code">p sprintf("%#10.8x", 10) # =&gt; "0x0000000a"
p sprintf("%#10.9o", 10) # =&gt; "0000000012"
p sprintf("%#10.8b", 10) # =&gt; "0b00001010"
</PRE>
<P>通常情况下, 会输出如下内容。</P><pre class="code">p sprintf("%#10x", 10)   # =&gt; "       0xa"
p sprintf("%#10o", 10)   # =&gt; "       012"
p sprintf("%#10b", 10)   # =&gt; "    0b1010"
</PRE>
<H2><a name="a" id="a"></a>宽度<!-- RDLabel: "宽度" --></H2>
<P>以非0数字开头的数串负责指定宽度。宽度是指生成字符串的宽度, 它不受后文中的精度的限制。</P>
<P>确定宽度时, 也会考虑标识符中附加的" ", "+","-", "0b", "0", "0x", "0X"的长度。</P><pre class="code">p sprintf("%#05x", 10) # =&gt; "0x00a"
</PRE>
<P>宽度是指"必要的最小宽度". 若结果字符串的宽度超过指定宽度时, 指定宽度就会失效。</P>
<P>若将宽度指定为`*'时, 将从参数中取得宽度值。</P><pre class="code">p sprintf("%10s", "foo")    # =&gt; "       foo"
p sprintf("%*s", 10, "foo") # =&gt; "       foo"
</PRE>
<H2><a name="b" id="b"></a>精度<!-- RDLabel: "精度" --></H2>
<P>紧跟在"."后面的数串表示精度(若只有"."的话，则为".0")。若遇到整数的指示符(`d', `i', `b', `o', `x', `X', `u')的话，精度表示数值部分的长度。</P><pre class="code">p sprintf("%10.5d", 1)  # =&gt; "     00001"
p sprintf("%#10.5x", 1) # =&gt; "   0x00001"
p sprintf("%+10.5x", 1) # =&gt; "    +00001"
</PRE>
<P>若遇到浮点数的指示符(`f')的话，它表示小数部分的位数。</P><pre class="code">p sprintf("%10.5f", 1)   # =&gt; "   1.00000"
p sprintf("%10.5f", 10)  # =&gt; "  10.00000"
</PRE>
<P>若遇到浮点数的指示符(`e', `E', `g', `G')的话，它表示有效位数。</P><pre class="code">p sprintf("%10.5e", 1)   # =&gt; "1.00000e+00"
p sprintf("%10.5e", 10)  # =&gt; "1.00000e+01"
p sprintf("%10.5g",  10)  # =&gt; "        10"
p sprintf("%#10.5G", 10)  # =&gt; "    10.000"
</PRE>
<P>如果是字符串指示符(`s', `p')的话，将会按照精度的规定来检查参数中的字符串长度，并切除多余部分。若将宽度和精度设为同值的话，则只输出参数字符串中的符合精度规定的部分。</P><pre class="code">p sprintf("%10.2s", "foo")  # =&gt; "        fo"

p sprintf("%5.5s", "foo")     # =&gt; # =&gt; "  foo"
p sprintf("%5.5s", "foobar")  # =&gt; # =&gt; "fooba"
</PRE>
<P>若将精度设为`*'的话，将从参数中提取精度的值。</P><pre class="code">p sprintf("%.5s", "foobar")    # =&gt; "fooba"
p sprintf("%.*s", 5, "foobar") # =&gt; "fooba"
</PRE>
<H2><a name="c" id="c"></a>指示符<!-- RDLabel: "指示符" --></H2>
<P>指示符指出参数的类型，且是必选的。大体说来它包括：</P>
<UL>
<LI>表示字符串的指示符: `c', `s', `p' 
<LI>表示整数的指示符: `d', `i', `u', `b', `o', `x', `X', 
<LI>表示浮点数的指示符: `f', `g', `e', `E', `G' </LI></UL>
<P>这几类。</P>

c<!-- RDLabel: "c" --> 

<P>将参数的数值(0×255)看作是字符代码，并输出对应的字符。若参数并非数值、String、 nil, true或false的话，将尝试用to_int方法进行变换。</P>
<P>此时，只有标识符`-'和"宽度"的设定是有效的。</P>
s<!-- RDLabel: "s" --> 

<P>输出字符串。</P>
<P>若参数并非String对象的话，将使用to_s方法对其进行变换。</P>
p<!-- RDLabel: "p" --> 

<P>ruby 1.8 特性: 输出Object#inspect的结果。</P><pre class="code">p sprintf("%s", [1, 2, 3])      # =&gt; "123"
p sprintf("%p", [1, 2, 3])      # =&gt; "[1, 2, 3]"
</PRE>
d<!-- RDLabel: "d" --> 
i<!-- RDLabel: "i" --> 

<P>以10进制整数的形式输出参数中的数值。</P>
<P>若参数并非整数，则使用与Integer函数相同的规则将其变为整数。</P>
u<!-- RDLabel: "u" --> 

<P>将参数的数值看作是无符号整数，并以10进制整数的形式输出它。</P><pre class="code">p sprintf("%u", -1) # =&gt; "..4294967295"
</PRE>
<P>上面的代码会输出 p ".." + 0xffff_ffff.to_s。</P>
<P>ruby 1.7 特性: 在version 1.7中，不会附加".."。若是'%u'的话，则将参数看作是定长整数。此时，对于负整数n来说</P><pre class="code">printf("%u", n)
</PRE>
<P>与</P><pre class="code">printf("%d", n &amp; ~(-1 &lt;&lt; n.size*8))
</PRE>
<P>是一个意思。</P>
b<!-- RDLabel: "b" --> 
o<!-- RDLabel: "o" --> 
x<!-- RDLabel: "x" --> 
X<!-- RDLabel: "X" --> 

<P>分别以2进制、8进制、16进制、16进制(大写字母)字符串的形式输出整数。</P>
<P>若使用了`#' 标识符的话，则分别在前面添加"0b", "0", "0x", "0X"。</P>
<P>若没有使用`+', ` ' 标识符时，将在负数的前面(若有`#' 标识符，则在"0x"等的后面)添加".."。这表示最高位字符无限延伸，它采用了2的补数形式来表现负数。</P><pre class="code">p sprintf("%#b", 10)    # =&gt; "0b1010"
p sprintf("%#o", 10)    # =&gt; "012"
p sprintf("%#x", 10)    # =&gt; "0xa"

# 对负数添加".."
p sprintf("%#b", -1)    # =&gt; "0b..1"
p sprintf("%#o", -1)    # =&gt; "0..7"
p sprintf("%#x", -1)    # =&gt; "0x..f"

p sprintf("%10x", -1)   # =&gt; "       ..f"
p sprintf("%-10x", -1)  # =&gt; "..f       "

# 若指定了"精度"的话，则不会添加".."
p sprintf("%.10x", -1)  # =&gt; "ffffffffff"
</PRE>
f<!-- RDLabel: "f" --> 
e<!-- RDLabel: "e" --> 
E<!-- RDLabel: "E" --> 
g<!-- RDLabel: "g" --> 
G<!-- RDLabel: "G" --> 

<P>`f' 以小数点形式(xxx.xxx)输出数值。</P>
<P>`e' 以指数形式(x.xxxe+xx)输出数值。</P>
<P>`g' 的情况比较特殊。当指数小于-4或者超出精度范围时，它采用`e'方式进行输出。除此之外，它采用`f'方式进行输出。另外，它会删除小数部分尾部的0。</P>
<P>大写字母指示符(`E', `G')会将输出中的字母变为大写形式。</P><pre class="code">p sprintf("%f", 1.0) # =&gt; "1.000000"
p sprintf("%e", 1.0) # =&gt; "1.000000e+00"
p sprintf("%g", 1.0) # =&gt; "1"

p sprintf("%f", 10.1) # =&gt; "10.100000"
p sprintf("%e", 10.1) # =&gt; "1.010000e+01"
p sprintf("%g", 10.1) # =&gt; "10.1"

p sprintf("%g", 10 ** 6)  # =&gt; "1e+06"
p sprintf("%g", 10 ** -5) # =&gt; "1e-05"
</PRE>
<P>精度的缺省值为6。</P>
<P>若遇到无限大值或NaN(Not a Number)时，输出情况如下。</P><pre class="code">p sprintf("%f",  1.0/0)  # =&gt; "inf"
p sprintf("%f", -1.0/0)  # =&gt; "-inf"
p sprintf("%f",  0.0/0)  # =&gt; "nan"

p sprintf("%E",  1.0/0)  # =&gt; "INF"
p sprintf("%E", -1.0/0)  # =&gt; "-INF"
p sprintf("%E",  0.0/0)  # =&gt; "NAN"
</PRE>
<H2><a name="d" id="d"></a>指定参数<!-- RDLabel: "指定参数" --></H2>
<P>这部分的利用频率最低，所以放在最后。</P>

nth$<!-- RDLabel: "nth$" --> 

<P>表示将使用第nth个参数进行格式化操作。</P><pre class="code">p sprintf("%1$d, %1$x, %1$o", 10)
=&gt; "10, a, 12"

p sprintf("%3$d, %2$x, %1$o", 1, 2, 3)
=&gt; "3, 2, 1"
</PRE>
<P>若您不想改变参数的顺序而只想改变格式的话，也可以使用它。</P><pre class="code">case ENV['LC_TIME']
when /^ja_JP/
   fmt = "%1$d年%2$d月%3$d日"
else
   fmt = "%2$02d/%03$2d/%1$02d"
end

p sprintf(fmt, 1, 4, 22)
=&gt; "04/22/01"
</PRE>
<P>您也可以先插入"*"，然后借用参数来设定"宽度"和"精度"的值。</P><pre class="code">p sprintf("%5.2f", 1);              # =&gt; " 1.00"
p sprintf("%*.*f", 5, 2, 1);        # =&gt; " 1.00"
p sprintf("%1$*2$.*3$f", 1, 5, 2);  # =&gt; " 1.00"
</PRE>


<div class="rpindex"><a href="92.html"> 下一页</a><a href="90.html"> 上一页</a><a href="index.html">首页</a></div>



<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->
