<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->


<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->

<!--end of htmlmiddle-->

<h1>使用正则式处理糟糕的数据</h1>
<p>Beautiful Soup does pretty well at handling bad markup when &quot;bad
  markup&quot; means tags in the wrong places. But sometimes the markup is
  just malformed, and the underlying parser can't handle it. So
  Beautiful Soup runs regular expressions against an input document
  before trying to parse it. <br/>
  对于那些在错误的位置的&quot;坏标签&quot;，Beautiful Soup处理的还不错。但有时有些
  非常不正常的标签，底层的剖析器也不能处理。这时Beautiful Soup会在剖析之前运用正则表达式
来处理输入的文档。 </p>
<p>By default, Beautiful Soup uses regular expressions and replacement
  functions to do search-and-replace on input documents. It finds
  self-closing tags that look like &lt;BR/&gt;, and changes them to look like
  &lt;BR /&gt;. It finds declarations that have extraneous whitespace, like 
  &lt;! --Comment--&gt;, and removes the whitespace: &lt;!--Comment--&gt;. <br/>
  默认情况下，Beautiful Soup使用正则式和替换函数对输入文档进行搜索替换操作。
  它可以发现自关闭的标签如&lt;BR/&gt;，转换它们如同&lt;BR /&gt;（译注：多加了一个空格）。
  它可以找到有多余空格的声明，如&lt;! --Comment--&gt;，移除空格:&lt;!--Comment--&gt;. </p>
<p>If you have bad markup that needs fixing in some other way, you can
  pass your own list of <code>(regular expression, replacement function)</code> tuples into the soup constructor, as the <code>markupMassage</code> argument. <br/>
  如果你的坏标签需要以其他的方式修复，你也可以传递你自己的以<code>(regular expression, replacement function)</code> 元组的list到soup对象构造器，作为<code>markupMassage</code>参数。 </p>
<p>Let's take an example: a page that has a malformed comment. The
  underlying SGML parser can't cope with this, and ignores the comment
  and everything afterwards:
  我们举个例子：有一个页面的注释很糟糕。底层的SGML不能解析它，并会忽略注释以及它后面的所有内容。 </p>
<pre class="code">from BeautifulSoup import BeautifulSoup
badString = &quot;Foo&lt;!-This comment is malformed.--&gt;Bar&lt;br/&gt;Baz&quot;
BeautifulSoup(badString)
# <samp>Foo</samp>
</pre>
<p>Let's fix it up with a regular expression and a function: <br/>
  让我们使用正则式和一个函数来解决这个问题： </p>
<pre class="code">import re
myMassage = [(re.compile('&lt;!-([^-])'), lambda match: '&lt;!--' + match.group(1))]
BeautifulSoup(badString, markupMassage=myMassage)
# <samp>Foo&lt;!--This comment is malformed.--&gt;Bar</samp>
</pre>
<p>Oops, we're still missing the &lt;BR&gt; tag. Our <code>markupMassage</code> overrides the parser's default massage, so the default
  search-and-replace functions don't get run. The parser makes it past
  the comment, but it dies at the malformed self-closing tag. Let's add
  our new massage function to the default list, so we run all the
  functions. <br/>
  哦呃呃，我们还是漏掉了&lt;BR&gt;标签。我们的<code>markupMassage</code> 重载了剖析默认的message，因此默认的搜索替换函数不会运行。
  剖析器让它来处理注释，但是它在坏的自关闭标签那里停止了。让我加一些新的message函数到默认的list中去，
  并让这些函数都运行起来。 </p>
<pre class="code">import copy
myNewMassage = copy.copy(BeautifulSoup.MARKUP_MASSAGE)
myNewMassage.extend(myMassage)
BeautifulSoup(badString, markupMassage=myNewMassage)
# <samp>Foo&lt;!--This comment is malformed.--&gt;Bar&lt;br /&gt;Baz</samp>
</pre>
<p>Now we've got it all. <br/>
  这样我们就搞定了。 </p>
<p>If you know for a fact that your markup doesn't need any regular
  expressions run on it, you can get a faster startup time by passing in <code>False</code> for <code>markupMassage</code>. <br/>
  如果你已经知道你的标签不需要任何正则式，你可以通过传递一个<code>False</code>给<code>markupMassage</code>. </p>
<p>&nbsp;</p>


<!--start of htmlend-->
<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->