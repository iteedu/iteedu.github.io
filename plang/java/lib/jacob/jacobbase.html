<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->

<h1>JACOB使用简介</h1>
<p>它允许在java中调用com接口自动组件，它使用JNI（本地调用程序）来进行本地调用COM库。它可运行在x86和支持32位和64位Java虚拟机 X64的环境。 </p>
<p><a href="jacobcode.html">jacob操作word接口api</a></p>
<p>测试源码包：</p>
<p>链接: <a href="http://pan.baidu.com/s/1mg9tsZA">http://pan.baidu.com/s/1mg9tsZA </a></p>
<p>密码: ej9u</p>
<h2>JACOB项目的由来 </h2>
<p>首先，我们将了解JACOB项目的基本情况，探讨在什么样的情况下选择它来完成您的任务 </p>
<p>
  COM中暴露出来的方法，主要有两种机制：早期绑定和晚期绑定。 </p>
<p>
  大桥调用可以参考IBM的RJCB项目，它提供了一套高性能的解决方案。当然您需要了解更多的COM组件的细节，虽然框架为您完成了大部分的生成桥 RJCB仅支持那些提供早期绑定的虚函数表的接口的COM API。 </p>
<p>
  而晚期绑定方式是通过IDispatch的接口来实现，类似的Java的反射机制，您可以按照名称或者ID进行方法调用，这种设计主要目的是支持脚本语言操作COM，因为脚本是解释执行的，通常都不支持指针也就没有C + +中的虚函数表 ID</p>
<p>
  雅各开源项目提供的是一个JVM独立的自动化服务器的实现，其核心是基于JNI技术实现的变异，调度等接口，设计参考了微软VJ + +内置的通用自动化服务器，但是微软的实现仅仅支持自身的JVM。通过雅各，您可以方便地在Java的语言中进行晚期绑定方式的调用，开源项目实现了一种简单，灵活的Java与COM的通信方式，为您充分利用现有应用提供了可能。 </p>
<h2>Jacob安装 </h2>
<p>下载jacob的zip包，如jacob-1.18-M3.zip。 </p>
<p>
  将jacob.jar引入项目。 </p>
<p>
  将dll库放到指定位置，dll分为64位和32位，jacob-xx-x64.dll和jacob-xx-x32.dll，不知道放哪个都放上是一个好的选择。 </p>
<p>
  为了确保能使程序找到库，可能考虑入到如下位置： </p>
<p>
  &ldquo;WINDOWS\SYSTEM32&rdquo;下面。 </p>
<p>
  运行程序的jdk或jre的bin目录下。 </p>
<p>
  如果用MyEclipse，可以指定运行程序所用的jdk，否则要放入MyEclipse自己的jdk里一份。 </p>
<p>
  一般系统没有加载到Jacob.dll文件时，报错信息为：&ldquo;java.lang.UnsatisfiedLinkError: no jacob in java.library.path&rdquo; </p>
<h2>Jacob基础语法说明 </h2>
<p>ActiveXComponent ax = new ActiveXComponent(&quot;a1&quot;);</p>
<p>
  构建ActiveX组件实例,其中的a1的值和你需要调用的ActiveX控件有关 </p>
<table border="1" cellpadding="0" width="500">
  <tr>
    <td></p>
<p>
      MS控件名 </td>
    <td><p>a1的值 </p></td>
  </tr>
  <tr>
    <td><p>InternetExplorer</p></td>
    <td><p>InternetExplorer.Application</p></td>
  </tr>
  <tr>
    <td><p>Excel</p></td>
    <td><p>Excel.Application</p></td>
  </tr>
  <tr>
    <td><p>Word</p></td>
    <td><p>Word.Application</p></td>
  </tr>
  <tr>
    <td><p>Powerpoint</p></td>
    <td><p>Powerpoint.Application</p></td>
  </tr>
  <tr>
    <td><p>vb/java Script</p></td>
    <td><p>ScriptControl</p></td>
  </tr>
  <tr>
    <td><p>windows media    Player</p></td>
    <td><p>WMPlayer.OCX</p></td>
  </tr>
  <tr>
    <td><p>Outlook</p></td>
    <td><p>Outlook.Application</p></td>
  </tr>
  <tr>
    <td><p>Visio</p></td>
    <td><p>Visio.Application</p></td>
  </tr>
  <tr>
    <td><p>DAO</p></td>
    <td><p>DAO.PrivateDBEngine.35</p></td>
  </tr>
  <tr>
    <td><p>MultiFace</p></td>
    <td><p>MultiFace.Face</p></td>
  </tr>
</table>
<p>Dispatch&nbsp;ds&nbsp;=&nbsp;ax.getObject().&nbsp;toDispatch();</p>
<p>
  获取Dispatch对象，我们可以把每个Dispatch对象看成是对Activex控件的一个操作，这一步是获得该ActiveX控件的控制权。&nbsp;</p>
<p>
  （注：浅析JACOB&nbsp;中提到过Variant类，这里的ax.getObject()便是获得该对象，我们将其转化为任何对象（类型）） </p>
<p>
  Dispatch.get(ds, &ldquo;a1&rdquo;);</p>
<p>
  返回Variant类型，获取ds对象的a1属性，通过to…()和get...()方法可以转换为java的很多类型 </p>
<p>
  Dispatch.put(ds, &ldquo;a1&rdquo;, …);</p>
<p>
  设置ds对象a1属性，具体参数为…指定 </p>
<p>
  ActiveXComponent有setProperty(&ldquo;a1&rdquo;, …)和getProperty(&ldquo;a1&rdquo;)方法，比Dispatch的put和get方法方便！ </p>
<p>
  Dispatch.invoke(ds, &ldquo;a3&rdquo;, a4, a5,  a6).toDispatch(); </p>
<p>
  说明：ds为要执行操作的对象，a3为要执行的操作名称；a4一般为Dispatch.Method、Dispatch.Put、Dispatch.Get三种，正是这三种指定让此方法可以执行put、set、call同样操作；a5为一个对象数组，形如：new Object[]{}，一般的当Method时为三个参数，Get时没有参数，Put是为两个参数；a6一般为new int[1]</p>
<p>
  Dispatch.call(ds, &ldquo;a1&rdquo;, …)  .toDispatch();</p>
<p>
  和invoke差不多，执行a1名称的操作，少了invoke中的a4和a6参数；…和invoke中newObject[]{}中参数一样 </p>
<p>
  所以Dispatch.call()和Dispatch.invoke()方法可以执行Dispatch.put()和Dispatch.set()的操作，反之不可以 </p>
<h2>Word中的属性参数 </h2>
<p>Documents：所有文档 </p>
<p>
  Open：打开文档 </p>
<p>
  ActiveXComponent.Visible：设置编辑器是否可见 </p>
<p>
  Tables：获得所有的表格 </p>
<p>
  Bookmarks：所有标签 </p>
<p>
  Selection：光标所在处或选中的区域 </p>
<p>
  select：选中 </p>
<p>
  typeParagraph：设置为一个段落 </p>
<p>
  ParagraphFormat：段落格式，用alignment设置 </p>
<p>
  alignment：1、居中，2、靠右，3、靠左 </p>
<p>
  Add：新建一个word文档 </p>
<p>
  Close：关闭文档，0不保存，-1保存，-2弹出框确认，注意ComThread.Release();关闭整个word进程 </p>
<p>
  SaveAS：另存为 </p>
<p>
  save：保存 </p>
<p>
  printOut：打印 </p>
<p>
  Application：得到ActiveXComponent的实例 </p>
<p>
  WindowState：Application的属性，表示窗口的大小，0、default，1、maximize，2、minimize</p>
<p>
  top、left、height、width：application的属性，表示窗口的位置 </p>
<p>
  ActiveXComponent.Quit：关闭所有word文档，但是不退出整个word程序 </p>
<p>
  Range：表示文档中的一个连续范围，由一个起始字符位置和一个终止字符位置定义，进而可以得到格式的信息 </p>
<p>
  Item：得到指定的表格 </p>
<p>
  Rows：得到表格的所有行 </p>
<p>
  Cell：表格的一个单元格 </p>
<p>
  Text：word的文本内容 </p>
<p>
  InsertFile：插入文件 </p>
<p>
  InsertRowsBelow：在指定的行下面插入一行 </p>
<p>
  InsertAfter：在指定对象后插入 </p>
<p>
  Delete：删除，可以是表格的行 </p>
<p>
  Count：返回数目，比如Rows、Tables的数目 </p>
<p>
  Height：返回高度，比如行高、表格行的高 </p>
<p>
  Split：拆分单元格，要指定行数和列数 </p>
<p>
  Merge：合并单元格 </p>
<p>
  Exists：指定的对象是否存在，返回bool值 </p>
<p>
  Copy：复制 </p>
<p>
  Paste：粘贴 </p>
<p>
  Font：字体 </p>
<p>
  Name：字体的名字 </p>
<p>
  Bold：字体是否为粗体 </p>
<p>
  Italic：字体是否为斜体 </p>
<p>
  Underline：字体是否有下划线 </p>
<p>
  Color：颜色 </p>
<p>
  Size：大小 </p>
<p>
  Borders：指定边框，-1为上边框，-2左边框，-3为下边框，-4有右边框，-5为横向边框，-6为纵向边框，-7从左上角开始的斜线，-8从左下角开始的斜线 </p>
<p>
  AutoFitBehavior：自动调整大小，1为内容自动调整大小，2为窗口自动调整大小 </p>
<p>
  Content：去的内容 </p>
<p>
  InLineShapes： </p>
<p>
  AddPicture：增加一张图片，需要制定路径 </p>
<p>
  homeKey:光标移到开头 </p>
<p>
  moveDown：光标往下一行 </p>
<p>
  moveUp：光标往上一行 </p>
<p>
  moveRight：光标往左一列 </p>
<p>
  moveLeft：光标往右一列 </p>
<p>
  find：要查找的文本 </p>
<p>
  Forward：向前查找 </p>
<p>
  Format：查找的文本格式 </p>
<p>
  MatchCase：大小写匹配 </p>
<p>
  MatchWholeWord：全字匹配 </p>
<p>
  Execute：开始执行查找 </p>



<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->