<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->


  <div  class="lpindex"><a href="index.html">目录</a> <a href="5-31.html">上一页</a> <a href="5-33.html">下一页</a> </div>
  <p>解决了字符串的输入与输出，现在来考虑这样一个问题：如何在一个字符串中查找一个给定的字符？下面给出了一般的解决方法：</p>
  <h5> SEARCH.ASM </h5>
  <pre class="code">        data  segment
              assume    ds:data
        mess  db        'Price: $1.00',0dh,0ah,0	；定义一个含有'$'的字符串
       ascii  db        '0123456789ABCDEF'	；十六进制数字对应的ASCII码
      errmsg  db        07h,'Character not found!',	0dh,0ah,'$'
        data  ends
        code  segment
              assume    cs:code
        main  proc      far
              mov       ax,data	；初始化DS寄存器指向数据段
              mov       ds,ax
              mov       si,offset mess	；SI寄存器指向字符串MESS
              mov       cx,0	；CX寄存器清0，准备计字符数
    outchar:
              mov       al,byte ptr [si]	；取一个字符送入AL寄存器
              cmp       al,'$'	；是所要找的'$'符吗？
              jz        out_cx	；若是则转OUT_CX输出CX寄存器中的值
              cmp       al,0	；到字符串结尾了吗？
              jz        not_fd	；显示出错信息并退出
              inc       cx	；CX寄存器加1
     out_cx:  inc       si	；SI寄存器指向下一个字符
              jmp       outchar	；判断下一个字符
              mov       ax,cx	；CX寄存器存入AX寄存器
    outloop:  mov       bx,offset ascii	；BX寄存器指向ASCII表
              mov       cx,4	；处理4个数位
			
              rol       ax,1	；循环左移4位，将高4位移至低4位
              rol       ax,1
              rol       ax,1
              rol       ax,1
              push      ax	；暂存AX寄存器
              and       ax,000fh	；保留低4位
              xlat      ；取得对应的ASCII码
              mov       ah,0eh	；利用10H中断的0EH功能
              int       10h	；输出AL中的字符
              pop       ax	；取回AX寄存器
              loop      outloop	；处理下一个数位
       exit:  mov       ah,4ch	；结束程序
              int       21h
     not_fd:  mov       dx,offset errmsg
              mov       ah,09h
              int       21h
              jmp       exit
        main  endp
        code  ends
              end       main
</pre>
  <p>程序中并没有使用LODS指令，而是把SI寄存器作为一个可以作间接寻址的一般寄存器应用。如何使用串处理指令解决这个问题呢？请看下面的程序：</p>
  <pre class="code">        data  segment
              assume    ds:data
        mess  db        'Price: $1.00',0dh,0ah,0
       ascii  db        '0123456789ABCDEF'
      errmsg  db        07h,'Character not found!',0dh,0ah,'$'	 ；字符未找到
        data  ends
        code  segment
              assume    cs:code
        main  proc      far
              mov       ax,data	；初始化DS、ES寄存器指向数据段
              mov       ds,ax
              mov       es,ax
              mov       di,offset mess	；DI寄存器指向字符串MESS
              mov       cx,14	；在14个字符中查找'$'
              mov       al,'$'	；要查找的字符是'$'
       repnz  scasb     ；扫描字符串
              jz        out_cx	；找到'$'后转至OUT_CX
              jmp       not_found	；未找到'$'则转至NOT_FOUND
     out_cx:  sub       di,offset mess+1	；计算'$'符的偏移位置
              mov       ax,di	；偏移位置送入AX寄存器
              mov       bx,offset ascii	；BX寄存器指向ASCII表
              mov       cx,4	；处理4个数位
    outloop:  rol       ax,1	；AX寄存器向左循环移4位
              rol       ax,1
              rol       ax,1
              rol       ax,1
              push      ax	；暂存AX寄存器
              and       ax,000fh	；保留AX寄存器的低4位
              xlat      ；取得对应的ASCII码
              mov       ah,0eh	；利用10H中断的0EH功能
              int       10h	；显示AL寄存器中的字符
              pop       ax	；取回AX寄存器
              loop      outloop	；处理下一个数位
              jmp       exit	；转至EXIT结束程序
			
  not_found:  mov       dx,offset errmsg	；显示出错信息
              mov       ah,9
              int       21h
       exit:  mov       ah,4ch	；结束程序
              int       21h
        main  endp
        code  ends
              end       main
</pre>
  <p>程序中新出现了一个寄存器--DI（Destination Index）。</p>
  <p>DI称为目的地址索引寄存器，它和SI寄存器一样用于保存串处理指令需要用到的地址，但这个寄存器指示的是&quot;目的地址&quot;，也就是说它和LODS这样的指令没有任何关系。只有那些具有&quot;写&quot;数据操作的串指令或串扫描、串比较指令才会使用DI寄存器中的地址。</p>
  <p> 当然DI寄存器也可以作间接寻址用，这和SI寄存器是一样的。还有一点需要注意的是在使用串处理指令时这个寄存器是和附加段寄存器ES相配合给出逻辑地址，只有在不用于串指令而作一般的间接寻址用时，才默认DS为段地址。 </p>
  <p>回顾一下上面的程序，我们在设定DS寄存器指向DATA段后又用MOV ES，AX指令将ES寄存器设为DATA段，目的就在于为后面的SCAS指令建立正确的字符串地址。那么SCAS指令又具有什么作用呢？</p>
  <p>助记符：SCAS（Scan string）<br />
    用　途：在&quot;目的串&quot;中搜索给定的数据<br />
    格　式：SCASB（搜索一字节）<br />
    SCASW（搜索一个字）<br />
    执　行：将位于ES：DI处的数据（字节或字）与累加器中的数据进行比较，并根据结果设定标志位，同时DI寄存器根据DF标志变化。</p>
  <p>和LODS一样，指令末尾的&quot;B&quot;和&quot;W&quot;表示所要搜索的数据位宽，DI寄存器究竟变化1还是2就由这两个字母决定。不过这个指令有个易搞混的问题，就是单独使用这个指令时是否会将字符串中所有数据都处理一次？</p>
  <p> 大家不要被它的名字蒙住，它虽然叫串扫描指令，但如果我们单独使用这个指令，它只会将ES：DI指向的数据与累加器相比，而后改变DI寄存器，并不像我们所想的那样将整个串中所有数据都扫一遍。而我们所需要的恰好是扫描整个串，这又该如何应用SCAS指令呢？</p>
  <p> 幸好SCAS指令可以配合一个前缀，这个前缀就是：</p>
  <p>助记符：REP（Repeat）<br />
    用　途：作为前缀使后面的串指令重复执行，重复次数在CX中设定。<br />
    格　式：REP  串处理指令<br />
    执　行：判断CX，若CX不为0，则CX寄存器减1，执行后面的指令，重复这三个步骤直至CX=0</p>
  <div class="rpindex"><a href="5-33.html">下一页</a> <a href="5-31.html">上一页</a> <a href="index.html">目录</a></div>


<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->
