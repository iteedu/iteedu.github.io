<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->


  <div class="lpindex"><a href="index.html">目录</a> <a href="8-23.html">上一页</a> <a href="9-1.html">下一章</a> </div>
  <p>程序所做的工作倒很简单，它会把软盘上1面0磁道第二扇区至第四扇区的内容读人内存，将读取到的数据按每32个字节为一组进行划分，并将每组前11个字节对应的ASCII字符显示出来。建议大家在驱动器中放入一片确实保存有文件的磁盘，这样就会看到有趣的运行结果。是不是觉得这个程序真有些象DIR命令呢？</p>
  <p> 看来对于一片1.44MB的磁盘来讲，其1面0磁道第二扇区开始保存了这片磁盘的目录表。不同容量的磁盘其目录表的起始位置以及所占的扇区数也不相同，但是目录表都具有相同的组织形式。请注意上面这个程序，它将磁盘的目录表按每32个字节为一组进行划分，为什么要这样做呢？我们知道每个文件都有一组表明自身特征的数据，比如文件长度、属性、建立的日期等等。这些数据和文件名、扩展名一起组成了完整的目录项，DOS为每个目录项分配了32个字节，关于这些字节的具体分配在此不作说明，大家可以参考其它书籍。</p>
  <p> 保留扇区内除了引导程序和目录表之外还有几个扇区，在这些扇区中DOS存储了一张&quot;文件分配表&quot;，一般称其为FAT（File Allocation Table）。这张表也是十分的重要，其结构也十分特殊，在此笔者不做更深入的分析。</p>
  <p> 在本章的最后，我们来共同研究一下关于磁盘格式化的知识。BIOS 13H中断为我们提供了一个格式化磁道的功能，这项功能的一个显著特点就是需要我们提供一组数据来描述磁盘扇区。这组数据的基本结构如下：</p>
  <p><img src="figures/F8_2.gif"  height="123" /></p>
  <p>其中&quot;扇区长度&quot;这个字节是用00-04分别表示128、256、512、1024字节。如果我们现在准备格式化一片1.44MB磁盘的0面第一磁道，那么程序中应给出这样一组数据：</p>
  <pre class="code">        DATA  SEGMENT
    SEC_DATA  DB        1,0,1,2	；第1扇区信息
              DB        1,0,2,2	；第2扇区信息
              DB        1,0,3,2	；第3扇区信息
	．．．．	．．．．	；顺次排列各扇区信息，注意扇区号的递增
              DB        1,0,15,2	；最后一个扇区
        DATA  ENDS
</pre>
  <p>　相应的代码段如下：</p>
  <pre class="code">        CODE  SEGMENT
        MAIN  PROC      FAR
              MOV       AX，DATA
              MOV       ES，AX	；设置ES：BX寄存器指向扇区信息表
              MOV       BX，OFFSET SEC_DATA
              MOV       AH，05H
              MOV       AL，15	；选择13H中断的"格式化磁道"功能
              MOV       CH，1	；格式化15个扇区
              MOV       DH，0	；格式化第1条磁道
              MOV       DL，0	；选择0磁头
              INT       13H	；格式化A驱
              JC        ERROR	；执行
	．．．．	．．	；出错转ERROR
        MAIN  ENDP      ；请大家自行完成以下部分
        CODE  ENDS
              END       MAIN
</pre>
  <p>这样一个程序执行起来意思不大，我们现在把那个数据表做些修改，将最后一个扇区的长度改为1024B，即把最后一个字节改为03H，然后再运行这个程序，这样就可以在这片磁盘上做出一条特殊的磁道。大家可以试着用DISKCOPY拷贝这片磁盘，看看能不能顺利完成。很多加密软件就是通过对磁盘进行&quot;非常规&quot;格式化来获得防拷贝能力的，笔者在此只是给大家开一个头儿，激发一下学习热情而已，更深入的知识还要靠各位自己去钻研。<br />
    至于磁盘校验功能大家不必深入掌握，因为最好的校验方法末过于将所有的扇区都读一遍，能正确读出当然就能说明磁盘无损坏。<br />
  <h4>本章结束语</h4>
  <p>在这一章中，我们不仅讨论了文件的存取，还讨论了有关磁盘的细节问题。在即将开始的新的一章里，我们将对PC系统的图形功能做一番深入探讨。与本章的内容相比，那是一个多彩的世界。</p>
  <div class="rpindex"> <a href="9-1.html">下一章 </a><a href="8-23.html">上一页</a><a href="index.html">目录</a> </div>


<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->
