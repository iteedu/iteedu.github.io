<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->


  <div  class="lpindex"><a href="index.html">目录</a> <a href="6-3.html">上一页</a> <a href="6-32.html">下一页</a> </div>
  <p>我们所要讨论的第二个重要的内容就是出现在屏幕上的文字和显示内存中各个字节的对应关系。我们知道每个显示出来的字符都由两部分内容组成，ASCII码和属性字节。其中ASCII码位于显示内存的偶数地址处，而属性字节位于奇数地址处。请看图6-6：</p>
  <p><img src="figures/F6_6.gif"  height="215" /></p>
  <h4>图6-6 屏幕字符与显示缓存的对应关系</h4>
  <p>利用DEBUG可以验证以上的结论：</p>
  <pre class="code">C:\ASM\>DEBUG[Enter] 
-eb800:0[Enter]			属性
B800:0000 53.41 07.01 45.42 07.41 54.43 07.81 55.44 07.94
B800:0008 50.		字符的ASCII码
</pre>
  <p>输入数据时请注意屏幕左上角是否出现了相应的字符和色彩。最后一个字母D的属性我们没有看到，被滚上去的内容盖掉了。不过这足以说明屏幕上每个文字和显示内存中各个字节的对应关系了。我们现在再来看看每个字符行在显示内存中的起始位置： </p>
  <pre class="code">C:\ASM\>DEBUG[Enter] 
-eb800:00a0[Enter]			属性
B800:00A0 57.41 07.01 50.42 07.41 53.43 07.94 20.44 07.82
B800:00A8 20.			字符的ASCII码
</pre>
  <p>可以看到第二个字符行起始于0B800:00A0处，第一行恰好占据了0A0H个字节。由此我们可以推导出屏幕上一个特定位置所对应的显示缓冲区内的偏移量为：</p>
  <p>偏移量＝行号×160＋列号×2（模式2、3） 偏移量＝行号×80＋列号×2（模式0、1）</p>
  <p>如果程序使用了40列25行的模式（模式号0、1），那么每个字符行将占据40×2＝80字节显示缓存，每个显示页将占据80×25＝2000字节内存。因此，对于模式0、1而言，显示页起始地址与每个字符对应的内存单元如图6-7（a）所示，注意每个显示页起始于2KB内存边界：</p>
  <p> 如果选择了80列25行的模式（模式号2、3），那么每行将占用160字节内存，每个显示页将占用4KB内存。这时显示页起始地址与每个字符对应的内存单元如图6-7（b）所示：</p>
  <p> 注意这个偏移量指得是在一个显示页之内，并非是在整个显示缓存中的偏移地址。如果将这个偏移量换算成显示缓存中的偏移量，则还要加上&quot;显示页号×每页占据的字节数&quot;。程序MODE1.ASM演示了如何操纵显示缓存，为了让大家对40列25行的模式有所认识，这个程序特地使用了CGA模式1： </p>
  <p><img src="figures/F6_7.gif"  height="253" /></p>
  <h4>图6-7 显示页起始地址与内存的对应关系 </h4>
  <h5>MODE1.ASM </h5>
  <pre class="code">        data  segment
              assume    ds:data
msg	db'Enter	into the paradise.',0	；定义一个字符串
        mode  db        ?	；保存显示模式号
        attr  db        1	；字符属性
        data  ends
        code  segment
              assume    cs:code
        main  proc      far
              mov       ax,data	；初始化DS寄存器
              mov       ds,ax
			
              mov       ah,0fh	；利用10H中断的0FH功能
              int       10h	；获得当前的显示模式
              mov       mode,al	；保存当前的显示模式
			
              mov       ax,0001h	；将显示模式设为1号
              int       10h
			
              mov       ax,0b800h	；显示缓冲区段地址置入ES寄存器
              mov       es,ax
              mov       di,0	；DI指向缓冲区首
			
              mov       si,offset msg	；SI指向字符串MSG
    dispmsg:
              lodsb     ；取得一个字符
              or        al,al	；已经到了字符串结尾了吗？
              jz        exit	；已到结尾，转EXIT退出
              mov       ah,attr	；属性字节送入AH寄存器
              stosw     ；将ASCII码与属性一同写入显示缓存中
              add       di,80	；DI寄存器后移80个字节
              inc       attr	；属性字节加1
              jmp       dispmsg	；转DISPMSG继续显示下一个字符
			
       exit:  mov       ah,0	；等待键盘输入
              int       16h
			
              mov       ah,0	；恢复原来的显示模式
              mov       al,mode
              int       10h
			
              mov       ah,4ch	；结束进程
              int       21h
        main  endp
        code  ends
              end       main
</pre>
  <div  class="rpindex"><a href="6-32.html">下一页</a><a href="6-3.html">上一页</a><a href="index.html">目录</a> </div>


<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->
