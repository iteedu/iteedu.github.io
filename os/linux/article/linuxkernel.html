<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->


<h1>一、下载源代码和编译软件的准备 </h1>
<p>
  下载内核源代码：http://www.kernel.org/ </p><p>
  注意，点击2.6.25内核的F版，即完整版。 </p><p>
  如果你懒得去网站点联接，运行下列命令：
</p>
<pre class="code">  $cd ~
  $ wget   http://www.kernel.org/pub/linux/kernel/v2.6/linux-2.6.25.10.tar.bz2
</pre>
<p>安装有关编译程序。安装make ,gcc,   make-kpkg,运行menuconfig等等和编译内核相关的工具。</p><p>
  安装不了，请检查/etc/apt/sources.list   文件。</p><p>
  有关命令：
</p>
<pre class="code">$sudo  apt-get install build-essential kernel-package   libncurses5-dev</pre>

<h1>二、解压源代码</h1>
<p>
  注意，网上很多教程上说应该解压到   /usr/src,纯属以讹传讹，linux掌门人linus说解压到任何目录上都可以。当然，linus的说法是正确的。我放在自己的主目录下的src目录。</p><p>
  如果你下载源代码是放到自己的主目录下或者运行上面的wget下载的，那么运行下列命令：</p>

<pre class="code">  $ cd ~ 
  $ mkdir src &amp;&amp; tar jfx linux-2.6.25.10.tar.bz2 -C src/</pre>

<p>现在，源代码就在 ~/src/linux-2.6.25.10</p>
<p><strong>注意目录容量要到达1.5G</strong></p>
<p>
  进入源代码的目录，准备下一步的工作。后面都在这个目录里面进行。</p>

<pre class="code">$ cd ~/src/linux-2.6.25.10</pre>

<h1>三、开始编译前的准备工作。</h1>
<p>
  首先，清理以前编译时留下的临时文件。如果是刚刚解开的包，不需要执行这步。如果是第二次或者是第n次编译，那么一定要执行。</p><p>
相关命令如下：</p>

<pre class="code">$ sudo make mrproper</pre>

<p>网上很多教程上说把现在使用的内核的config拷贝过来参考，据实验，是不需要的，ubuntu还有debian会自动做这步。不过这条命令倒是可以学习一下。当然你可以将以前的配置拷贝过来。</p><p>
  命令：</p>

<pre class="code">cp /boot/config-`uname -r` ./.config</pre>
<p>./.config的意思是拷贝到当前目录并以.config重命名。</p>
<p><strong>注意：在配制内核时，修改的文件为linux-2.6.25.10文件夹中的.config文件。这是个隐藏文件，更改查看方式可以看到。是make mrproper时自动拷贝过来的，下载的源包中没有。</strong></p>
<h1>四、开始配置内核选项。</h1>
<p>从linux-2.6.32开始可以使用make localmodconfig自动精简内核, 菜鸟也能轻松精简内核到十几MB<BR>
  <BR>
  注意: 该方法会自动去掉一些从开机到当前没用使用的模块(主要是驱动模块), 
  所以你可以使用一下你的摄像头, 挂载一下iso文件.....<BR>
  以保证需要的模块不会被精简掉, 否则使用新内核时会发现不能挂载iso文件,   不能使用某些外设等等.<BR>
  命令如下:</p>
<pre class="code">make localmodconfig
</pre>
<p>
  <span class="code">menuconfig</span>相关命令：</p>

<pre class="code">$sudo make menuconfig
</pre>

<p><img src="menuconfig.gif" width="500" height="318"></p>
<p>配置用到的键只有几个，esc退出菜单;空格改变选项状态;光标键上下左右移动,回车选定。</p>
<p>
  选项意义：M是编译成可以随时加入的模块，*是编译进入内核，空就是不要。</p>
<p>xconfig 相关命令：</p>
<pre class="code">sudo aptitude install libqt3-headers libqt3-mt-dev libqt3-compat-headers    libqt3-mt #安装xconfig依赖包</pre>
<pre class="code">make xconfig</pre>

<p><img src="xconfig.png" width="512" height="384"> </p>
<p>配置选项非常多，具体配置可以参考金步国先生翻译的资料：Linux   2.6.19.x   内核编译配置选项。</p>
<p>
  为了一次成功，请大家遵循一个原则，如果你自己使用的内核已经选用了某个选项，如果你没用充分的理由，不要随便改动。这样虽然内核不那么精简，但是不容易出现问题。</p><p>
  我们可以精简的部分是硬件模块部分，对于自己没有的硬件要毫不犹豫的清除。</p>
<h1>五、必须强调的几个选项:</h1>
<p>看<a href="kernelconfig.html">config配制详解</a></p><p>
  按照我的习惯，先在上一层目录保存一个备份，文件名类似   ../config20080630</p><p>
  然后再保存到当起目录,文件名 .config</p><p>
  退出设置程序。</p>
<h1>六、开始编译内核。</h1>
<p>
  ubuntu的工具是make-kpkg,和其他的发行版相比，步骤相对简单。</p><p>
相关命令:</p>
<pre class="code">$sudo make-kpkg clean     #这条命令好像不要超级权限，很多资料上说要，不过这不是原则问题。
$ sudo make-kpkg -initrd --initrd   --append-to-version=-dell1400 kernel_image kernel-headers</pre>
<p>
上述命令中的dell1400可以用自己喜欢的字符代替，最后的字符一定是数字.</p>
<h1>
  七、安装内核</h1>
<p>
编译完成就是安装工作。编译好的内核在上一层目录。包括linux-headers-...-_i386.deb和linux-image-...-i386.deb两个文件，如果你不搞开发的话，只要安装内核就可以，头文件以后要用的时候再说。</p><p>
安装相关命令：</p>
<pre class="code">
  $ cd ..
  $ sudo dpkg -i     linux-image-（按tab键）</pre><p>文件名很长，如果不用tab自动补足是不可能的，tab键万岁。</p>
  <h1>
八、重新启动验证新内核。</h1>
<pre class="code">
$ sudo reboot</pre>
<h1>
  九、显卡驱动</h1>
<p>
如果你的显卡是nvidia显卡，启动之后往往无法正常进入x－window。即使能看到gdm登录界面，效果也是很差的。</p><p>
那么就要安装nvidia驱动。</p><p><a href="installnvidia.html">nvidia显卡驱动安装</a></p>
<h1>
  十、无线网卡</h1>
<p><a href="installwireless.html">无线网卡驱动安装</a></p>
<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->