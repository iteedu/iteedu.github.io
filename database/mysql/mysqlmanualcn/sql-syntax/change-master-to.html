<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->

<!--end of htmlmiddle-->



<h1>13.6.2.1. CHANGE 
                MASTER TO语法</h1>

            
          
        
        
        <pre>&nbsp; CHANGE MASTER TO <i>master_def</i> [, <i>master_def</i>] ...
&nbsp;
master_def:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MASTER_HOST = &#39;<i>host_name</i>&#39;
&nbsp;&nbsp;&nbsp; | MASTER_USER = &#39;<i>user_name</i>&#39;
&nbsp;&nbsp;&nbsp; | MASTER_PASSWORD = &#39;<i>password</i>&#39;
&nbsp;&nbsp;&nbsp; | MASTER_PORT = <i>port_num</i>
&nbsp;&nbsp;&nbsp; | MASTER_CONNECT_RETRY = <i>count</i>
&nbsp;&nbsp;&nbsp; | MASTER_LOG_FILE = &#39;<i>master_log_name</i>&#39;
&nbsp;&nbsp;&nbsp; | MASTER_LOG_POS = <i>master_log_pos</i>
&nbsp;&nbsp;&nbsp; | RELAY_LOG_FILE = &#39;<i>relay_log_name</i>&#39;
&nbsp;&nbsp;&nbsp; | RELAY_LOG_POS = <i>relay_log_pos</i>
&nbsp;&nbsp;&nbsp; | MASTER_SSL = {0|1}
&nbsp;&nbsp;&nbsp; | MASTER_SSL_CA = &#39;<i>ca_file_name</i>&#39;
&nbsp;&nbsp;&nbsp; | MASTER_SSL_CAPATH = &#39;<i>ca_directory_name</i>&#39;
&nbsp;&nbsp;&nbsp; | MASTER_SSL_CERT = &#39;<i>cert_file_name</i>&#39;
&nbsp;&nbsp;&nbsp; | MASTER_SSL_KEY = &#39;<i>key_file_name</i>&#39;
&nbsp;&nbsp;&nbsp; | MASTER_SSL_CIPHER = &#39;<i>cipher_list</i>&#39;</pre>
        <p>可以更改从属服务器用于与主服务器进行连接和通讯的参数。</p>
        <p>MASTER_USER,
          MASTER_PASSWORD,
          MASTER_SSL,
          MASTER_SSL_CA,
          MASTER_SSL_CAPATH,
          MASTER_SSL_CERT,
          MASTER_SSL_KEY和MASTER_SSL_CIPHER用于向从属服务器提供有关如何与主服务器连接的信息。</p>
        <p>即使对于在编译时没有SSL支持的从属服务器，SSL选项(MASTER_SSL,
          MASTER_SSL_CA,
          MASTER_SSL_CAPATH,
          MASTER_SSL_CERT,
          MASTER_SSL_KEY和MASTER_SSL_CIPHER)也可以被更改。它们被保存到master.info文件中，但是会被忽略，直到您使用一个SSL支持已启用的服务器。</p>
        <p>如果您不指定一个给定的参数，则它会保持其原有的值。例外情况在后面的讨论中进行了说明。举例说明，如果用于连接到您的MySQL主服务器的
          密码被更改了，您只需发布这些语句，就可以告知从属服务器新的密码：</p>
        <pre>mysql&gt; STOP SLAVE; -- if replication was running
mysql&gt; CHANGE MASTER TO MASTER_PASSWORD=&#39;new3cret&#39;;
mysql&gt; START SLAVE; -- if you want to restart replication</pre>
        <p>没有必要指定没有改变的参数（主机、接口、用户等）。</p>
        <p>MASTER_HOST和MASTER_PORT是主服务器主机和其TCP/IP接口的主机名（或IP地址）。注意，如果MASTER_HOST与localhost相等，那么，和MySQL的其它部分一样，接口可以被忽略（例如，如果可以使用Unix插槽文件）。</p>
        <p>如果您指定了MASTER_HOST或MASTER_PORT，则从属服务器会假定主服务器与以前不一样（即使您指定的主机或接口值与当前值是一样的。）在此情况下，主服务器二进制日志的名称和位置的原有值不再适用，因此，如果您不指定语句中的MASTER_LOG_FILE和MASTER_LOG_POS，MASTER_LOG_FILE=&#39;&#39;和MASTER_LOG_POS=4会被静默地添加。</p>
        <p>在MASTER_LOG_FILE和MASTER_LOG_POS坐标点，从属服务器I/O线程在启动之后从主服务器读取。如果您只指定了其中一个，则从属服务器不能指定RELAY_LOG_FILE或RELAY_LOG_POS。如果MSATER_LOG_FILE和MASTER_LOG_POS都没有被指定，则从属服务器会使用在CHANGE 
          MASTER被发布前的最后一个slave SQL thread坐标。当您只想改变要使用的
          密码时，这可以确保复制的连续性。即使从属服务器SQL线程落后于从属服务器I/O线程，也可以确保复制的连续性。</p>
        <p>CHANGE MASTER会删除所有的中继日志文件并启动一个新的日志，除非您指定了RELAY_LOG_FILE或RELAY_LOG_POS。在此情况下，中继日志被保持；relay_log_purge全局变量被静默地设置为0。</p>
        <p>CHANGE MASTER TO可以更新master.info和relay-log.info文件的内容。</p>
        <p>当您拥有主服务器快照并拥有日志和对应的偏移量时，CHANGE MASTER对于设置从属服务器是有用的。在把快照载入从属服务器之后，您可以在从属服务器上运行CHANGE 
          MASTER TO MASTER_LOG_FILE=&#39;<i>log_name_on_master</i>&#39;, 
          MASTER_LOG_POS=<i>log_offset_on_master</i>。</p>
        <p>举例说明：</p>
        <pre>mysql&gt; CHANGE MASTER TO
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; MASTER_HOST=&#39;master2.mycompany.com&#39;,
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; MASTER_USER=&#39;replication&#39;,
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; MASTER_PASSWORD=&#39;bigs3cret&#39;,
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; MASTER_PORT=3306,
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; MASTER_LOG_FILE=&#39;master2-bin.001&#39;,
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; MASTER_LOG_POS=4,
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; MASTER_CONNECT_RETRY=10;
&nbsp;
mysql&gt; CHANGE MASTER TO
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; RELAY_LOG_FILE=&#39;slave-relay-bin.006&#39;,
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; RELAY_LOG_POS=4025;</pre>
        <p>第一个例子可以更改主服务器及其二进制日志坐标。当想要设置从属服务器来复制主服务器时使用。</p>
        <p> 第二个例子显示了较少被使用的一个操作。当从属服务器含有中继日志，并且您出于某种原因想要执行此日志时使用。要这么做时，不需要连接主服务器。您只需要使用CHANGE 
          MASTER TO并启动SQL线程（START 
          SLAVE SQL_THREAD）。</p>
        <p> 您甚至可以在一个用于独立非从属服务器的非复制型设置中使用第二种操作，在崩溃之后进行复原。假设您的服务器已崩溃，同时您已恢复了备份。您想要重新播放服务器自己的二进制日志（不是中继日志，而是正规的二进制文件），例如名为myhost-bin.*。首先，应在安全的地方制作这些二进制日志的备份，以防您没有完全遵守以下步骤，意外地让服务器清理了二进制文件。使用SET 
          GLOBAL relay_log_purge=0，进一步增加安全性。然后启动不含--log-bin选项的服务器。使用--replicate-same-server-id,
          --relay-log=myhost-bin（让服务器相信，这些正规的二进制日志是中继日志）和--skip-slave-start 
          options选项。当服务器启动后，发布以下语句：</p>
        <pre>mysql&gt; CHANGE MASTER TO
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; RELAY_LOG_FILE=&#39;myhost-bin.153&#39;,
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; RELAY_LOG_POS=410,
&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp; MASTER_HOST=&#39;some_dummy_string&#39;;
mysql&gt; START SLAVE SQL_THREAD;</pre>
        <p>服务器会读取并执行自己的二进制日志，完成崩溃复原。当复原完成后，运行STOP SLAVE，关闭服务器，删除master.info和relay-log.info，并使用原来的选项重新启动服务器。</p>
        <p>要让服务器认为它是一个从属服务器，需要指定MASTER_HOST（甚至使用假值）。
      
      
        
          
            
              


<!--start of htmlend-->
<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->