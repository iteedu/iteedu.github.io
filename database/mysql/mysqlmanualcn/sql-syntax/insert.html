<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->

<!--end of htmlmiddle-->



<h1>13.2.4. INSERT语法</h1>

          
        
      
      
        <dl>
          <dt><a href="insert-select.html">13.2.4.1. 
            INSERT ... SELECT语法</a></dt>
          <dt><a href="insert-delayed.html">13.2.4.2. 
            INSERT DELAYED语法</a></dt>
        </dl>
      
      
      <pre>INSERT [LOW_PRIORITY | DELAYED | HIGH_PRIORITY] [IGNORE]
&nbsp;&nbsp;&nbsp; [INTO] <i>tbl_name</i> [(<i>col_name</i>,...)]
&nbsp;&nbsp;&nbsp; VALUES ({<i>expr</i> | DEFAULT},...),(...),...
&nbsp;&nbsp;&nbsp; [ ON DUPLICATE KEY UPDATE <i>col_name</i>=<i>expr</i>, ... ]</pre>
      <p>或：</p>
      <pre>INSERT [LOW_PRIORITY | DELAYED | HIGH_PRIORITY] [IGNORE]
&nbsp;&nbsp;&nbsp; [INTO] <i>tbl_name</i>
&nbsp;&nbsp;&nbsp; SET <i>col_name</i>={<i>expr</i> | DEFAULT}, ...
&nbsp;&nbsp;&nbsp; [ ON DUPLICATE KEY UPDATE <i>col_name</i>=<i>expr</i>, ... ]</pre>
      <p>或：</p>
      <pre>INSERT [LOW_PRIORITY | HIGH_PRIORITY] [IGNORE]
&nbsp;&nbsp;&nbsp; [INTO] <i>tbl_name</i> [(<i>col_name</i>,...)]
&nbsp;&nbsp;&nbsp; SELECT ...
&nbsp;&nbsp;&nbsp; [ ON DUPLICATE KEY UPDATE <i>col_name</i>=<i>expr</i>, ... ]</pre>
      <p>INSERT用于向一个已有的表中插入新行。INSERT...VALUES和INSERT...SET形式的语句根据明确指定的值插入行。INSERT...SELECT形式的语句插入从其它表中选出的行。在<a href="insert-select.html" title="13.2.4.1. INSERT ... SELECT Syntax">13.2.4.1节，“INSERT 
        ... SELECT语法”</a>中对INSERT...SELECT进行了进一步的讨论。</p>
      <p>行应被插入到<i>tbl_name</i>表中。可以按以下方法指定列。本语句向这些列提供值。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        列名称清单或SET子句明确的指示了列。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        如果您不为INSERT...VALUES或INSERT...SELECT指定列的清单，则表中每列的值必须在VALUES清单中提供，或由SELECT提供。如果您不知道表中各列的顺序，则使用DESCRIBE <i>tbl_name</i>查询。</p>
      <p>列值可以采用多种方法给定：</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  如果不是在严格模式下运行，则所有没有明确给定值的列都被设置为默认值（明确的或隐含的）。例如，如果您指定了一个列清单，但此清单没有对表中所有的列进行命名，则未命名的各列被设置为默认值。默认值的赋值在<a href="create-table.html" title="13.1.5. CREATE TABLE Syntax">13.1.5节，“CREATE 
        TABLE语法”</a>中进行了说明。也可参见<a href="" title="1.8.6.2. Constraints on Invalid Data">1.8.6.2节，“对无效数据的约束”</a>。</p>
      <p> 有时候，您需要对所有没有默认值的列明确地指定值。如果您希望，在没有明确指定值时，INSERT语句可以生成错误信息，则您应该使用STRICT模式。请参见<a href="create-table.html" title="5.3.2. The Server SQL Mode">5.3.2节，“SQL服务器模式”</a>。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        使用关键词DEFAULT，明确地把列设置为默认值。这样，编写向所有列赋值的INSERT语句时可以更容易，因为使用DEFAULT可以避免编写出不完整的、未包含全部列值的VALUES清单。如果不使用DEFUALT，您必须编写一个列名称清单，与VALUES清单中的每个值对应。</p>
      <p>您还可以使用DEFAULT(<i>col_name</i>)作为一种更通用的形式，在表达式中使用，用于生成一个列的默认值。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        如果列清单和VALUES清单均为空清单，则INSERT会创建一个行，每个列都被设置为默认值：</p>
      <pre>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mysql&gt; INSERT INTO <i>tbl_name</i> () VALUES();</pre>
      <p>在STRICT模式中，如果有一列没有默认值，则会出现错误。或者，MySQL会对所有没有明确定义默认值的列使用隐含的默认值。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        您可以指定一个表达式<i>expr</i>来提供一个列值。如果表达式的类型与列值不匹配，这样做会造成类型转化。并且，给定值的转化会导致不同的插入值，插入何值由列类型而定。例如，向一个INT, 
        FLOAT, DECIMAL(10,6)或YEAR列插入字符串&#39;1999.0e-2&#39;，插入值分别是1999，19.9921，19.992100和1999。存储在INT和YEAR列中的值为1999的原因是，在从字符串到整数的转化中，只把字符串的前面部分看作有效的整数或年份。对于浮点列和固定点列，在从字符串到浮点的转化中，把整个字符串均看作有效的浮点值。</p>
      <p>表达式<i>expr</i>可以引用在值清单中已设置的所有列。例如，您可以这么操作，因为用于col2的值引用了col1，而col1已经被赋值：</p>
      <pre>mysql&gt; INSERT INTO <i>tbl_name</i> (<i>col1</i>,<i>col2</i>) VALUES(15,<i>col1</i>*2);</pre>
      <p>但是以下语句不合法，因为用于col1的值引用了col2，而col2在col1之后被赋值：</p>
      <pre>mysql&gt; INSERT INTO <i>tbl_name</i> (<i>col1</i>,<i>col2</i>) VALUES(<i>col2</i>*2,15);</pre>
      <p>有一种例外情况，那就是含有AUTO_INCREMENT值的列。因为AUTO_INCREMENT值在其它值赋值之后被生成，所以任何在赋值时对AUTO_INCREMENT列的引用都会返回0。</p>
      <p>INSERT语句支持下列修改符：</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        如果您使用DELAYED关键字，则服务器会把待插入的行放到一个缓冲器中，而发送INSERT 
        DELAYED语句的客户端会继续运行。如果表正在被使用，则服务器会保留这些行。当表空闲时，服务器开始插入行，并定期检查是否有新的读取请求。如果有新的读取请求，则被延迟的行被延缓执行，直到表再次空闲时为止。请参见<a href="insert-delayed.html" title="13.2.4.2. INSERT DELAYED Syntax">13.2.4.2节，“INSERT 
        DELAYED语法”</a>。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        如果您使用LOW_PRIORITY关键词，则INSERT的执行被延迟，直到没有其它客户端从表中读取为止。当原有客户端正在读取时，有些客户端刚开始读取。这些客户端也被包括在内。此时，INSERT 
        LOW_PRIORITY语句等候。因此，在读取量很大的情况下，发出INSERT 
        LOW_PRIORITY语句的客户端有可能需要等待很长一段时间（甚至是永远等待下去）。（这与INSERT 
        DELAYED形成对比，INSERT DELAYED立刻让客户端继续执行。请参见<a href="insert-delayed.html" title="13.2.4.2. INSERT DELAYED Syntax">13.2.4.2节，“INSERT 
        DELAYED语法”</a>。）注意LOW_PRIORITY通常不应用于MyISAM表，因为这么做会取消同时进行的插入。请参见<a href="create-table.html" title="15.1. The MyISAM Storage Engine">15.1节，“MyISAM存储引擎”</a>。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        如果您指定了HIGH_PRIORITY，同时服务器采用--low-priority-updates选项启动，则HIGH_PRIORITY将覆盖--low-priority-updates选项。这么做还会导致同时进行的插入被取消。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        使用mysql_affected_rows() 
        C API函数，可以获得用于INSERT的受影响行的值。请参见<a href="" title="25.2.3.1. mysql_affected_rows()">25.2.3.1节，“mysql_affected_rows()”</a>。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        如果您在一个INSERT语句中使用IGNORE关键词，在执行语句时出现的错误被当作警告处理。例如，没有使用IGNORE时，如果一个行复制了原有的UNIQUE索引或PRIMARY 
        KEY值，会导致出现重复关键字错误，语句执行失败。使用IGNORE时，该行仍然未被插入，但是不会出现错误。IGNORE未被指定时，如果数据转化引发错误，则会使语句执行失败。使用IGNORE后，无效数据被调整到最接近的值，并被插入；此时，生成警告，但是语句执行不会失败。您可以使用mysql_info() 
        C API函数测定有多少行被插入到表中。</p>
      <p>如果您指定了ON DUPLICATE KEY UPDATE，并且插入行后会导致在一个UNIQUE索引或PRIMARY 
        KEY中出现重复值，则执行旧行UPDATE。例如，如果列a被定义为UNIQUE，并且包含值1，则以下两个语句具有相同的效果：</p>
      <pre>mysql&gt; INSERT INTO table (a,b,c) VALUES (1,2,3)
&nbsp;&nbsp;&nbsp; -&gt; ON DUPLICATE KEY UPDATE c=c+1;
&nbsp;
mysql&gt; UPDATE table SET c=c+1 WHERE a=1;</pre>
      <p>如果行作为新记录被插入，则受影响行的值为1；如果原有的记录被更新，则受影响行的值为2。</p>
      <p>注释：如果列b也是唯一列，则INSERT与此UPDATE语句相当：</p>
      <pre>mysql&gt; UPDATE table SET c=c+1 WHERE a=1 OR b=2 LIMIT 1;</pre>
      <p>如果a=1 OR b=2与多个行向匹配，则只有一个行被更新。通常，您应该尽量避免对带有多个唯一关键字的表使用ON 
        DUPLICATE KEY子句。</p>
      <p>您可以在UPDATE子句中使用VALUES(col_name)函数从INSERT...UPDATE语句的INSERT部分引用列值。换句话说，如果没有发生重复关键字冲突，则UPDATE子句中的VALUES(<i>col_name</i>)可以引用被插入的<i>col_name</i>的值。本函数特别适用于多行插入。VALUES()函数只在INSERT...UPDATE语句中有意义，其它时候会返回NULL。</p>
      <p>示例：</p>
      <pre>mysql&gt; INSERT INTO table (a,b,c) VALUES (1,2,3),(4,5,6)
&nbsp;&nbsp;&nbsp; -&gt; ON DUPLICATE KEY UPDATE c=VALUES(a)+VALUES(b);</pre>
      <p>本语句与以下两个语句作用相同：</p>
      <pre>mysql&gt; INSERT INTO table (a,b,c) VALUES (1,2,3)
&nbsp;&nbsp;&nbsp; -&gt; ON DUPLICATE KEY UPDATE c=3;
mysql&gt; INSERT INTO table (a,b,c) VALUES (4,5,6)
&nbsp;&nbsp;&nbsp; -&gt; ON DUPLICATE KEY UPDATE c=9;</pre>
      <p>当您使用ON DUPLICATE KEY UPDATE时，DELAYED选项被忽略。</p>
      <p>您可以使用SQL LAST_INSERT_ID()函数查找用于AUTO_INCREMENT列的值。从C 
        API的内部，使用mysql_insert_id()函数。不过，您应该注意，两个函数的作用并不总是相同的。在<a href="insert.html" title="12.9.3. Information Functions">12.9.3节，“信息函数”</a>和<a href="insert.html" title="25.2.3.36. mysql_insert_id()">25.2.3.36节，“mysql_insert_id()”</a>中进一步讨论了与AUTO_INCREMENT列有关的INSERT语句的作用。</p>
      <p>如果您使用INSERT...VALUES语句时采用了多个值清单或INSERT...SELECT，则该语句按以下格式返回一个信息字符串：</p>
      <pre>Records: 100 Duplicates: 0 Warnings: 0</pre>
      <p> 记录指示了经过语句处理的行的数目。（因为重复数目可以不是零，所以该数目不一定是实际被插入的行的数目。）重复数目指的是不能被插入的行的数目，因为这些行会复制部分原有的唯一索引值。警告指的是插入有错误或有问题的列值的次数。在以下情况下会出现警告：</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        向一个已定义为NOT NULL的列中插入NULL。对于一个多行INSERT语句或INSERT 
        INTO...SELECT语句，根据列数据的类型，列被设置为隐含的默认值。对于数字类型，默认值为0；对于字符串类型，默认值为空字符串(&#39;&#39;)；对于日期和时间类型，默认值为“zero”值。对INSERT 
        INTO...SELECT语句的处理方法与对多行插入的处理方法一样，因为服务器不能检测来自SELECT的结果，不能判断是否返回单一行。（对于单一行INSERT，当NULL被插入一个NOT 
        NULL列时，不会出现警告，而是出现错误，并且语句运行失败。）</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        数字列的值被设置在列的值范围之外。此值被修改为未最接近的值范围端点。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        向一个数字列赋予一个例如&#39;10.34 
        a&#39;的值。尾部的非数字文本被删节，其余的数字部分被插入，如果字符串值没有前导的数字部分，则该列被设置为0。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        向一个字符串列（CHAR, VARCHAR, TEXT或BLOB）中插入的字符串超过了列的最大长度。此值被删节到列的最大长度。</p>
      <p> ·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        向日期或时间列中插入的值对于该列的类型是不合法的。根据列的类型，该列被设置到相应的零值。</p>
      <p>如果您正在使用C API，则可以通过调用mysql_info()函数获取信息字符串。请参见<a href="load-data.html" title="25.2.3.34. mysql_info()">25.2.3.34节，“mysql_info()”</a>。</p>
      
      
        
          
            
              


<!--start of htmlend-->
<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->