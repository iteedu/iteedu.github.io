<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<!--end of htmlmiddle-->


<div class="section" lang="zh-cn">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="portlet-controller"></a>16.4.&#160;控制器</h2></div></div></div>
<p>Portlet MVC里的控制器和Web MVC的很相似，在两者之间移植代码很简单。</p>
<p>Portlet MVC控制器构架的基础是
		<code class="interfacename">org.springframework.web.portlet.mvc.Controller</code> 
		接口，如下所示。</p>
<pre class="code">public interface Controller {

    /**
     * Process the render request and return a ModelAndView object which the
     * DispatcherPortlet will render.
     */
    ModelAndView handleRenderRequest(RenderRequest request, RenderResponse response)
        throws Exception;

    /**
     * Process the action request. There is nothing to return.
     */
    void handleActionRequest(ActionRequest request, ActionResponse response)
        throws Exception;

}</pre>
<p>如你所见，Portlet
		<code class="interfacename">Controller</code>接口需要两个方法来处理Portlet
		请求的两个阶段：动作请求和显示请求。动作阶段应该能够处理动作请求，显示阶段应该
		能够处理显示请求，并返回合适的模型和视图。 
		尽管<code class="interfacename">Controller</code>接口是抽象的，但Spring Portlet MVC
		提供了很多包含了各种各样你需要的功能的控制器-它们中的大多数和Spring Web MVC里的控制器很类似。
		<code class="interfacename">Controller</code>接口只定义每个控制器需要的通用的功能
		- 处理动作请求，处理显示请求，返回模型和视图。</p>
<div class="section" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="portlet-controller-abstractcontroller"></a>16.4.1.&#160;<code class="classname">AbstractController</code> 和 <code class="classname">PortletContentGenerator</code></h3></div></div></div>
<p>当然，仅一个<code class="interfacename">Controller</code> 
			是不够的。为了提供基本的功能，所有的Spring Portlet
			<code class="interfacename">Controller</code>从
			<code class="classname">AbstractController</code>继承，后者可以访问Spring
			的<code class="interfacename">ApplicationContext</code>和控制缓存。</p>
<div class="table">
<a name="portlet-ac-features"></a><p class="title"><b>表&#160;16.3.&#160;<code class="classname">AbstractController</code>提供的功能</b></p>
<div class="table-contents"><table summary="AbstractController提供的功能" border="1">
<colgroup>
<col align="left">
<col>
</colgroup>
<thead><tr>
<th align="left">参数</th>
<th>解释</th>
</tr></thead>
<tbody>
<tr>
<td align="left"><code class="literal">requireSession</code></td>
<td>表明当前的
							<code class="interfacename">Controller</code>是否需要session。
							所有的控制器都能使用这个功能。如果这样的控制器收到请求时，
							session不存在，用户会收到
							<code class="classname">SessionRequiredException</code>异常。</td>
</tr>
<tr>
<td align="left"><code class="literal">synchronizeSession</code></td>
<td>如果需要控制器在处理用户session时保持同步，使用
							这个参数。更具体来说，扩展的控制器会覆盖<code class="methodname">handleRenderRequestInternal(..)</code>
							和<code class="methodname">handleActionRequestInternal(..)</code>方法，如果指定了这个参数，
							这两个方法会在处理用户session时保持同步。</td>
</tr>
<tr>
<td align="left"><code class="literal">renderWhenMinimized</code></td>
<td>如果需要在portlet最小化状态时，控制器也显示视图，
							把这个参数设为true。这个参数缺省是false，所以portlet在最小化状态
							时，不显示内容。</td>
</tr>
<tr>
<td align="left"><code class="literal">cacheSeconds</code></td>
<td>在需要控制器覆盖当前portlet定义的缺省缓存失效时间时，
							设置一个正的整数。这个参数缺省是<code class="literal">-1</code>，
							表示不改变缺省的缓存，把它设为<code class="literal">0</code>，就是
							确保不缓存结果。</td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><p><code class="literal">requireSession</code>和 
			<code class="literal">cacheSeconds</code>属性是在
			<code class="classname">AbstractController</code>的父类
			<code class="classname">PortletContentGenerator</code>里声明的。为了完整性，
			把它们列在这里。</p>
<p>在你自己的控制器里继承<code class="classname">AbstractController</code>时
			（不推荐这样做，因为已经有许多现成的控制器，它们可能有你需要的功能），仅需要覆盖
			<code class="methodname">handleActionRequestInternal(ActionRequest, 
			ActionResponse)</code>方法或 
			<code class="methodname">handleRenderRequestInternal(RenderRequest, 
			RenderResponse)</code>方法（或两者都覆盖），实现逻辑，
			并返回 <code class="classname">ModelAndView</code> 对象（如果是
			<code class="literal">handleRenderRequestInternal</code>方法）。</p>
<p><code class="methodname">handleActionRequestInternal(..)</code>和 
			<code class="methodname">handleRenderRequestInternal(..)</code>方法的缺省实现都会
			抛出<code class="classname">PortletException</code>，这和JSR-168规范API里的
			<code class="classname">GenericPortlet</code>的行为是一致的。所以只要覆盖你的控制器
			需要处理的方法。</p>
<p>下面简短的例子包含了一个类和一个在web应用context里的声明。</p>
<pre class="code">package samples;

import javax.portlet.RenderRequest;
import javax.portlet.RenderResponse;

import org.springframework.web.portlet.mvc.AbstractController;
import org.springframework.web.portlet.ModelAndView;

public class SampleController extends AbstractController {

    public ModelAndView handleRenderRequestInternal(
        RenderRequest request,
        RenderResponse response) throws Exception {

        ModelAndView mav = new ModelAndView("foo");
        mav.addObject("message", "Hello World!");
        return mav;
    }
}

&lt;bean id="sampleController" class="samples.SampleController"&gt;
    &lt;property name="cacheSeconds" value="120"/&gt;
&lt;/bean&gt;</pre>
<p>为了使得一个简单的控制器工作，你只需要类似上面的类和在web应用context里的声明，
			并且再设置一下处理器映射（见 <a href="ch16s05.html" title="16.5.&#160;处理器映射">第&#160;16.5&#160;节 “处理器映射”</a>）。</p>
</div>
<div class="section" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="portlet-controller-simple"></a>16.4.2.&#160;其它简单的控制器</h3></div></div></div>
<p>尽管你能够继承<code class="classname">AbstractController</code>，
			Spring Portlet MVC提供了不少具体的实现，它们提供了许多在简单MVC应用里常用的功能。
			</p>
<p><code class="classname">ParameterizableViewController</code>基本上
			和上面的例子类似，除了你能指定web应用context返回的视图的名字。（不需要写死视图名称）。
			</p>
<p><code class="classname">PortletModeNameViewController</code>把当前的
			Portlet的状态作为视图名，如果Portlet在View模式
			（比如：<code class="literal">PortletMode.VIEW</code>），这个“View”就是视图名。</p>
</div>
<div class="section" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="portlet-controller-command"></a>16.4.3.&#160;Command控制器</h3></div></div></div>
<p>Spring Portlet MVC提供了和Spring Web MVC完全一致的
			<span class="emphasis"><em>command controllers</em></span>层次结构，提供方法来与数据对象交互
			并且动态地把参数从<code class="interfacename">PortletRequest</code>
			绑定到数据对象上。数据对象不需要实现框架相关的接口，因而你可以
			直接操作这些持久化对象。下面让我们查看Command控制器提供的功能，来了解它们的使用：
			</p>
<div class="itemizedlist"><ul type="disc">
<li><p><code class="classname">AbstractCommandController</code> 
				- Command控制器，可以用来创建自己的控制器，它能够将请求里的参数
				绑定到指定的数据对象。这个类不提供表单功能，但它提供验证功能，并且
				可以在控制器里指定如何处理带有请求参数的Command对象。</p></li>
<li><p><code class="classname">AbstractFormController</code> -
				提供表单提交支持的抽象控制器。你能够对表单进行建模，通过从控制器
				里得到的Command对象来填充表单。在用户提交表单后， 
				<code class="classname">AbstractFormController</code>会绑定字段、进行验证，
				然后把对象返回给控制器来做下一步的动作。支持的功能有：无效表单提交(重新
				提交)、验正和通常的表单流程。你需要实现方法来决定表单的显示和成功时使用的
				视图。如果你需要表单，但不想在应用context里指定用户看到的视图，使用这个
				控制器。</p></li>
<li><p><code class="classname">SimpleFormController</code> -
				一个具体的<code class="classname">AbstractFormController</code>，
				对使用对应的command对象生成表单提供了更多的支持。
				<code class="classname">SimpleFormController</code>可以让你在用户成功地提交
				表单或其它状态时，指定command对象，表单的视图名以及页面对应的视图名。</p></li>
<li><p><code class="classname">AbstractWizardFormController</code> –
				具体的<code class="classname">AbstractFormController</code>，它提交了向导式的接口
				来编辑跨多个页面的command对象。支持多种用户动作：完成、取消或者页面变化，所有这些
				都可以简便地在视图的请求参数里指定。</p></li>
</ul></div>
<p>这些command控制器是非常强大的，为了有效地使用，需要对它们的原理有
			细致的理解。在你开始使用它们前，务必仔细阅读它们层次结构的javadoc以及示例。</p>
</div>
<div class="section" lang="zh-cn">
<div class="titlepage"><div><div><h3 class="title">
<a name="portlet-controller-wrapping"></a>16.4.4.&#160;<code class="classname">PortletWrappingController</code></h3></div></div></div>
<p>除了开发新的控制器，我们可以重用现有的portlet并且在
			<code class="classname">DispatcherPortlet</code>
			把请求映射指向它们。通过<code class="classname">PortletWrappingController</code>，你能实例化一个
			现有的<code class="interfacename">Portlet</code>来作
			<code class="interfacename">Controller</code>，如下所示：</p>
<pre class="code">&lt;bean id="wrappingController"
      class="org.springframework.web.portlet.mvc.PortletWrappingController"&gt;
    &lt;property name="portletClass" value="sample.MyPortlet"/&gt;
    &lt;property name="portletName" value="my-portlet"/&gt;
    &lt;property name="initParameters"&gt;
        &lt;value&gt;
            config=/WEB-INF/my-portlet-config.xml
        &lt;/value&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre>
<p>这会很有价值，因为可以使用拦截器来对送向这些portlet的请求进行预处理和后处理。
			而且也很方便，因为JSR-168没有提供对过滤机制的支持。比如，可以在一个MyFaces
			JSR Portlet外面加上Hibernate的
			<code class="classname">OpenSessionInViewInterceptor</code>。</p>
</div>
</div>

<!--start of htmlend-->

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->