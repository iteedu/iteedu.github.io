<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<!--end of htmlmiddle-->


<table border="0" width="100%" cellspacing="4"><!--HEADER SEPARATOR--><tr><!--LEFT SIDE NAVIGATION--><td width="20%" valign="top" nowrap="true"><p><strong>链接</strong></p><ul><li><a href="index.html" tppabs="http://tomcat.jaxwiki.org/index.html">文档首页</a></li></ul><p><strong>用户手册</strong></p><ul><li><a href="introduction.html" tppabs="http://tomcat.jaxwiki.org/introduction.html">1) 介绍</a></li><li><a href="setup.html" tppabs="http://tomcat.jaxwiki.org/setup.html">2) 安装</a></li><li><a href="appdev/index.html" tppabs="http://tomcat.jaxwiki.org/appdev/index.html">3) 第一个web应用</a></li><li><a href="deployer-howto.html" tppabs="http://tomcat.jaxwiki.org/deployer-howto.html">4) 部署</a></li><li><a href="manager-howto.html" tppabs="http://tomcat.jaxwiki.org/manager-howto.html">5) 管理</a></li><li><a href="realm-howto.html" tppabs="http://tomcat.jaxwiki.org/realm-howto.html">6) 权限管理 - 域(Realms)</a></li><li><a href="security-manager-howto.html" tppabs="http://tomcat.jaxwiki.org/security-manager-howto.html">7) 安全管理器</a></li><li><a href="jndi-resources-howto.html" tppabs="http://tomcat.jaxwiki.org/jndi-resources-howto.html">8) JNDI 资源</a></li><li><a href="jndi-datasource-examples-howto.html" tppabs="http://tomcat.jaxwiki.org/jndi-datasource-examples-howto.html">9) JDBC 数据源</a></li><li><a href="class-loader-howto.html" tppabs="http://tomcat.jaxwiki.org/class-loader-howto.html">10) 类加载</a></li><li><a href="jasper-howto.html" tppabs="http://tomcat.jaxwiki.org/jasper-howto.html">11) JSPs</a></li><li><a href="ssl-howto.html" tppabs="http://tomcat.jaxwiki.org/ssl-howto.html">12) SSL</a></li><li><a href="ssi-howto.html" tppabs="http://tomcat.jaxwiki.org/ssi-howto.html">13) SSI</a></li><li><a href="cgi-howto.html" tppabs="http://tomcat.jaxwiki.org/cgi-howto.html">14) CGI</a></li><li><a href="proxy-howto.html" tppabs="http://tomcat.jaxwiki.org/proxy-howto.html">15) 与代理器整合</a></li><li><a href="mbeans-descriptor-howto.html" tppabs="http://tomcat.jaxwiki.org/mbeans-descriptor-howto.html">16) MBean 描述</a></li><li><a href="default-servlet.html" tppabs="http://tomcat.jaxwiki.org/default-servlet.html">17) 默认 Servlet</a></li><li><a href="cluster-howto.html" tppabs="http://tomcat.jaxwiki.org/cluster-howto.html">18) 集群</a></li><li><a href="balancer-howto.html" tppabs="http://tomcat.jaxwiki.org/balancer-howto.html">19) 负载均衡</a></li><li><a href="connectors.html" tppabs="http://tomcat.jaxwiki.org/connectors.html">20) 连接器</a></li><li><a href="monitoring.html" tppabs="http://tomcat.jaxwiki.org/monitoring.html">21) 监控 与 管理</a></li><li><a href="logging.html" tppabs="http://tomcat.jaxwiki.org/logging.html">22) 日志</a></li><li><a href="apr.html" tppabs="http://tomcat.jaxwiki.org/apr.html">23) APR</a></li></ul><p><strong>参考</strong></p><ul><li><a href="config/index.html" tppabs="http://tomcat.jaxwiki.org/config/index.html">Apache Tomcat 配置</a></li></ul><p><strong>Apache Tomcat 开发</strong></p><ul><li><a href="building.html" tppabs="http://tomcat.jaxwiki.org/building.html">构建</a></li><li><a href="balancer-howto.html" tppabs="http://tomcat.jaxwiki.org/changelog.html">修订记录</a></li><li><a href="status.html" tppabs="http://tomcat.jaxwiki.org/status.html">状态</a></li><li><a href="developers.html" tppabs="http://tomcat.jaxwiki.org/developers.html">开发者</a></li><li><a href="catalina/funcspecs/index.html" tppabs="http://tomcat.jaxwiki.org/catalina/funcspecs/index.html">性能说明.</a></li><li><a href="catalina/docs/api/index.html" tppabs="http://tomcat.jaxwiki.org/catalina/docs/api/index.html">Apache Tomcat Javadocs</a></li><li><a href="jasper/docs/api/index.html" tppabs="http://tomcat.jaxwiki.org/jasper/docs/api/index.html">Apache Jasper Javadocs</a></li><li><a href="architecture/index.html" tppabs="http://tomcat.jaxwiki.org/architecture/index.html">体系架构</a></li></ul></td><!--RIGHT SIDE MAIN BODY--><td width="80%" valign="top" align="left"><table border="0" width="100%" cellspacing="4"><tr><td align="left" valign="top"><h1>Apache Tomcat 5.5 Servlet/JSP 容器</h1><h2>Tomcat的系统安全管理</h2></td></tr></table><table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#525D76"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86"><strong>背景知识</strong></a></font></td></tr><tr><td><blockquote>

  <p>Java的<strong>SecurityManager</strong>允许浏览器在它可执行的范围内运行，这样可以
  防止不可靠的程序读写用户在局部文件系统里的文件，或者未经授权进行网络连接，等等。同样，
  SecurityManager可用来防止不可靠的程序在你的浏览器上运行，在运行Tomcat时，使用
  SecurityManager可以保护你的服务器不受到类似于木马的servlets, JSPs, JSP beans 
  和标签库（tag libraries）的影响，或者发生错误。</p>

  <p>试想某个被允许在你的网站上发表JSPs的人不慎包括了以下的语句在他们的JSP里：</p>
<div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>&amp;lt;%System.exit(1);%&amp;gt;</pre></td><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>

  <p>每次Tomcat运行该JSP都会导致Tomcat中断。使用Java SecurityManager 如同多了一层防护，
  可以让服务器更加安全可靠。</p>

  <p><strong>警告</strong>——虽然Tomcat 5 的程序通过了安全检查，最重要的程序包都已被
  保护，新的安全机制也已实施，但在允许用户发表网络程序，JSPs, servlets, beans, 或 
  标签库（tag libraries）之前，你还是有必要确保 SecurityManager 的各项配置符合你的要求。
  <strong>当然，有SecurityManager绝对比没有它要安全的多。</strong></p>

</blockquote></td></tr></table><table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#525D76"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="%E8%AE%B8%E5%8F%AF Permissions"><strong>许可 Permissions</strong></a></font></td></tr><tr><td><blockquote>

  <p>Java的Permission类是用来定义Tomcat载入的类所拥有的权限。Java本身包括了一些
  Permission类，你也可以在你的网络应用中加入你自己的Permission类。
  这两种技术在Tomcat 5里都被应用。</p>


  <table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#828DA6"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="%E6%A0%87%E5%87%86%E8%AE%B8%E5%8F%AF"><strong>标准许可</strong></a></font></td></tr><tr><td><blockquote>

    <p>这里将简单总结标准系统中适用于Tomcat的SecurityManager 和 Permission 类。
    更多信息请参看
    <a href="" tppabs="http://java.sun.com/security/">http://java.sun.com/security/</a>。</p>

    <ul>
    <li><strong>java.util.PropertyPermission</strong> 
    	- 控制读/写Java虚拟器的属性，如<code>java.home</code> 。</li>
    <li><strong>java.lang.RuntimePermission</strong> 
    	- 控制使用一些系统/运行时(System/Runtime)的功能，如<code>exit()</code> 
	和 <code>exec()</code>。它也控制包(package)的访问/定义。</li>
    <li><strong>java.io.FilePermission</strong> 
    	- 控制对文件和目录的读/写/执行操作。</li>
    <li><strong>java.net.SocketPermission</strong> 
    	- 控制使用网路sockets连接。</li>
    <li><strong>java.net.NetPermission</strong> 
    	- 控制使用multicast网路连接。</li>
    <li><strong>java.lang.reflect.ReflectPermission</strong> 
    	- 控制使用reflection来对类进行检视。</li>
    <li><strong>java.security.SecurityPermission</strong> 
    	- 控制对安全方法的访问。</li>
    <li><strong>java.security.AllPermission</strong> 
    	- 给予所有访问权限，就如你运行一个没有SecurityManager的Tomcat 。</li>
    </ul>

  </blockquote></td></tr></table>


  <table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#828DA6"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="Tomcat %E4%B8%AD%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%9A%84%E8%AE%B8%E5%8F%AF"><strong>Tomcat 中可修改的许可</strong></a></font></td></tr><tr><td><blockquote>

    <p>Tomcat利用一个叫做<strong>org.apache.naming.JndiPermission</strong> 
    	许可类。它用来控制以JNDI命名的文件资源的可读权限。该许可的名称是以JNDI来表达，
	没有命令。在给予许可时，"*"的结尾可以用来以wild card方式映射JNDI命名
	的文件资源。例如，你可以在你的政策(policy)文件加入以下一行：</p>

	<div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>permission org.apache.naming.JndiPermission "jndi://localhost/examples/*";</pre></td><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>

    <p>一个象这样的许可(Permission)会在部署网络程序时被自动产生，允许它读取它自己的静态资源，
    	但不允许它使用文件访问权来读取其它文件(除非你明确地给出访问那些文件的许可).</p>

    <p>并且, Tomcat 总是自动产生以下文件许可:</p>
    	<div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>permission java.io.FilePermission "** your application context**", "read";</pre></td><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>  
    <p>这里**your application context**代表那个拥有你的应用程序的文件夹(或者是WAR文件)。</p>  

  </blockquote></td></tr></table>


</blockquote></td></tr></table><table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#525D76"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="%E6%94%B9%E5%8F%98 Tomcat %E4%B8%AD%E7%9A%84 SecurityManager"><strong>改变 Tomcat 中的 SecurityManager</strong></a></font></td></tr><tr><td><blockquote>

  <h3>政策文件的格式</h3>

  <p>由Java SecurityManager实现的安全政策被配置存放在
  $CATALINA_HOME/conf/<code>catalina.policy</code> 文件里。这个文件完全替代了
  JDK系统目录里的<code>java.policy</code>文件。这个catalina.policy 文件可以手动修改，
  或者使用Java 1.2 及其后版本的 policytool 程序修改。 </p>

  <p><code>catalina.policy</code> 文件中的条文使用了标准的<code>java.policy</code>
  文件格式，如下：</p>

  <div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>// Example policy file entry 

grant [signedBy &amp;lt;signer&amp;gt;,] [codeBase &amp;lt;code source&amp;gt;] { 
permission &amp;lt;class&amp;gt; [&amp;lt;name&amp;gt; [, &amp;lt;action list&amp;gt;]]; 
};</pre></td><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>

  <p>其中<strong>signedBy</strong> 和 <strong><code>codeBase</code></strong>是选择项。
  注释行是以"//"开始，直到该行结束。codeBase是URL的格式，文件的URL中可用如
  ${java.home}和${catalina.home}等属性(这些属性会被扩展到由环境变量
  <code>JAVA_HOME</code> 和 <code>CATALINA_HOME</code>为他们定义的目录路径)。</p>

  <h3>缺省政策文件</h3>

  <p>缺省$CATALINA_HOME/conf/catalina.policy 文件看起来象这样： </p>
<div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>
// ============================================================================
// catalina.corepolicy - Security Policy Permissions for Tomcat 5
//
// This file contains a default set of security policies to be enforced (by the
// JVM) when Catalina is executed with the "-security" option.  In addition
// to the permissions granted here, the following additional permissions are
// granted to the codebase specific to each web application:
//
// * Read access to the document root directory
//
// $Id: security-manager-howto.xml 301460 2003-01-15 03:40:45Z glenn $
// ============================================================================


// ========== SYSTEM CODE PERMISSIONS =========================================
// ========== 系统源码许可控制 ===============

// These permissions apply to javac
// 下面的许可适用于javac
grant codeBase "file:${java.home}/lib/-" {
        permission java.security.AllPermission;
};

// These permissions apply to all shared system extensions
// 下面的许可适用于java的扩展
grant codeBase "file:${java.home}/jre/lib/ext/-" {
        permission java.security.AllPermission;
};

// These permissions apply to javac when ${java.home] points at $JAVA_HOME/jre
// 下面的许可适用于当${java.home] 是 $JAVA_HOME/jre时的 javac
grant codeBase "file:${java.home}/../lib/-" {
        permission java.security.AllPermission;
};

// These permissions apply to all shared system extensions when
// 下面的许可适用于java的扩展
// ${java.home} points at $JAVA_HOME/jre
grant codeBase "file:${java.home}/lib/ext/-" {
        permission java.security.AllPermission;
};


// ========== CATALINA CODE PERMISSIONS =======================================
// ========== CATALINA的源码许可控制 =============

// These permissions apply to the launcher code
// 以下许可适用于启动Tomcat的程序
grant codeBase "file:${catalina.home}/bin/commons-launcher.jar" {
        permission java.security.AllPermission;
};

// These permissions apply to the server startup code
// 以下许可适用于启动服务器的程序
grant codeBase "file:${catalina.home}/bin/bootstrap.jar" {
        permission java.security.AllPermission;
};

// These permissions apply to the servlet API classes
// and those that are shared across all class loaders
// located in the "common" directory
// 以下许可适用于 Servlet 的 API 和 common目录里的程序
grant codeBase "file:${catalina.home}/common/-" {
        permission java.security.AllPermission;
};

// These permissions apply to the container's core code, plus any additional
// libraries installed in the "server" directory
// 下面的许可适用于Tomcat的核心和 server 目录里的程序
grant codeBase "file:${catalina.home}/server/-" {
        permission java.security.AllPermission;
};

// ========== WEB APPLICATION PERMISSIONS =====================================
// ========== WEB 应用的许可 ===========

// These permissions are granted by default to all web applications
// In addition, a web application will be given a read FilePermission
// and JndiPermission for all files and directories in its document root.
// 缺省情况下，所有WEB 应用拥有下面这些许可，另外还有 它们本身文件夹里的 &ldquo;read&rdquo; FilePermission
// 和JndiPermission。

grant { 
        // Required for JNDI lookup of named JDBC DataSource's and
        // javamail named MimePart DataSource used to send mail
        permission java.util.PropertyPermission "java.home", "read";
        permission java.util.PropertyPermission "java.naming.*", "read";
        permission java.util.PropertyPermission "javax.sql.*", "read";

        // OS Specific properties to allow read access
	permission java.util.PropertyPermission "os.name", "read";
	permission java.util.PropertyPermission "os.version", "read";
	permission java.util.PropertyPermission "os.arch", "read";
	permission java.util.PropertyPermission "file.separator", "read";
	permission java.util.PropertyPermission "path.separator", "read";
	permission java.util.PropertyPermission "line.separator", "read";

        // JVM properties to allow read access
        permission java.util.PropertyPermission "java.version", "read";
        permission java.util.PropertyPermission "java.vendor", "read";
        permission java.util.PropertyPermission "java.vendor.url", "read";
        permission java.util.PropertyPermission "java.class.version", "read";
	permission java.util.PropertyPermission "java.specification.version", "read";
	permission java.util.PropertyPermission "java.specification.vendor", "read";
	permission java.util.PropertyPermission "java.specification.name", "read";

	permission java.util.PropertyPermission "java.vm.specification.version", "read";
	permission java.util.PropertyPermission "java.vm.specification.vendor", "read";
	permission java.util.PropertyPermission "java.vm.specification.name", "read";
	permission java.util.PropertyPermission "java.vm.version", "read";
	permission java.util.PropertyPermission "java.vm.vendor", "read";
	permission java.util.PropertyPermission "java.vm.name", "read";

        // Required for getting BeanInfo
        permission java.lang.RuntimePermission "accessClassInPackage.sun.beans.*";

        // Required for OpenJMX
        permission java.lang.RuntimePermission "getAttribute";

	// Allow read of JAXP compliant XML parser debug
	permission java.util.PropertyPermission "jaxp.debug", "read";
};

// 你还可以给某个特定的WEB应用赋予其它许可。
// You can assign additional permissions to particular web applications by
// adding additional "grant" entries here, based on the code base for that
// application, /WEB-INF/classes/, or /WEB-INF/lib/ jar files.
//
// Different permissions can be granted to JSP pages, classes loaded from
// the /WEB-INF/classes/ directory, all jar files in the /WEB-INF/lib/
// directory, or even to individual jar files in the /WEB-INF/lib/ directory.
//
// For instance, assume that the standard "examples" application
// included a JDBC driver that needed to establish a network connection to the
// corresponding database and used the scrape taglib to get the weather from
// the NOAA web server.  You might create a "grant" entries like this:
//
// The permissions granted to the context root directory apply to JSP pages.
// grant codeBase "file:${catalina.home}/webapps/examples/-" {
//      permission java.net.SocketPermission "dbhost.mycompany.com:5432", "connect";
//      permission java.net.SocketPermission "*.noaa.gov:80", "connect";
// };
//
// The permissions granted to the context WEB-INF/classes directory
// grant codeBase "file:${catalina.home}/webapps/examples/WEB-INF/classes/-" {
// };
//
// The permission granted to your JDBC driver
// grant codeBase "jar:file:${catalina.home}/webapps/examples/WEB-INF/lib/driver.jar!/-" {
//      permission java.net.SocketPermission "dbhost.mycompany.com:5432", "connect";
// };
// The permission granted to the scrape taglib
// grant codeBase "jar:file:${catalina.home}/webapps/examples/WEB-INF/lib/scrape.jar!/-" {
//      permission java.net.SocketPermission "*.noaa.gov:80", "connect";
// };
</pre></td><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>

  <h3>启动附带SecurityManager的Tomcat</h3>

  <p>在你配置好与SecurityManager一起使用的<code>catalina.policy</code>文件之后，
  你可以使用"-security"选项来启动Tomcat。</p>

  <div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>$CATALINA_HOME/bin/catalina.sh start -security (Unix) 
%CATALINA_HOME%\bin\catalina start -security (Windows)</pre></td><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>

</blockquote></td></tr></table><table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#525D76"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="Configuring Package Protection in Tomcat"><strong>Configuring Package Protection in Tomcat</strong></a></font></td></tr><tr><td><blockquote>
  <p>从Tomcat 5开始，现在可以配置Tomcat内部包的许可。更多信息请参阅
  <a href="" tppabs="http://java.sun.com/security/seccodeguide.html">http://java.sun.com/security/seccodeguide.html</a>
  。</p>    

  
  <p><strong>警告</strong>：删除缺省的包保护，可能打开一个安全漏洞。</p>

  <h3>缺省的属性文件</h3>

  <p>缺省的$CATALINA_HOME/conf/catalina.properties 文件看起来象这样： </p>
<div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>#
# List of comma-separated packages that start with or equal this string
# will cause a security exception to be thrown when
# passed to checkPackageAccess unless the
# corresponding RuntimePermission ("accessClassInPackage."+package) has
# been granted.
package.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,
org.apache.jasper.
#
# List of comma-separated packages that start with or equal this string
# will cause a security exception to be thrown when
# passed to checkPackageDefinition unless the
# corresponding RuntimePermission ("defineClassInPackage."+package) has
# been granted.
#
# by default, no packages are restricted for definition, and none of
# the class loaders supplied with the JDK call checkPackageDefinition.
#
package.definition=sun.,java.,org.apache.catalina.,org.apache.coyote.,
org.apache.tomcat.,org.apache.jasper.</pre></td><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>
  <p>当你完成配置SecurityManager所需的<code>catalina.properties</code> 文件，记住要重新启动Tomcat。</p>
</blockquote></td></tr></table><table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#525D76"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4"><strong>故障排除</strong></a></font></td></tr><tr><td><blockquote>

  <p>如果你的网络应用程序试图执行没有许可而被阻止的操作，SecurityManager探查出这样的违规后，
  就会抛出一个<code>AccessControLException</code> 或 <code>SecurityException</code>。
  要查出究竟缺少哪个许可往往非常困难，一个方法是打印执行过程中的所有关于安全决定的排错信息。
  这可以在启动Tomcat之前通过设置系统属性来实现。最简单的办法是修改<code>CATALINA_OPTS</code>
  环境变量。在启动Tomcat之前，执行下面这个命令：</p>

  <div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>export CATALINA_OPTS=-Djava.security.debug=all (Unix) 
set CATALINA_OPTS=-Djava.security.debug=all (Windows)</pre></td><td bgcolor="#023264" width="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>

  <p>（在启动Tomcat之前）。</p>

  <p><strong>警告</strong>——这会产生<em>很多megabytes</em>的输出。不过，通过
  查找"FAILED"这个词可以帮助你搜索问题所在，并确定哪个许可是要找的问题。
  请参看Java安全文档资料，那里有你可指定的更多选项。</p>

</blockquote></td></tr></table></td></tr><!--FOOTER SEPARATOR--><!--PAGE FOOTER--><tr><td colspan="2"><div align="center"><font color="#525D76" size="-1"><em>
        
        </em></font></div></td></tr></table>

<!--start of htmlend-->

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->