<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<!--end of htmlmiddle-->


<table border="0" width="100%" cellspacing="4"><!--HEADER SEPARATOR--><tr><!--LEFT SIDE NAVIGATION--><td width="20%" valign="top" nowrap="true"><p><strong>Links</strong></p><ul><li><a href="../index.html" tppabs="http://tomcat.jaxwiki.org/index.html">Docs Home</a></li></ul><p><strong>Contents</strong></p><ul><li><a href="index.html" tppabs="http://tomcat.jaxwiki.org/appdev/index.html">Contents</a></li><li><a href="introduction.html" tppabs="http://tomcat.jaxwiki.org/appdev/introduction.html">Introduction</a></li><li><a href="installation.html" tppabs="http://tomcat.jaxwiki.org/appdev/installation.html">Installation</a></li><li><a href="deployment.html" tppabs="http://tomcat.jaxwiki.org/appdev/deployment.html">Deployment</a></li><li><a href="source.html" tppabs="http://tomcat.jaxwiki.org/appdev/source.html">Source Code</a></li><li><a href="index.html" tppabs="http://tomcat.jaxwiki.org/appdev/processes.html">Processes</a></li><li><a href="sample/index.html" tppabs="http://tomcat.jaxwiki.org/appdev/sample/">Example App</a></li></ul></td><!--RIGHT SIDE MAIN BODY--><td width="80%" valign="top" align="left"><table border="0" width="100%" cellspacing="4"><tr><td align="left" valign="top"><h1>应用开发人员指南</h1><h2>源代码组织(Source Organization)</h2></td></tr></table><table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#525D76"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="Directory Structure"><strong>Directory Structure</strong></a></font></td></tr><tr><td><blockquote>

    <blockquote><em>
    <p>在下面的描述中使用变量名$CATALINA_HOME来代指Tomcat5所安装的目录地址,这是一个基础目录(base directory),其他的相关路径由它而派生。不过，如果你已经把Tomcat设置成多个体实例(multiple instances),并且设立了一个$CATALINA_BASE目录，那么你就应使用$CATALINA_BASE而不是$CATALINA_HOME作为参照。</p>
    </em></blockquote>

<p>这个手册特别建议你把包含源代码的目录阶层(本章节所描述的)和包含可调度程序的目录阶层(前面章节所描述的)分开。保持这种分离有下面几种好处：</p>
<ul>
<li>如果没有和&ldquo;可运行&rdquo;版的程序相混合，源代码目录里的内容就比较容易来管理，移动和备份(backup)。<br><br></li>
<li>在只含有源代码文件的目录里，管理控制源代码就比较容易。<br><br></li>
<li>当可调度阶层目录被分开后，就比较容易来选择那些组成可安装分配(installable distribution)程序的文件。</li>
</ul>

<p>我们将会看到，<code>ant</code>开发工具使得产生和处理这样的目录阶层非常容易。</p>

<p>你可以随意组织用来包含程序源代码的目录和文件阶层。不过，下面的这种组织结构被证明非常实用可行，也是下面将要讨论的例子<code>build.xml</code>配置文件(configuration file)所期望的。所有的这些组成成分存在于你的应用程序的最上层<em>项目源代码目录</em>下面。</p>
<ul>
<li><strong>docs/</strong> —— 关于你的应用程序的文档资料，可以用你们开发组使用的任何格式(format)。<br><br></li>
<li><strong>src/</strong> —— Java源代码文件，它们是用于产生你的程序特有的servlets, 
beans, 和其他Java classes。如果你的源代码被组织成包(packages)(我们<strong>极力</strong>推荐),这个包阶层(hierarchy)就应该被放置这个目录下面。<br><br></li>
<li><strong>web/</strong> —— 组成你网站的静态文件(HTML页面，JSP页面，JavaScript文件，CSS stylesheet文件，和图象)，这些文件都可以让客户存取(accessible)。这个目录是你的网络程序的文件根(<em>document root</em>)目录，它的任何子目录中的文件可通过浏览器来读取。<br><br></li>
<li><strong>web/WEB-INF/</strong> —— 你的程序所需的特别的配置文件,包括网络应用程序调度符(<code>web.xml</code>,在Servlet规范里有定义),你为用户标记库(custom tag libraries)所产生的标记库描述符,以及其他你想要包括在网络程序里的资源文件(resource files)。尽管这个目录显得象是文件根目录(<em>document root</em>)的分目录(subdirectory),但是Servlet规范不允许客户能直接使用这个目录里的内容(或它包含的任何文件)。所以，这是一个不错的地方来储存那些程序顺利运行所必须的，但又是非常敏感的配置信息(比如数据库连接用的用户名称及密码)。</li>
</ul>

<p>在程序开发过程中，会临时产生另外两个目录：</p>
<ul>
<li><strong>build/</strong> —— 执行默认<code>ant</code>指令后，会在这个目录中产生与web应用档案(WAR)完全相同的文件。Tomcat5允许你在象这样未包装的目录里调度程序，你可以把此目录复制到<code>$CATALINA_HOME/webapps</code> 目录上去，或通过&ldquo;管理者&rdquo;(Manager)程序把它<em>安装</em>上去。后面的这种处理方式在开发程序中非常有用，下面我们会作些说明。<br><br></li>
<li><strong>dist/</strong> —— 当你执行<code>ant dist</code>目标后，就会在这个目录中产生与你的网络程序binary distribution 完全相同的文件，包括许可证信息，文档资料和README 文件。</li>
</ul>

<p>注意 — <strong>不</strong>要把这两个目录存档在你的源代码控制系统里，因为这两个目录会在程序开发中根据需要被删除或重新产生。正是因为这个原因，如果你想要保留一个关于程序更改的固定记录，你就<strong>不</strong>要在这两个目录里编辑源代码文件，因为下一次执行build命令时，所有的程序更改就会被遗失掉。</p>

  <table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#828DA6"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="External Dependencies"><strong>External Dependencies</strong></a></font></td></tr><tr><td><blockquote>

  <p>如果你的程序需要外部的项目或包(packages)里的JAR文件(或其他资源)，那你应该怎么办呢？一个通常的例子就是你必需在你的程序中引入JDBC驱动程式才能运作。</p>

  <p>不同的开发人员采用不同的方式来处理这个问题。有些开发人员会鼓励你对于每一个需要那些JAR文件的程序，把它所依赖的JAR文件复制到源代码控制存档(archives)上。不过，当你在许多程序中使用同样一个JAR文件——特别是当你面临着需要升级(upgrade)到不同版本的JAR文件时，就会产生很严重的管理上的问题。</p>

  <p>因此,这个手册提倡<strong>不</strong>要把你所需要的packages的复制件存放在程序的源代码控制档案里。相反，你应该把这些外部依赖性文件整合到<strong>创建</strong>你的程序的过程中去。这样一来，你总是可以从系统管理员安装JAR文件的地方选择合适版本的JAR文件，而<strong>不</strong>用担心每次在你所依赖的JAR文件更改后，要去更新你的程序。</p>

  <p>在例子Ant <code><code>build.xml</code></code> 文件中，我们将示范怎样去定义那些让你能够配置复制文件地址的<em>build properties</em>，而不需要在这些文件更改时去修改 build.xml 。每个开发人员使用的build属性(properties)可以根据每个不同的程序客户化，或者默认作(defaulted to）&ldquo;标准&rdquo;build属性存放在开发人员的主目录(home directory)中。</p>

  <p>在许多情况下，系统管理员可能已经把必需的JAR文件安装到Tomcat 5 的 <code>common/lib</code> 或者<code>shared/lib</code> 目录里。如果这已经被做好了，你就不需要再做什么——例子<code>build.xml</code> 会自动创造一个包含这些文件的compile classpath 。</p>

  </blockquote></td></tr></table>

</blockquote></td></tr></table><table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#525D76"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="Source Code Control"><strong>Source Code Control</strong></a></font></td></tr><tr><td><blockquote>

<p>如先前提到的,我们极力建议你把组成你程序的所有源代码文件放置在一个象Concurrent Version System (CVS)一样的源代码控制系统下来管理。如果你选择这么做，在这个源代码阶层里的每一个目录和文件都会被注册和保存——但是所有产生的文件都不会被注册和保存。如果你注册二进制形式的文件(如图象或JAR库)，一定要指示你的源代码控制系统。</p>

<p>我们(在前面一段)建议你不要把你在开发程序过程中产生的<code>build/</code> 和<code>dist/</code> 目录中的内容存放在源代码控制系统里。一个简单的办法让CVS忽略这两个目录就是在你的上层源代码目录中产生一个叫做<code>.cvsignore</code>(注意前面有一个句点)的文件，它应该包括下面这些内容：</p>
<div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>build 
dist 
build.properties</pre></td><td bgcolor="#023264" width="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>

<p>对于在这里提及<code>build.properties</code>的理由，我们会在<a href="index.html" tppabs="http://tomcat.jaxwiki.org/appdev/processes.html">开发过程</a>这一章节里作解释。</p>

<p>关于源代码控制环境的详细说明超过了本手册的范围。不过，如果你使用命令行的CVS客户端，你要遵守下面的步骤：</p>
<ul>
<li>要更新储存在源代码储存器(source repository)里的源代码,得到你的源代码目录中去执行<code>cvs update -dP</code>。<br><br></li>
<li>当你要在源代码目录阶层产生一个新的子目录(subdirectory)，得到CVS使用象<code>cvs add {子目录名称(subdirname)}</code>的命令来注册。<br><br></li>
<li>当你首次产生一个新的源代码文件，找到包括源代码的目录，并用诸如象<code>cvs add {filename}</code>这样的命令来注册这个新文件。<br><br></li>
<li>如果你不再需要某个特定的源代码文件，找到包括这个文件的目录，并且删除它。然后在CVS使用象<code>cvs remove {filename}</code>这样的命令来注销这个文件。<br><br></li>
<li>在你产生，修改和删除源代码文件时，这些改变还没有反映在服务器端的储存器里。要保持目前的更改，得到项目的源代码目录去执行<code>cvs commit</code> 。你会被要求简述你刚才完成的更改，然后和新版本的源代码文件一起被储存下来。</li>
</ul>

<p>CVS,象其他源代码控制系统一样，有许多额外的特性(比如能够对特定发行版的文件进行标记，支持开发多个分枝版本—这些分枝在以后可以被合并)。更多信息请参看<a href="introduction.html" tppabs="http://tomcat.jaxwiki.org/appdev/introduction.html">简介</a>中的链连(link)和参考资料(reference)。</p>

</blockquote></td></tr></table><table border="0" cellspacing="0" cellpadding="2" width="100%"><tr><td bgcolor="#525D76"><font color="#ffffff" face="arial,helvetica.sanserif"><a name="BUILD.XML Configuration File"><strong>BUILD.XML Configuration File</strong></a></font></td></tr><tr><td><blockquote>

<p>我们将利用<strong>ant</strong>工具来管理编译Java源代码文件，以及产生调度目录层次。Ant在一个构建(build)文件控制下操作，通常叫做<code>build.xml</code>，它定义了必需的开发过程的步骤。这个文件储存在你的源代码目录层次的最上层，必须把它读入(check in)到你的源代码控制系统中去。</p>

<p>就象一个Makefile，<code><code><code>build.xml</code></code></code>文件提供了几个&ldquo;目标&rdquo;("target")来支持可选择性的开发活动(比如产生相关的Javadoc文件，擦除调度主目录以便你能从头开始你的项目，或者产生网络应用档案文件以便你可以分配你的程序)。一个构造不错的build.xml文件应该包括描述说明那些设计给开发人员使用的目标(target)的内部文件，以及这些内部使用的目标。要求Ant显示项目的说明资料，你要更换到含有build.xml的目录下，然后打印命令：</p>
<div align="left"><table cellspacing="4" cellpadding="0" border="0"><tr><td bgcolor="#023264" width="1" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#ffffff" height="1"><pre>ant -projecthelp</pre></td><td bgcolor="#023264" width="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr><tr><td bgcolor="#023264" width="1" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td><td bgcolor="#023264" width="1" height="1"><img src="../images/void.gif" tppabs="http://tomcat.jaxwiki.org/images/void.gif" width="1" height="1" vspace="0" hspace="0" border="0"></td></tr></table></div>

<p>为了让你能先做起来，我们提供了basic build.xml 文件，你可以对它用户化并把它安装在你的项目源代码目录中。这个文件包括了描述各种可被执行目标的注释。简单地说，它通常提供了下面的这些目标： </p>
<ul>
<li>清除(<strong>clean</strong>)——这个目标删除既存的<code>build</code> 和<code>dist</code> 目录，这样它们可以被重新构造。这样确保你不可能发生因为修改源代码，但没有重新编译(recompiling)所有affected classes，而在运行时出现问题。<br><br></li>
<li>编译(<strong>compile</strong>)——这个目标是用来编译那些自从上次编译后被更改过的源代码。所产生的类文件(class files)被放置在<code>build</code>目录下的子目录<code>WEB-INF/classes</code> 里面，和网络应用程序的结构所要求完全一致的地方。因为这个命令在开发程序过程中经常被执行，所以通常把它设置为&ldquo;默认（default）&rdquo;目标，这样一来简单的<code>ant</code>命令就可以执行它。<br><br></li>
<li><strong>all</strong> ——这个目标是一个用来先执行<code>清除</code>目标，然后再执行编译目标的捷径(short cut)。因此，它确保你重新编译所有的程序，这样可以保证你不会在不知不觉中引入一些不相适宜的改变。<br><br></li>
<li><strong>javadoc</strong> ——这个目标产生网络程序中Java类的Javadoc API文档资料。例子<code>build.xml</code> 文件中假设你想把API文档资料包括在你要发表的程序中，所以它把产生的文档资料(docs)放在<code><code>dist</code></code>目录下的子目录里。因为你通常不需要在每次编译时都产生Javadocs API文档资料，所以这个目标和dist目标相关联，而与<code>compile</code>目标无关。<br><br></li>
<li><strong>dist</strong> ——这个目标给你的程序产生一个分配目录，包括必要的文档资料，Java类的Javadocs，网络应用档案(WAR)文件，这个WAR文件将被传送给需要安装你的程序的系统管理员。因为这个目标也依赖于<code>deploy</code>目标，网络应用档案还应包括必需的外部文件。</li>
</ul>

<p>为了用Tomcat5进行互动开发和测试你的程序，我们定义了下面额外的几个目标(targets)：</p>
<ul>
<li>安装(<strong>install</strong>)——告诉正在运行的Tomcat5使你开发的程序可被立即用于执行和测试。它不需要重新启动Tomcat5。<br><br></li>
<li>重新装载(<strong>reload</strong>)—— 一但程序安装后，你可以继续更改和用<code>compile</code>目标重新编译。Tomcat5 会自动识别JSP页面里的更改，但不能识别servlet 或 JavaBean 类里的更改——这个命令会告诉Tomcat重新启动最近安装的程序，这样这些改变就会被认可。<br><br></li>
<li>删除(<strong>remove</strong>)——当你完成了开发和测试活动，你可以选择性地告诉Tomcat5把这些程序去掉。</li>
</ul>

<p>利用开发和测试目标还需要额外的一些一次性设置，这一点我们在下一页会讨论。</p>

</blockquote></td></tr></table></td></tr><!--FOOTER SEPARATOR--><!--PAGE FOOTER--><tr><td colspan="2"><div align="center"><font color="#525D76" size="-1"><em>
        
        </em></font></div></td></tr></table>

<!--start of htmlend-->

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->