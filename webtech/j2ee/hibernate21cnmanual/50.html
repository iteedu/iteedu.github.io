<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->



<div class="lpindex"><a href="index.html">首页</a><a href="49.html"> 上一页</a></div>
<h2>Chapter 20. 最佳实践(Best   Practices)</h2>
<dl>
  <dt>设计细颗粒度的持久类并且使用&lt;component&gt;来实现映射。 </dt>
  <dd>
    <p>使用一个Address持久类来封装 street, suburb, state, postcode. 这将有利于代码重用和简化代码重构(refactoring)的工作。 </p>
  </dd>
  <dt>对持久类声明标识符属性。 </dt>
  <dd>
    <p>Hibernate中标识符属性是可选的，不过有很多原因来说明你应该使用标识符属性。我们建议标识符应该是“人造”的(自动生成，不涉及业务含义)，并且不是基本类型。为了最大的灵活性，应该使用java.lang.Long or java.lang.String </p>
  </dd>
  <dt>为每个持久类写一个映射文件 </dt>
  <dd>
    <p>不要把所有的持久类映射都写到一个大文件中。把 com.eg.Foo 映射到com/eg/Foo.hbm.xml中， 在团队开发环境中，这一点显得特别有意义。 </p>
  </dd>
  <dt>把映射文件作为资源加载 </dt>
  <dd>
    <p>把映射文件和他们的映射类放在一起进行部署。 </p>
  </dd>
  <dt>考虑把查询字符串放在程序外面 </dt>
  <dd>
    <p>如果你的查询中调用了非ANSI标准的SQL函数，那么这条实践经验对你适用。把查询字符串放在程序外面可以让程序具有更好的可移植性。 </p>
  </dd>
  <dt>使用绑定变量 </dt>
  <dd>
    <p>就像在JDBC编程中一样，应该总是用占位符&quot;?&quot;来替换非常量值，不要在查询中用字符串值来构造非常量值！更好的办法是在查询中使用命名参数。 </p>
  </dd>
  <dt>不要自己来管理JDBC connections </dt>
  <dd>
    <p>Hibernate允许应用程序自己来管理JDBC   connections，但是应该作为最后没有办法的办法。如果你不能使用Hibernate内建的connections   providers，那么考虑实现自己来实现net.sf.hibernate.connection.ConnectionProvider </p>
  </dd>
  <dt>考虑使用用户自定义类型(custom type) </dt>
  <dd>
    <p>net.sf.hibernate.UserType. This approach frees the   application code from implementing transformations to / from a Hibernate type.   假设你有一个Java类型，来自某些类库，需要被持久化，但是该类没有提供映射操作需要的存取方法。那么你应该考虑实现net.sf.hibernate.UserType接口。这种办法使程序代码写起来更加自如，不再需要考虑类与Hibernate   type之间的相互转换。 </p>
  </dd>
  <dt>在性能瓶颈的地方使用硬编码的JDBC </dt>
  <dd>
    <p>在对性能要求很严格的一些系统中，一些操作(例如批量更新和批量删除)也许直接使用JDBC会更好，但是请先<em>搞清楚</em>这是否是一个瓶颈，并且不要想当然认为JDBC一定会更快。如果确实需要直接使用JDBC，那么最好打开一个   Hibernate Session 然后从 Session获得connection，按照这种办法你仍然可以使用同样的transaction策略和底层的connection   provider。 </p>
  </dd>
  <dt>理解Session清洗（ flushing） </dt>
  <dd>
    <p>Session会不时的向数据库同步持久化状态，如果这种操作进行的过于频繁，那么性能会受到一定的影响。有时候你可以通过禁止自动flushing尽量最小化非必要的flushing操作，或者更进一步，在一个特殊transaction中改变查询和其它操作的顺序。 </p>
  </dd>
  <dt>在三层架构中，考虑使用 saveOrUpdate() </dt>
  <dd>
    <p>当使用一个servlet / session bean 的架构的时候, 你可以把已加载的持久对象在session bean层和servlet / JSP   层之间来回传递。使用新的session来为每个请求服务，使用 Session.update() 或者Session.saveOrUpdate()来更新对象的持久状态。 </p>
  </dd>
  <dt>在两层架构中，考虑使用session disconnection. </dt>
  <dd>
    <p>当仅仅使用   servlet的时候，你可以在多个客户请求中复用同一个session，只是要记得在把控制权交还给客户端之前disconnect掉session。 </p>
  </dd>
  <dt>不要把异常看成可恢复的 </dt>
  <dd>
    <p>这一点甚至比“最佳实践”还要重要，这是“必备常识”。当异常发生的时候，回滚 Transaction   ，关闭Session。如果你不这样做的话，Hibernate无法保证内存状态精确的反应持久状态。尤其不要使用Session.load()来判断一个给定标识符的对象实例在数据库中是否存在，应该使用find()。 </p>
  </dd>
  <dt>对于关联优先考虑lazy fetching </dt>
  <dd>
    <p>谨慎的使用主动外连接抓取(eager (outer-join)   fetching)。对于大多数没有JVM级别缓存的持久对象的关联，应该使用代理(proxies)或者具有延迟加载属性的集合(lazy   collections)。对于被缓存的对象的关联，尤其是缓存的命中率非常高的情况下，应该使用outer-join=&quot;false&quot;，显式的禁止掉eager   fetching。如果那些特殊的确实适合使用outer-join fetch 的场合，请在查询中使用left   join。 </p>
  </dd>
  <dt>考虑把Hibernate代码从业务逻辑代码中抽象出来 </dt>
  <dd>
    <p>把Hibernate的数据存取代码隐藏到接口(interface)的后面，组合使用<em>DAO</em>和<em>Thread Local   Session</em>模式。通过Hibernate的UserType，你甚至可以用硬编码的JDBC来持久化那些本该被Hibernate持久化的类。   (该建议更适用于规模足够大应用软件中，对于那些只有5张表的应用程序并不适合。) </p>
  </dd>
</dl>

<div class="rpindex"><a href="49.html"> 上一页</a><a href="index.html">首页</a></div>


<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->
