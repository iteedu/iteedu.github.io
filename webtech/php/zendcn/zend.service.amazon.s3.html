<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<!--end of htmlmiddle-->



<div class="sect1" title="47.12. Zend_Service_Amazon_S3">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.service.amazon.s3"></a>47.12. Zend_Service_Amazon_S3</h2></div></div></div>
<div class="sect2" title="47.12.1. Introduction">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.amazon.s3.introduction"></a>47.12.1. Introduction</h3></div></div></div>
<p>
    Amazon S3 provides a simple web services interface that can be used to
    store and retrieve any amount of data, at any time, from anywhere on
    the web. It gives any developer access to the same highly scalable,
    reliable, fast, inexpensive data storage infrastructure that Amazon
    uses to run its own global network of web sites. The service aims to
    maximize benefits of scale and to pass those benefits on to developers.
        </p>
</div>
<div class="sect2" title="47.12.2. Registering with Amazon S3">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.amazon.s3.registering"></a>47.12.2. Registering with Amazon S3</h3></div></div></div>
<p>
            Before you can get started with <code class="classname">Zend_Service_Amazon_S3</code>, you must first
            register for an account. Please see the
            S3 FAQ
            page on the Amazon website for more information.
        </p>
<p>
            After registering, you will receive an application key and a secret key.
            You will need both to access the S3 service.
        </p>
</div>
<div class="sect2" title="47.12.3. API Documentation">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.amazon.s3.apiDocumentation"></a>47.12.3. API Documentation</h3></div></div></div>
<p>
            The <code class="classname">Zend_Service_Amazon_S3</code> class provides the PHP wrapper to the
            Amazon S3 REST interface. Please consult the
            Amazon S3 documentation
            for detailed description of the service. You will need to be familiar with basic concepts
            in order to use this service.
        </p>
</div>
<div class="sect2" title="47.12.4. Features">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.amazon.s3.features"></a>47.12.4. Features</h3></div></div></div>
<p>
            <code class="classname">Zend_Service_Amazon_S3</code> provides the following functionality:

            </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                        A single point for configuring your amazon.s3 authentication
                        credentials that can be used across the amazon.s3 namespaces.
                    </p></li>
<li class="listitem"><p>
                        A proxy object that is more convenient to use than an HTTP client
                        alone, mostly removing the need to manually construct HTTP POST
                        requests to access the REST service.
                    </p></li>
<li class="listitem"><p>
                        A response wrapper that parses each response body and throws an
                        exception if an error occurred, alleviating the need to repeatedly
                        check the success of many commands.
                    </p></li>
<li class="listitem"><p>
                        Additional convenience methods for some of the more common operations.
                    </p></li>
</ul></div>
<p>
        </p>
</div>
<div class="sect2" title="47.12.5. Getting Started">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.amazon.s3.storing-your-first"></a>47.12.5. Getting Started</h3></div></div></div>
<p>
            Once you have registered with Amazon S3, you're ready to store your first
            data object on the S3. The objects on S3 are stored in containers, called
            "buckets". Bucket names are unique on S3, and each user can have no more than
            100 buckets simultaneously. Each bucket can contain unlimited amount of objects,
            identified by name.
        </p>
<p>
            The following example demonstrates creating a bucket, storing and retrieving the data.
        </p>
<div class="example">
<a name="zend.service.amazon.s3.storing-your-first.example"></a><p class="title"><b>例 47.55. Zend_Service_Amazon_S3 Usage Example</b></p>
<div class="example-contents"><pre class="code">
require_once 'Zend/Service/Amazon/S3.html';

$s3 = new Zend_Service_Amazon_S3($my_aws_key, $my_aws_secret_key);

$s3-&gt;createBucket("my-own-bucket");

$s3-&gt;putObject("my-own-bucket/myobject", "somedata");

echo $s3-&gt;getObject("my-own-bucket/myobject");
</pre></div>
</div>
<br class="example-break"><p>
            Since <code class="classname">Zend_Service_Amazon_S3</code> service requires authentication,
            you should pass your credentials (AWS key and secret key) to the constructor.

            If you only use one account, you can set default credentials for the service:
        </p>
<pre class="code">
require_once 'Zend/Service/Amazon/S3.html';

Zend_Service_Amazon_S3::setKeys($my_aws_key, $my_aws_secret_key);
$s3 = new Zend_Service_Amazon_S3();
</pre>
</div>
<div class="sect2" title="47.12.6. Bucket operations">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.amazon.s3.buckets"></a>47.12.6. Bucket operations</h3></div></div></div>
<p>
        All objects in S3 system are stored in buckets. Bucket has to be created
        before any storage operation. Bucket name is unique in the system, so
        you can not have bucket named the same as someone else's bucket.
        </p>
<p>
        Bucket name can contain lowercase letters, digits, periods (.), underscores (_), and dashes (-).
        No other symbols allowed. Bucket name should start with letter or digit, and be 3 to 255 characters long.
        Names looking like an IP address (e.g. "192.168.16.255") are not allowed.
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                    <code>createBucket()</code> creates a new bucket.
                </p></li>
<li class="listitem"><p>
                    <code>cleanBucket()</code> removes all objects that are contained in a bucket.
                </p></li>
<li class="listitem">
<p>
                    <code>removeBucket()</code> removes the bucket from the system. The bucket should be
                    empty to be removed.
                </p>
<div class="example">
<a name="zend.service.amazon.s3.buckets.remove.example"></a><p class="title"><b>例 47.56. Zend_Service_Amazon_S3 Bucket Removal Example</b></p>
<div class="example-contents"><pre class="code">
require_once 'Zend/Service/Amazon/S3.html';

$s3 = new Zend_Service_Amazon_S3($my_aws_key, $my_aws_secret_key);

$s3-&gt;cleanBucket("my-own-bucket");
$s3-&gt;removeBucket("my-own-bucket");
</pre></div>
</div>
<br class="example-break">
</li>
<li class="listitem">
<p>
                    <code>getBuckets()</code> returns the list of the names of all buckets belonging to the
                    user.
                </p>
<div class="example">
<a name="zend.service.amazon.s3.buckets.list.example"></a><p class="title"><b>例 47.57. Zend_Service_Amazon_S3 Bucket Listing Example</b></p>
<div class="example-contents"><pre class="code">
require_once 'Zend/Service/Amazon/S3.html';

$s3 = new Zend_Service_Amazon_S3($my_aws_key, $my_aws_secret_key);

$list = $s3-&gt;getBuckets();
foreach($list as $bucket) {
  echo "I have bucket $bucket\n";
}
</pre></div>
</div>
<br class="example-break">
</li>
<li class="listitem"><p>
                    <code>isBucketAvailable()</code> check if the bucket exists and returns true
                    if it does.
                </p></li>
</ul></div>
</div>
<div class="sect2" title="47.12.7. Object operations">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.amazon.s3.objects"></a>47.12.7. Object operations</h3></div></div></div>
<p>
        The object is the basic storage unit in S3. Object stores unstructured data, which can be
        any size up to 4 gigabytes. There's no limit on how many objects can be stored on the system.
        </p>
<p>
        The object are contained in buckets. Object is identified by name, which can be any utf-8 string.
        It is common to use hierarchical names (such as <code>Pictures/Myself/CodingInPHP.jpg</code>) to
        organise object names. Object name is prefixed with bucket name when using object functions, so for
        object "mydata" in bucket "my-own-bucket" the name would be <code>my-own-bucket/mydata</code>.
        </p>
<p>
        Objects can be replaced (by rewriting new data with the same key) or deleted, but not modified, appended, etc.
        Object is always stored whole.
        </p>
<p>
        By default, all objects are private and can be accessed only by their owner. However, it is possible
        to specify object with public access, in which case it will be available through the URL:
        <code>http://s3.amazonaws.com/[bucket-name]/[object-name]</code>.
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<p>
                    <code>putObject($object, $data, $meta)</code> created an object with name <code>$object</code>
                    (should contain the bucket name as prefix!) having <code>$data</code> as its content.
                </p>
<p>Optional <code>$meta</code> parameter is the array of metadata, which currently supports the
                following parameters as keys:
                </p>
<div class="variablelist"><dl>
<dt><span class="term"><code>S3_CONTENT_TYPE_HEADER</code></span></dt>
<dd><p>
                    MIME content type of the data. If not specified, the type will be guessed according
                    to the file extension of the object name.
                    </p></dd>
<dt><span class="term"><code>S3_ACL_HEADER</code></span></dt>
<dd>
<p>
                    The access to the item. Following access constants can be used:
                        </p>
<div class="variablelist"><dl>
<dt><span class="term"><code>S3_ACL_PRIVATE</code></span></dt>
<dd><p>Only the owner has access to the item.</p></dd>
<dt><span class="term"><code>S3_ACL_PUBLIC_READ</code></span></dt>
<dd><p>Anybody can read the object, but only owner can write.
                            This is setting may be used to store publicly accessible content.</p></dd>
<dt><span class="term"><code>S3_ACL_PUBLIC_WRITE</code></span></dt>
<dd><p>Anybody can read or write the object. This policy is rarely useful.</p></dd>
<dt><span class="term"><code>S3_ACL_AUTH_READ</code></span></dt>
<dd><p>Only the owner has write access to the item, and other authenticated S3
                            users have read access. This is useful for sharing data between S3 accounts without
                            exposing them to the public.</p></dd>
</dl></div>
<p>
                    By default, all the items are private.
                    </p>
<div class="example">
<a name="zend.service.amazon.s3.objects.public.example"></a><p class="title"><b>例 47.58. Zend_Service_Amazon_S3 Public Object Example</b></p>
<div class="example-contents"><pre class="code">
require_once 'Zend/Service/Amazon/S3.html';

$s3 = new Zend_Service_Amazon_S3($my_aws_key, $my_aws_secret_key);

$s3-&gt;putObject("my-own-bucket/Pictures/Me.png", file_get_contents("me.png"),
    array(Zend_Service_Amazon_S3::S3_ACL_HEADER =&gt;
          Zend_Service_Amazon_S3::S3_ACL_PUBLIC_READ));
// or:
$s3-&gt;putFile("me.png", "my-own-bucket/Pictures/Me.png",
    array(Zend_Service_Amazon_S3::S3_ACL_HEADER =&gt;
          Zend_Service_Amazon_S3::S3_ACL_PUBLIC_READ));
echo "Go to http://s3.amazonaws.com/my-own-bucket/Pictures/Me.png to see me!\n";
</pre></div>
</div>
<br class="example-break">
</dd>
</dl></div>
</li>
<li class="listitem"><p>
                    <code>getObject($object)</code> retrieves object data from the storage by name.
                </p></li>
<li class="listitem"><p>
                    <code>removeObject($object)</code> removes the object from the storage.
                </p></li>
<li class="listitem">
<p>
                    <code>getInfo($object)</code> retrieves the metadata information about the object. The
                    function will return array with metadata information. Some of the useful keys are:
                        </p>
<div class="variablelist"><dl>
<dt><span class="term"><code>type</code></span></dt>
<dd><p>The MIME type of the item.</p></dd>
<dt><span class="term"><code>size</code></span></dt>
<dd><p>The size of the object data.</p></dd>
<dt><span class="term"><code>mtime</code></span></dt>
<dd><p>UNIX-type timestamp of the last modification for the object.</p></dd>
<dt><span class="term"><code>etag</code></span></dt>
<dd><p>The ETag of the data, which is the MD5 hash of the data, surrounded by quotes (").</p></dd>
</dl></div>
<p>
                        The function will return false if the key does not correspond to any existing object.
                </p>
</li>
<li class="listitem">
<p>
                    <code>getObjectsByBucket($bucket)</code> returns the list of the object keys, contained
                    in the bucket.
                </p>
<div class="example">
<a name="zend.service.amazon.s3.objects.list.example"></a><p class="title"><b>例 47.59. Zend_Service_Amazon_S3 Object Listing Example</b></p>
<div class="example-contents"><pre class="code">
require_once 'Zend/Service/Amazon/S3.html';

$s3 = new Zend_Service_Amazon_S3($my_aws_key, $my_aws_secret_key);

$list = $s3-&gt;getObjectsByBucket("my-own-bucket");
foreach($list as $name) {
  echo "I have $name key:\n";
  $data = $s3-&gt;getObject("my-own-bucket/$name");
  echo "with data: $data\n";
}
</pre></div>
</div>
<br class="example-break">
</li>
<li class="listitem"><p>
                    <code>isObjectAvailable($object)</code> checks if the object with given name exists.
                </p></li>
<li class="listitem">
<p>
                    <code>putFile($path, $object, $meta)</code> puts the content of the file in <code>$path</code>
                    into the object named <code>$object</code>.
                </p>
<p>
                The optional <code>$meta</code> argument is the same as for <code>putObject</code>. If the
                content type is omitted, it will be guessed basing on the source file name.
                </p>
</li>
</ul></div>
</div>
<div class="sect2" title="47.12.8. Stream wrapper">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.amazon.s3.streams"></a>47.12.8. Stream wrapper</h3></div></div></div>
<p>
        In addition to the interfaces described above, <code class="classname">Zend_Service_Amazon_S3</code> also supports
        operating as a stream wrapper. For this, you need to register the client object as the stream wrapper:
        </p>
<div class="example">
<a name="zend.service.amazon.s3.streams.example"></a><p class="title"><b>例 47.60. Zend_Service_Amazon_S3 Streams Example</b></p>
<div class="example-contents"><pre class="code">
require_once 'Zend/Service/Amazon/S3.html';

$s3 = new Zend_Service_Amazon_S3($my_aws_key, $my_aws_secret_key);

$s3-&gt;registerStreamWrapper("s3");

mkdir("s3://my-own-bucket");
file_put_contents("s3://my-own-bucket/testdata", "mydata");

echo file_get_contents("s3://my-own-bucket/testdata");
</pre></div>
</div>
<br class="example-break"><p>
        Directory operations (<code>mkdir</code>, <code>rmdir</code>, <code>opendir</code>, etc.)
        will operate on buckets and thus their arguments should be of the form of <code>s3://bucketname</code>.
        File operations operate on objects. Object creation, reading, writing, deletion, stat and
        directory listing is supported.
        </p>
</div>
</div>
<div class="revinfo"></div>


<!--start of htmlend-->

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->