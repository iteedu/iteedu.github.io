<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<!--end of htmlmiddle-->



<div class="sect1" title="56.3. Using Translation Adapters">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.translate.using"></a>56.3. Using Translation Adapters</h2></div></div></div>
<p>
        The next step is to use the adapter within your code.
    </p>
<div class="example">
<a name="zend.translate.using.example1"></a><p class="title"><b>例 56.1. Example of single-language PHP code</b></p>
<div class="example-contents"><pre class="code">
print "Example\n";
print "=======\n";
print "Here is line one\n";
print "Today is the " . date("d.m.Y") . "\n";
print "\n";
print "Here is line two\n";
</pre></div>
</div>
<br class="example-break"><p>
        The example above shows some output with no support for translation.
        You probably write your code in your native language.
        Generally you need to translate not only the output,
        but also error and log messages.
    </p>
<p>
        The next step is to integrate Zend Translate into your existing code.
        Of course it is much easier if you had already written your code with
        translation in mind, than changing your code afterwards.
    </p>
<div class="example">
<a name="zend.translate.using.example2"></a><p class="title"><b>例 56.2. Example of multi-lingual PHP code</b></p>
<div class="example-contents"><pre class="code">
$translate = new Zend_Translate('gettext', '/my/path/source-de.mo', 'de');
$translate-&gt;addTranslation('/path/to/translation/fr-source.mo', 'fr');

print $translate-&gt;_("Example") . "\n";
print "=======\n";
print $translate-&gt;_("Here is line one") . "\n";
printf($translate-&gt;_("Today is the %1\$s") . "\n", date('d.m.Y'));
print "\n";

$translate-&gt;setLocale('fr');
print $translate-&gt;_("Here is line two") . "\n";
</pre></div>
</div>
<br class="example-break"><p>
        Now let's take a deeper look into what has been done and how to
        integrate <code class="classname">Zend_Translate</code> into your own code.
    </p>
<p>
        Create a new <code class="classname">Zend_Translate</code> object and define the base adapter:

        </p>
<pre class="code">
$translate = new Zend_Translate
    'gettext',
    '/path/to/translation/source-de.mo',
    'de'
);
</pre>
<p>

        In this example we chose the
        <span class="emphasis"><em>Gettext Adapter</em></span>.
        We place our file <span class="emphasis"><em>source-de.mo</em></span>
        into the directory <span class="emphasis"><em>/path/to/translation</em></span>.
        The gettext file will have German translation included,
        and we also added another language source for French.
    </p>
<p>
        The next step is to wrap all strings which are to be translated.
        The simplest approach is to have only simple strings or sentences
        like this:

        </p>
<pre class="code">
print $translate-&gt;_("Example") . "\n";
print "=======\n";
print $translate-&gt;_("Here is line one") . "\n";
</pre>
<p>

        Some strings do not needed to be translated.
        The separating line is always a separating line,
        even in other languages.
    </p>
<p>
        Having data values integrated into a translation string is also
        supported through the use of embedded parameters.

        </p>
<pre class="code">
printf($translate-&gt;_("Today is the %1\$s") . "\n", date("d.m.Y"));
</pre>
<p>

        Instead of <code>print()</code>, use the <code>printf()</code>
        function and replace all parameters with <code>%1\$s</code> parts.
        The first is <code>%1\$s</code>, the second is <code>%2\$s</code>,
        and so on. This way a translation can be done without knowing
        the exact value. In our example, the date is always the actual day,
        but the string can be translated without the knowledge of the actual
        day.
    </p>
<p>
        Each string is identified in the translation storage by a message ID.
        You can use message IDs instead of strings in your code, like this:

        </p>
<pre class="code">
print $translate-&gt;_(1) . "\n";
print "=======\n";
print $translate-&gt;_(2) . "\n";
</pre>
<p>

        But doing this has several disadvantages:
    </p>
<p>
        You can not see what your code should output just by viewing your code.
    </p>
<p>
        Also you will have problems if some strings are not translated.
        You must always keep in mind how translation works.
        First <code class="classname">Zend_Translate</code> checks whether the specified language has a translation
        for the given message ID or string.
        If no translation string has been found it refers to the next lower
        level language as defined within <code class="classname">Zend_Locale</code>.
        So "<span class="emphasis"><em>de_AT</em></span>" becomes
        "<span class="emphasis"><em>de</em></span>" only.
        If there is no translation found for
        "<span class="emphasis"><em>de</em></span>" either,
        then the original message is returned.
        This way you always have an output, even in case the message translation
        does not exist in your message storage.
        <code class="classname">Zend_Translate</code> never throws an error or exception when translating
        strings.
    </p>
<div class="sect2" title="56.3.1. Translation Source Structures">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.structure"></a>56.3.1. Translation Source Structures</h3></div></div></div>
<p>
            Your next step is to create the translation sources for the
            languages you want to translate.
            Every adapter is created its own way as described here,
            but there are common features applicable for all adapters.
        </p>
<p>
            You have to decide where to store your translation source files.
            Using <code class="classname">Zend_Translate</code> you are not restricted in any way.
            The following structures are preferable:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
<p>
                    Single structured source
                </p>
<pre class="code">
/application/
/languages/
/languages/lang.en
/languages/lang.de
/library/
</pre>
<p>
                    Positive: all source files for every languages are stored
                    in one directory. No splitting of related files.
                </p>
</li>
<li class="listitem">
<p>
                    Language structured source
                </p>
<pre class="code">
/application/
/languages/
/languages/en/
/languages/en/first.en
/languages/en/second.en
/languages/de/
/languages/de/first.de
/languages/de/second.de
/library
</pre>
<p>
                    Positive: Every language is stored in their own directories.
                    Easy translation, as every language team has to translate
                    only one directory. Also the usage of multiple files is transparent.
                </p>
</li>
<li class="listitem">
<p>
                    Application structured source
                </p>
<pre class="code">
/application/
/application/languages/
/application/languages/first.en
/application/languages/first.de
/application/languages/second.en
/application/languages/second.de
/library/
</pre>
<p>
                    Positive: all source files for every language are stored
                    in one directory. No splitting of related files.
                </p>
<p>
                    Negative: having multiple files for the same language can be
                    problematic.
                </p>
</li>
<li class="listitem">
<p>
                    Gettext structured source
                </p>
<pre class="code">
/application/
/languages/
/languages/de/
/languages/de/LC_MESSAGES/
/languages/de/LC_MESSAGES/first.mo
/languages/de/LC_MESSAGES/second.mo
/languages/en/
/languages/en/LC_MESSAGES/
/languages/en/LC_MESSAGES/first.mo
/languages/en/LC_MESSAGES/second.mo
/library/
</pre>
<p>
                    Positive: existing gettext sources can be used without changing
                    structure.
                </p>
<p>
                    Negative: having sub-sub directories may be confusing
                    for people who have not used gettext before.
                </p>
</li>
<li class="listitem">
<p>
                   File structured source
                </p>
<pre class="code">
/application/
/application/models/
/application/models/MyModel.html
/application/models/MyModel.de
/application/models/MyModel.en
/application/controllers/
/application/controllers/MyController.html
/application/controllers/MyController.de
/application/controllers/MyController.en
/library/
</pre>
<p>
                    Positive: translation files are localted near their source.
                </p>
<p>
                    Negative: too many and also small translation files result in
                    being tendious to translate.
                    Also every file has to be added as translation source.
                </p>
</li>
</ul></div>
<p>
            Single structured and language structured source files are most
            usable for <code class="classname">Zend_Translate</code>.
        </p>
<p>
            So now, that we know which structure we want to have,
            we should create our translation source files.
        </p>
</div>
<div class="sect2" title="56.3.2. Creating Array source files">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.source.array"></a>56.3.2. Creating Array source files</h3></div></div></div>
<p>
            Array source files are plain arrays. But you have to define them
            manually since there is no tool to aid this.
            But because they are so simple, it's the fastest way to look up
            messages if your code works as expected. It's generally the best
            adapter to get started with translation business.
        </p>
<pre class="code">
$english = array(
    'message1' =&gt; 'message1',
    'message2' =&gt; 'message2',
    'message3' =&gt; 'message3');

$german = array(
    'message1' =&gt; 'Nachricht1',
    'message2' =&gt; 'Nachricht2',
    'message3' =&gt; 'Nachricht3');

$translate = new Zend_Translate('array', $english, 'en');
$translate-&gt;addTranslation($deutsch, 'de');
</pre>
<p>
            Since release 1.5 it is also supported to have arrays included within an external file.
            You just have to provide the filename and <code class="classname">Zend_Translate</code> will automatically
            include it and look for the array. See the following example for details:
        </p>
<pre class="code">
// myarray.html
return array(
    'message1' =&gt; 'Nachricht1',
    'message2' =&gt; 'Nachricht2',
    'message3' =&gt; 'Nachricht3');

// controller
$translate = new Zend_Translate('array', '/path/to/myarray.html', 'de');
</pre>
<div class="note" title="注意"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                Files which do not return an array will fail to be included.
                Also any output within this file will be ignored and suppressed.
            </p></td></tr>
</table></div>
</div>
<div class="sect2" title="56.3.3. Creating Gettext source files">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.source.gettext"></a>56.3.3. Creating Gettext source files</h3></div></div></div>
<p>
            Gettext source files are created by GNU's gettext library.
            There are several free tools available that can parse your
            code files and create the needed gettext source files.
            These have the extension <span class="emphasis"><em>*.mo</em></span>
            and they are binary files.
            An open source tool for creating the files is
            poEdit.
            This tool also supports you during the translation process itself.
        </p>
<pre class="code">
// We accume that we have created the mo files and translated them
$translate = new Zend_Translate('gettext', '/path/to/english.mo', 'en');
$translate-&gt;addTranslation('/path/to/german.mo', 'de');
</pre>
<p>
            As you can see the adapters are used exactly the same way,
            with one small difference:
            change <span class="emphasis"><em>array</em></span> to <span class="emphasis"><em>gettext</em></span>. All other usages are exactly
            the same as with all other adapters.
            With the gettext adapter you no longer have to be aware of
            gettext's standard directory structure,
            bindtextdomain and textdomain.
            Just give the path and filename to the adapter.
        </p>
<div class="note" title="注意"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top">
<p>
                 You should always use UTF-8 as source encoding.
                 Otherwise you will have problems when using two
                 different source encodings.
                 E.g. one of your source files is encoded
                 with ISO-8815-11 and another one with CP815.
                 You can set only one encoding for your source file,
                 so one of your languages probably will not display correctly.
            </p>
<p>
                 UTF-8 is a portable format which supports all languages.
                 When using UTF-8 for all languages, you will eliminate
                 the problem of incompatible encodings.
            </p>
</td></tr>
</table></div>
<p>
            Many gettext editors add adapter informations as empty translation string.
            This is the reason why empty strings are not translated when using the
            gettext adapter. Instead they are erased from the translation table and
            provided by the <code>getAdapterInfo()</code> method. It will return
            the adapter informations for all added gettext files as array using the
            filename as key.
        </p>
<pre class="code">
// Getting the adapter informations
$translate = new Zend_Translate('gettext', '/path/to/english.mo', 'en');
print_r($translate-&gt;getAdapterInfo());
</pre>
</div>
<div class="sect2" title="56.3.4. Creating TMX source files">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.source.tmx"></a>56.3.4. Creating TMX source files</h3></div></div></div>
<p>
            TMX source files are a new industry standard.
            They have the advantage of being XML files and so they are
            readable by every editor and of course by humans.
            You can either create TMX files manually with a text editor,
            or you can use a special tool. But most tools currently available for
            creating TMX source files are not freely available.
        </p>
<div class="example">
<a name="zend.translate.using.source.tmx.example"></a><p class="title"><b>例 56.3. Example TMX file</b></p>
<div class="example-contents">
<pre class="code">
&lt;?xml version="1.0" ?&gt;
&lt;!DOCTYPE tmx SYSTEM "tmx14.dtd"&gt;
&lt;tmx version="1.4"&gt;
 &lt;header creationtoolversion="1.0.0" datatype="winres" segtype="sentence"
         adminlang="en-us" srclang="de-at" o-tmf="abc"
         creationtool="XYZTool" &gt;
 &lt;/header&gt;
 &lt;body&gt;
  &lt;tu tuid='message1'&gt;
   &lt;tuv xml:lang="de"&gt;&lt;seg&gt;Nachricht1&lt;/seg&gt;&lt;/tuv&gt;
   &lt;tuv xml:lang="en"&gt;&lt;seg&gt;message1&lt;/seg&gt;&lt;/tuv&gt;
  &lt;/tu&gt;
  &lt;tu tuid='message2'&gt;
   &lt;tuv xml:lang="en"&gt;&lt;seg&gt;message2&lt;/seg&gt;&lt;/tuv&gt;
   &lt;tuv xml:lang="de"&gt;&lt;seg&gt;Nachricht2&lt;/seg&gt;&lt;/tuv&gt;
  &lt;/tu&gt;
</pre>
<pre class="code">
$translate = new Zend_Translate('tmx', 'path/to/mytranslation.tmx', 'en');
</pre>
</div>
</div>
<br class="example-break"><p>
            TMX files can have several languages within the same file.
            All other included languages are added automatically,
            so you do not have to call <code>addLanguage()</code>.
        </p>
<p>
            If you want to have only specified languages from the source translated
            you can set the option '<code>defined_language</code>' to <code>true</code>.
            With this option you can add the wished languages explicitly with
            <code>addLanguage()</code>. The default value for this option is to add all
            languages.
        </p>
</div>
<div class="sect2" title="56.3.5. Creating CSV source files">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.source.csv"></a>56.3.5. Creating CSV source files</h3></div></div></div>
<p>
            CSV source files are small and human readable.
            If your customers want to translate their own,
            you will probably use the CSV adapter.
        </p>
<div class="example">
<a name="zend.translate.using.source.csv.example"></a><p class="title"><b>例 56.4. Example CSV file</b></p>
<div class="example-contents">
<pre class="code">
﻿#Example csv file
message1;Nachricht1
message2;Nachricht2
</pre>
<pre class="code">
$translate = new Zend_Translate('csv', '/path/to/mytranslation.csv', 'de');
$translate-&gt;addTranslation('path/to/other.csv', 'fr');
</pre>
</div>
</div>
<br class="example-break"><p>
            There are three different options for the CSV adapter.
            You can set '<code>delimiter</code>', '<code>limit</code>' and
            '<code>enclosure</code>'.
        </p>
<p>
            The default delimiter for CSV string is '<code>;</code>', but
            with the option '<code>delimiter</code>'
            you can decide to use another one.
        </p>
<p>
            The default limit for a line within a CSV file is '<code>0</code>'. This means
            that the end of a CSV line is searched automatically. If you set
            '<code>limit</code>' to any value, then the CSV file will be
            read faster, but any line exceeding this limit will be truncated.
        </p>
<p>
            The default enclosure to use for CSV files is '<code>"</code>'. You can
            set a different one using the option '<code>enclosure</code>'.
        </p>
<div class="example">
<a name="zend.translate.using.source.csv.example2"></a><p class="title"><b>例 56.5. Second CSV file example</b></p>
<div class="example-contents">
<pre class="code">
﻿# Example CSV file
"message,1",Nachricht1
message2,"Nachricht,2"
"message3,",Nachricht3
</pre>
<pre class="code">
$translate = new Zend_Translate(
    'csv',
    '/path/to/mytranslation.csv',
    'de',
    array('delimiter' =&gt; ','));

$translate-&gt;addTranslation('/path/to/other.csv', 'fr');
</pre>
</div>
</div>
<br class="example-break">
</div>
<div class="sect2" title="56.3.6. Creating INI source files">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.source.ini"></a>56.3.6. Creating INI source files</h3></div></div></div>
<p>
            INI source files are human readable but normally not very small as they also
            include other data beside translations. If you have data which shall be
            editable by your customers you can use the INI adapter.
        </p>
<div class="example">
<a name="zend.translate.using.source.ini.example"></a><p class="title"><b>例 56.6. Example INI file</b></p>
<div class="example-contents">
<pre class="code">
[Test]
;TestPage Comment
Message_1="Nachricht 1 (de)"
Message_2="Nachricht 2 (de)"
Message_3="Nachricht :3 (de)"
</pre>
<pre class="code">
$translate = new Zend_Translate('ini', '/path/to/mytranslation.ini', 'de');
$translate-&gt;addTranslation('/path/to/other.ini', 'it');
</pre>
</div>
</div>
<br class="example-break"><p>
            INI files have several restrictions. If a value in the ini file contains any
            non-alphanumeric characters it needs to be enclosed in double-quotes (<code>"</code>).
            There are also reserved words which must not be used as keys for ini files.
            These include: <code>null</code>, <code>yes</code>, <code>no</code>, <code>true</code>,
            and <code>false</code>. Values <code>null</code>, <code>no</code> and <code>false</code> results
            in <code>""</code>, <code>yes</code> and <code>true</code> results in <code>1</code>. Characters <code>{}|&amp;~![()"</code> must not be used anywhere
            in the key and have a special meaning in the value. Do not use them as it will
            produce unexpected behaviour.
        </p>
</div>
<div class="sect2" title="56.3.7. Options for adapters">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.options"></a>56.3.7. Options for adapters</h3></div></div></div>
<p>
            Options can be used with all adapters. Of course the options are different for all adapters.
            You can set options when you create the adapter. Actually there is one option which is available
            to all adapters: '<code>clear</code>' sets if translation data should be added to existing
            one or not. Standard behaviour is to add new translation data to existing one. But the
            translation data is only cleared for the selected language. So other languages remain
            untouched.
        </p>
<p>
            You can set options temporarily when using <code>addTranslation($data, $locale, array $options = array())</code>
            as third and optional parameter. And you can use the method <code>setOptions()</code> to
            set the options permanently.
        </p>
<div class="example">
<a name="zend.translate.using.options.example"></a><p class="title"><b>例 56.7. Using translation options</b></p>
<div class="example-contents"><pre class="code">
// define ':' as separator for the translation source files
$options = array('delimiter' =&gt; ':');
$translate = new Zend_Translate(
    'csv',
    '/path/to/mytranslation.csv',
    'de',
    $options);

...

// clear the defined language and use new translation data
$options = array('clear' =&gt; true);
$translate-&gt;addTranslation('/path/to/new.csv', 'fr', $options);
</pre></div>
</div>
<br class="example-break"><p>
            Here you can find all available options for the different adapters with a description of their usage:
        </p>
<div class="table">
<a name="zend.translate.using.options.alloptions"></a><p class="title"><b>表 56.2. Options for translation adapters</b></p>
<div class="table-contents"><table summary="Options for translation adapters" border="1">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Option</th>
<th>Adapter</th>
<th>Description</th>
<th>Default value</th>
</tr></thead>
<tbody>
<tr>
<td>clear</td>
<td>all</td>
<td>
                            If set to true, the already read translations will be cleared. This can be used
                            instead of creating a new instance when reading new translation data
                        </td>
<td><span class="emphasis"><em>false</em></span></td>
</tr>
<tr>
<td>disableNotices</td>
<td>all</td>
<td>
                            If set to true, all notices regarding not available translations will be
                            disabled. You should set this option to true in production environment
                        </td>
<td><span class="emphasis"><em>false</em></span></td>
</tr>
<tr>
<td>ignore</td>
<td>all</td>
<td>
                            All directories and files beginning with this prefix will be ignored when
                            searching for files. This value defaults to <span class="emphasis"><em>'.'</em></span>
                            which leads to the behavior that all hidden files will be ignored. Setting this
                            value to <code>'tmp'</code> would mean that directories and files like
                            <code>'tmpImages'</code> and <code>'tmpFiles'</code>
                            would be ignored as well as all subsequent directories
                        </td>
<td><span class="emphasis"><em>.</em></span></td>
</tr>
<tr>
<td>log</td>
<td>all</td>
<td>
                            An instance of <code class="classname">Zend_Log</code> where untranslated messages and notices will be
                            written to
                        </td>
<td><span class="emphasis"><em>null</em></span></td>
</tr>
<tr>
<td>logMessage</td>
<td>all</td>
<td>
                            The message which will be written into the log
                        </td>
<td><span class="emphasis"><em>Untranslated message within '%locale%': %message%</em></span></td>
</tr>
<tr>
<td>logUntranslated</td>
<td>all</td>
<td>
                            When this option is set to true, all message IDs which can not be
                            translated will be written into the attached log
                        </td>
<td><span class="emphasis"><em>false</em></span></td>
</tr>
<tr>
<td>scan</td>
<td>all</td>
<td>
                            If set to null, no scanning of the directory structure will be done.
                            If set to <code class="classname">Zend_Translate::LOCALE_DIRECTORY</code> the locale will be detected within the
                            directory. If set to <code class="classname">Zend_Translate::LOCALE_FILENAME</code> the locale will be detected
                            within the filename. See <a class="xref" href="zend.translate.using.html#zend.translate.using.detection" title="56.3.9. Automatic source detection">第 56.3.9 节 “Automatic source detection”</a>
                            for details
                        </td>
<td><span class="emphasis"><em>null</em></span></td>
</tr>
<tr>
<td>delimiter</td>
<td>Csv</td>
<td>Defines which sign is used as delimiter for separating source and translation</td>
<td><span class="emphasis"><em>;</em></span></td>
</tr>
<tr>
<td>enclosure</td>
<td>Csv</td>
<td>Defines the enclosure character to be used. Defaults to a doublequote</td>
<td><span class="emphasis"><em>"</em></span></td>
</tr>
<tr>
<td>length</td>
<td>Csv</td>
<td>Defines the maximum length of a csv line. When set to 0 it will be detected automatically</td>
<td><span class="emphasis"><em>0</em></span></td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><p>
            When you want to have self defined options, you are also able to use them within all adapters.
            The <code>setOptions()</code> method can be used to define your option. <code>setOptions()</code>
            needs an array with the options you want to set. If an given option exists it will be signed over.
            You can define as much options as needed as they will not be checked by the adapter. Just make sure
            not to overwrite any existing option which is used by an adapter.
        </p>
<p>
            To return the option you can use the <code>getOptions()</code> method. When <code>getOptions()</code>
            is called without a parameter it will return all options set. When the optional parameter is given
            you will only get the specified option.
        </p>
</div>
<div class="sect2" title="56.3.8. Handling languages">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.languages"></a>56.3.8. Handling languages</h3></div></div></div>
<p>
            When working with different languages there are a few methods which will be useful.
        </p>
<p>
            The <code>getLocale()</code> method can be used to get the currently set language. It can either hold
            an instance of <code class="classname">Zend_Locale</code> or the identifier of a locale.
        </p>
<p>
            The <code>setLocale()</code> method sets a new standard language for translation. This prevents the
            need of setting the optional language parameter more than once to the <code>translate()</code> method.
            If the given language does not exist, or no translation data is available for the language,
            <code>setLocale()</code> tries to downgrade to the language without the region if any was given.
            A language of <code>en_US</code> would be downgraded to <code>en</code>. When even the downgraded
            language can not be found an exception will be thrown.
        </p>
<p>
            The <code>isAvailable()</code> method checks if a given language is already available. It returns
            <code>true</code> if data for the given language exist.
        </p>
<p>
            And finally the <code>getList()</code> method can be used to get all currently set languages for an adapter
            returned as array.
        </p>
<div class="example">
<a name="zend.translate.using.languages.example"></a><p class="title"><b>例 56.8. Handling languages with adapters</b></p>
<div class="example-contents"><pre class="code">
// returns the currently set language
$actual = $translate-&gt;getLocale();

// you can use the optional parameter while translating
echo $translate-&gt;_("my_text", "fr");
// or set a new language
$translate-&gt;setLocale("fr");
echo $translate-&gt;_("my_text");
// refer to the base language
// fr_CH will be downgraded to fr
$translate-&gt;setLocale("fr_CH");
echo $translate-&gt;_("my_text");

// check if this language exist
if ($translate-&gt;isAvailable("fr")) {
    // language exists
}
</pre></div>
</div>
<br class="example-break"><div class="sect3" title="56.3.8.1. Automatical handling of languages">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.translate.using.languages.automatic"></a>56.3.8.1. Automatical handling of languages</h4></div></div></div>
<p>
                Note that as long as you only add new translation sources with the <code>addTranslation()</code>
                method <code class="classname">Zend_Translate</code> will automatically set the best fitting language for your
                environment when you use one of the automatic locales which are '<code>auto</code>' or '<code>browser</code>'. So
                normally you will not need to call <code>setLocale()</code>. This should only be used in
                conjunction with automatic source detection.
            </p>
<p>
                The algorithm will search for the best fitting locale depending on the user's browser and
                your environment. See the following example for details:
            </p>
<div class="example">
<a name="zend.translate.using.languages.automatic.example"></a><p class="title"><b>例 56.9. Automatically language detection</b></p>
<div class="example-contents"><pre class="code">
// Let's expect the browser returns these language settings:
// HTTP_ACCEPT_LANGUAGE = "de_AT=1;fr=1;en_US=0.8";

// Example 1:
// When no fitting language is found, the message ID is returned
$translate = new Zend_Translate(
    'gettext',
    'my_it.mo',
    'auto',
    array('scan' =&gt; Zend_Translate::LOCALE_FILENAME));

// Example 2:
// Best found fitting language is 'fr'
$translate = new Zend_Translate(
    'gettext',
    'my_fr.mo',
    'auto',
    array('scan' =&gt; Zend_Translate::LOCALE_FILENAME));

// Example 3:
// Best found fitting language is 'de' ('de_AT' will be degraded)
$translate = new Zend_Translate(
    'gettext',
    'my_de.mo',
    'auto',
    array('scan' =&gt; Zend_Translate::LOCALE_FILENAME));

// Example 4:
// Returns 'it' as translation source and overrides the automatic settings
$translate = new Zend_Translate(
    'gettext',
    'my_it.mo',
    'auto',
    array('scan' =&gt; Zend_Translate::LOCALE_FILENAME));

$translate-&gt;addTranslation('my_ru.mo', 'ru');
$translate-&gt;setLocale('it_IT');
</pre></div>
</div>
<br class="example-break"><p>
                After setting a language manually with the <code>setLocale()</code> method the automatic
                detection will be switched off and overridden.
            </p>
<p>
                If you want to use it again, you can set the language
                <span class="emphasis"><em>auto</em></span> with <code>setLocale()</code> which will reactivate
                the automatic detection for <code class="classname">Zend_Translate</code>.
            </p>
<p>
                Since Zend Framework 1.7.0 <code class="classname">Zend_Translate</code> also recognises an application
                wide locale. You can simply set a <code class="classname">Zend_Locale</code> instance to the registry like shown
                below. With this notation you can forget about setting the locale manually with each instance
                when you want to use the same locale multiple times.
            </p>
<pre class="code">
// in your bootstrap file
$locale = new Zend_Locale();
Zend_Registry::set('Zend_Locale', $locale);

// default language when requested language is not available
$defaultlanguage = 'en';

// somewhere in your application
$translate = new Zend_Translate('gettext', 'my_de.mo');

if (!$translate-&gt;isAvailable($locale-&gt;getLanguage())) {
    // not available languages are rerouted to another language
    $translate-&gt;setLocale($defaultlanguage);
}

$translate-&gt;getLocale();
</pre>
</div>
</div>
<div class="sect2" title="56.3.9. Automatic source detection">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.detection"></a>56.3.9. Automatic source detection</h3></div></div></div>
<p>
            <code class="classname">Zend_Translate</code> can detect translation sources automatically. So you don't have
            to declare each source file manually. You can let <code class="classname">Zend_Translate</code> do this job and
            scan the complete directory structure for source files.
        </p>
<div class="note" title="注意"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                Automatic source detection is available since Zend Framework version 1.5 .
            </p></td></tr>
</table></div>
<p>
            The usage is quite the same as initiating a single translation source with one difference.
            You must give a directory which has to be scanned instead a file.
        </p>
<div class="example">
<a name="zend.translate.using.languages.directory.example"></a><p class="title"><b>例 56.10. Scanning a directory structure for sources</b></p>
<div class="example-contents"><pre class="code">
// assuming we have the following structure
//  /language/
//  /language/login/login.tmx
//  /language/logout/logout.tmx
//  /language/error/loginerror.tmx
//  /language/error/logouterror.tmx

$translate = new Zend_Translate('tmx', '/language');
</pre></div>
</div>
<br class="example-break"><p>
            So <code class="classname">Zend_Translate</code> does not only search the given directory, but also all subdirectories for
            translation source files. This makes the usage quite simple. But <code class="classname">Zend_Translate</code> will ignore all
            files which are not sources or which produce failures while reading the translation data. So you
            have to make sure that all of your translation sources are correct and readable because you will
            not get any failure if a file is bogus or can not be read.
        </p>
<div class="note" title="注意"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                Depending on how deep your directory structure is and how much files are within this structure
                it can take a long time for <code class="classname">Zend_Translate</code> to complete.
            </p></td></tr>
</table></div>
<p>
            In our example we have used the TMX format which includes the language to be used within the
            source. But many of the other source formats are not able to include the language within the
            file. Even this sources can be used with automatic scanning if you do some pre-requisits as
            described below:
        </p>
<div class="sect3" title="56.3.9.1. Language through naming directories">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.translate.using.detection.directory"></a>56.3.9.1. Language through naming directories</h4></div></div></div>
<p>
                One way to include automatic language detection is to name the directories related to the
                language which is used for the sources within this directory. This is the easiest way and
                is used for example within standard gettext implementations.
            </p>
<p>
                <code class="classname">Zend_Translate</code> needs the '<code>scan</code>' option to know that it should search the names of all
                directories for languages. See the following example for details:
            </p>
<div class="example">
<a name="zend.translate.using.detection.directory.example"></a><p class="title"><b>例 56.11. Directory scanning for languages</b></p>
<div class="example-contents"><pre class="code">
// assuming we have the following structure
//  /language/
//  /language/de/login/login.mo
//  /language/de/error/loginerror.mo
//  /language/en/login/login.mo
//  /language/en/error/loginerror.mo

$translate = new Zend_Translate(
    'gettext',
    '/language',
    null,
    array('scan' =&gt; Zend_Translate::LOCALE_DIRECTORY));
</pre></div>
</div>
<br class="example-break"><div class="note" title="注意"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                    This works only for adapters which do not include the language within the source file.
                    Using this option for example with TMX will be ignored. Also language definitions within
                    the filename will be ignored when using this option.
                </p></td></tr>
</table></div>
<div class="note" title="注意"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                    You should be aware if you have several subdirectories under the same
                    structure. Assuming we have a structure like
                    <code>/language/module/de/en/file.mo</code>. In this case the path contains
                    multiple strings which would be detected as locale. It could be either
                    <code>de</code> or <code>en</code>. In such a case the behaviour is
                    undefined and it is recommended to use file detection in such situations.
                </p></td></tr>
</table></div>
</div>
<div class="sect3" title="56.3.9.2. Language through filenames">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.translate.using.detection.filename"></a>56.3.9.2. Language through filenames</h4></div></div></div>
<p>
                Another way to detect the language automatically is to use special filenames. You can either
                name the complete file or parts of a file after the used language. To use this way of detection
                you will have to set the '<code>scan</code>' option at initiation. There are several ways of naming the
                sourcefiles which are described below:
            </p>
<div class="example">
<a name="zend.translate.using.detection.filename.example"></a><p class="title"><b>例 56.12. Filename scanning for languages</b></p>
<div class="example-contents"><pre class="code">
// assuming we have the following structure
//  /language/
//  /language/login/login_en.mo
//  /language/login/login_de.mo
//  /language/error/loginerror_en.mo
//  /language/error/loginerror_de.mo

$translate = new Zend_Translate(
    'gettext',
    '/language',
    null,
    array('scan' =&gt; Zend_Translate::LOCALE_FILENAME));
</pre></div>
</div>
<br class="example-break"><div class="sect4" title="56.3.9.2.1. Complete filename">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.translate.using.detection.filename.complete"></a>56.3.9.2.1. Complete filename</h5></div></div></div>
<p>
                    Having the whole file named after the language is the simplest way but only viable
                    if you have only one file per language.
                </p>
<pre class="code">
/languages/
/languages/en.mo
/languages/de.mo
/languages/es.mo
</pre>
</div>
<div class="sect4" title="56.3.9.2.2. Extension of the file">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.translate.using.detection.filename.extension"></a>56.3.9.2.2. Extension of the file</h5></div></div></div>
<p>
                    Another simple way to use the extension of the file for language detection.
                    But this may be confusing since you will no longer have an idea which extension the file
                    originally had.
                </p>
<pre class="code">
/languages/
/languages/view.en
/languages/view.de
/languages/view.es
</pre>
</div>
<div class="sect4" title="56.3.9.2.3. Filename tokens">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.translate.using.detection.filename.token"></a>56.3.9.2.3. Filename tokens</h5></div></div></div>
<p>
                    <code class="classname">Zend_Translate</code> is also capable of detecting the language if it is included within the
                    filename. But if you go this way you will have to separate the language with a token.
                    There are three supported tokens which can be used: a dot '.', an underscore '_', or
                    a hyphen '-'.
                </p>
<pre class="code">
/languages/
/languages/view_en.mo -&gt; detects english
/languages/view_de.mo -&gt; detects german
/languages/view_it.mo -&gt; detects italian
</pre>
<p>
                    The first found string delimited by a token which can be interpreted as a locale will be used. See the following
                    example for details.
                </p>
<pre class="code">
/languages/
/languages/view_en_de.mo -&gt; detects english
/languages/view_en_es.mo -&gt; detects english and overwrites the first file
/languages/view_it_it.mo -&gt; detects italian
</pre>
<p>
                    All three tokens are used to detect the locale. When the filename contains multiple tokens,
                    the first found token depends on the order of the tokens which are used. See the following
                    example for details.
                </p>
<pre class="code">
/languages/
/languages/view_en-it.mo -&gt; detects english because '_' will be used before '-'
/languages/view-en_it.mo -&gt; detects italian because '_' will be used before '-'
/languages/view_en.it.mo -&gt; detects italian because '.' will be used before '_'
</pre>
</div>
</div>
</div>
<div class="sect2" title="56.3.10. Checking for translations">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.istranslated"></a>56.3.10. Checking for translations</h3></div></div></div>
<p>
            Normally text will be translated without any computation. But sometimes it is necessary to
            know if a text is translated or not, therefor the <code>isTranslated()</code>
            method can be used.
        </p>
<p>
            <code>isTranslated($messageId, $original = false, $locale = null)</code> takes
            the text you want to check as its first parameter, and as optional third parameter the locale
            for which you want to do the check. The optional second parameter declares whether translation
            is fixed to the declared language or a lower set of translations can be used. If you have a text which
            can be returned for 'en' but not for 'en_US' you will normally get the translation returned, but by
            setting <code>$original</code> to true, <code>isTranslated()</code> will return false.
        </p>
<div class="example">
<a name="zend.translate.using.istranslated.example"></a><p class="title"><b>例 56.13. Checking if a text is translatable</b></p>
<div class="example-contents"><pre class="code">
$english = array(
    'message1' =&gt; 'Nachricht 1',
    'message2' =&gt; 'Nachricht 2',
    'message3' =&gt; 'Nachricht 3');

$translate = new Zend_Translate('array', $english, 'de_AT');

if ($translate-&gt;isTranslated('message1')) {
    print "'message1' can be translated";
}

if (!($translate-&gt;isTranslated('message1', true, 'de'))) {
    print "'message1' can not be translated to 'de'"
        . " as it's available only in 'de_AT'";
}

if ($translate-&gt;isTranslated('message1', false, 'de')) {
    print "'message1' can be translated in 'de_AT' as it falls back to 'de'";
}
</pre></div>
</div>
<br class="example-break">
</div>
<div class="sect2" title="56.3.11. How to log not found translations">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.logging"></a>56.3.11. How to log not found translations</h3></div></div></div>
<p>
            When you have a bigger site or you are creating the translation files manually, you often have
            the problem that some messages are not translated. But there is an easy solution for you when you
            are using <code class="classname">Zend_Translate</code>.
        </p>
<p>
            You have to follow two or three simple steps. First, you have to create an instance of
            <code class="classname">Zend_Log</code>. Then you have to attach this instance to <code class="classname">Zend_Translate</code>.
            See the following example:
        </p>
<div class="example">
<a name="zend.translate.using.logging.example"></a><p class="title"><b>例 56.14. Log translations</b></p>
<div class="example-contents"><pre class="code">
$translate = new Zend_Translate('gettext', $path, 'de');

// Create a log instance
$writer = new Zend_Log_Writer_Stream('/path/to/file.log');
$log    = new Zend_Log($writer);

// Attach it to the translation instance
$translate-&gt;setOptions(array(
    'log'             =&gt; $log,
    'logUntranslated' =&gt; true));

$translate-&gt;translate('unknown string');
</pre></div>
</div>
<br class="example-break"><p>
            Now you will have a new notice in the log: <code>Untranslated message within 'de': unknown string</code>.
        </p>
<div class="note" title="注意"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                You should note that any translation which can not be found will be logged. This means
                all translations when a user requests a language which is not supported. Also every request
                for a message which can not be translated will be logged. Be aware, that 100 people
                requesting the same translation, will result 100 logged notices.
            </p></td></tr>
</table></div>
<p>
            This feature can not only be used to log messages but also to attach this untranslated messages
            into an empty translation file. To do so you will have to write your own log writer which
            writes the format you want to have and strips the prepending "Untranslated message".
        </p>
<p>
            You can also set the '<code>logMessage</code>' option when you want to have your own log message.
            Use the '<code>%message%</code>' token for placing the messageId within your log message, and the
            '<code>%locale%</code>' token for the requested locale. See the following example for a self
            defined log message:
        </p>
<div class="example">
<a name="zend.translate.using.logging.example2"></a><p class="title"><b>例 56.15. Self defined log messages</b></p>
<div class="example-contents"><pre class="code">
$translate = new Zend_Translate('gettext', $path, 'de');

// Create a log instance
$writer = new Zend_Log_Writer_Stream('/path/to/file.log');
$log    = new Zend_Log($writer);

// Attach it to the translation instance
$translate-&gt;setOptions(array(
    'log'             =&gt; $log,
    'logMessage'      =&gt; "Missing '%message%' within locale '%locale%'",
    'logUntranslated' =&gt; true));

$translate-&gt;translate('unknown string');
</pre></div>
</div>
<br class="example-break">
</div>
<div class="sect2" title="56.3.12. Accessing source data">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.using.sourcedata"></a>56.3.12. Accessing source data</h3></div></div></div>
<p>
            Sometimes it is useful to have access to the translation source data. Therefor
            the following two functions are provided.
        </p>
<p>
            The <code>getMessageIds($locale = null)</code> method returns all known message IDs as array.
        </p>
<p>
            The <code>getMessages($locale = null)</code> method returns the complete translation source as
            an array. The message ID is used as key and the translation data as value.
        </p>
<p>
            Both methods accept an optional parameter <code>$locale</code> which, if set, returns the
            translation data for the specified language. If this parameter is not given, the actual set
            language will be used. Keep in mind that normally all translations should be available in all
            languages. Which means that in a normal situation you will not have to set this parameter.
        </p>
<p>
            Additionally the <code>getMessages()</code> method can be used to return the complete
            translation dictionary using the pseudo-locale 'all'. This will return all available
            translation data for each added locale.
        </p>
<div class="note" title="注意"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">注意</th>
</tr>
<tr><td align="left" valign="top"><p>
                Attention: the returned array can be <span class="emphasis"><em>very big</em></span>,
                depending on the number of added locales and the amount of translation data.
            </p></td></tr>
</table></div>
<div class="example">
<a name="zend.translate.using.sourcedata.example"></a><p class="title"><b>例 56.16. Handling languages with adapters</b></p>
<div class="example-contents"><pre class="code">
// returns all known message IDs
$messageIds = $translate-&gt;getMessageIds();
print_r($messageIds);

// or just for the specified language
$messageIds = $translate-&gt;getMessageIds('en_US');
print_r($messageIds);

// returns all the complete translation data
$source = $translate-&gt;getMessages();
print_r($source);
</pre></div>
</div>
<br class="example-break">
</div>
</div>
<div class="revinfo"></div>


<!--start of htmlend-->

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->