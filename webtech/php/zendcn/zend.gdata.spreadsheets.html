<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<!--end of htmlmiddle-->



<div class="sect1" title="24.8. Using Google Spreadsheets">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.gdata.spreadsheets"></a>24.8. Using Google Spreadsheets</h2></div></div></div>
<p>
        The Google Spreadsheets data API allows client applications to view
        and update Spreadsheets content in the form of Google data API feeds.
        Your client application can request a list of a user's spreadsheets,
        edit or delete content in an existing Spreadsheets worksheet, and
        query the content in an existing Spreadsheets worksheet.
    </p>
<p>
        See
        http://code.google.com/apis/spreadsheets/overview.html
        for more information about the Google Spreadsheets API.
    </p>
<div class="sect2" title="24.8.1. Create a Spreadsheet">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.gdata.spreadsheets.creating"></a>24.8.1. Create a Spreadsheet</h3></div></div></div>
<p>
            The Spreadsheets data API does not currently provide a way to
            programmatically create or delete a spreadsheet.
        </p>
</div>
<div class="sect2" title="24.8.2. Get a List of Spreadsheets">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.gdata.spreadsheets.listspreadsheets"></a>24.8.2. Get a List of Spreadsheets</h3></div></div></div>
<p>
            You can get a list of spreadsheets for a particular user by using
            the <code>getSpreadsheetFeed</code> method of the Spreadsheets
            service. The service will return a
            <code class="classname">Zend_Gdata_Spreadsheets_SpreadsheetFeed</code> object
            containing a list of spreadsheets associated with the authenticated
            user.
        </p>
<pre class="code">
$service = Zend_Gdata_Spreadsheets::AUTH_SERVICE_NAME;
$client = Zend_Gdata_ClientLogin::getHttpClient($user, $pass, $service);
$spreadsheetService = new Zend_Gdata_Spreadsheets($client);
$feed = $spreadsheetService-&gt;getSpreadsheetFeed();
</pre>
</div>
<div class="sect2" title="24.8.3. Get a List of Worksheets">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.gdata.spreadsheets.listworksheets"></a>24.8.3. Get a List of Worksheets</h3></div></div></div>
<p>
            A given spreadsheet may contain multiple worksheets. For each
            spreadsheet, there's a worksheets metafeed listing all the
            worksheets in that spreadsheet.
        </p>
<p>
            Given the spreadsheet key from the &lt;id&gt; of a
            <code class="classname">Zend_Gdata_Spreadsheets_SpreadsheetEntry</code>
            object you've already retrieved, you can fetch a feed
            containing a list of worksheets associated with that spreadsheet.
        </p>
<pre class="code">
$query = new Zend_Gdata_Spreadsheets_DocumentQuery();
$query-&gt;setSpreadsheetKey($spreadsheetKey);
$feed = $spreadsheetService-&gt;getWorksheetFeed($query);
</pre>
<p>
            The resulting <code class="classname">Zend_Gdata_Spreadsheets_WorksheetFeed</code>
            object feed represents the response from the server. Among other
            things, this feed contains a list of
            <code class="classname">Zend_Gdata_Spreadsheets_WorksheetEntry </code>
            objects (<code>$feed-&gt;entries</code>), each of which represents a
            single worksheet.
        </p>
</div>
<div class="sect2" title="24.8.4. Interacting With List-based Feeds">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.gdata.spreadsheets.listfeeds"></a>24.8.4. Interacting With List-based Feeds</h3></div></div></div>
<p>
            A given worksheet generally contains multiple rows, each
            containing multiple cells. You can request data from the
            worksheet either as a list-based feed, in which each entry
            represents a row, or as a cell-based feed, in which each
            entry represents a single cell. For information on cell-based
            feeds, see <a class="link" href="zend.gdata.spreadsheets.html#zend.gdata.spreadsheets.cellfeeds" title="24.8.5. Interacting With Cell-based Feeds">Interacting with cell-based feeds</a>.
        </p>
<p>
            The following sections describe how to get a list-based feed,
            add a row to a worksheet, and send queries with various query
            parameters.
        </p>
<p>
            The list feed makes some assumptions about how the data is laid
            out in the spreadsheet.
        </p>
<p>
            In particular, the list feed treats the first row of the
            worksheet as a header row; Spreadsheets dynamically creates
            XML elements named after the contents of header-row cells.
            Users who want to provide Gdata feeds should not put any data
            other than column headers in the first row of a worksheet.
        </p>
<p>
            The list feed contains all rows after the first row up to the
            first blank row. The first blank row terminates the data set.
            If expected data isn't appearing in a feed, check the worksheet
            manually to see whether there's an unexpected blank row in the
            middle of the data. In particular, if the second row of the
            spreadsheet is blank, then the list feed will contain no data.
        </p>
<p>
            A row in a list feed is as many columns wide as the worksheet itself.
        </p>
<div class="sect3" title="24.8.4.1. Get a List-based Feed">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.spreadsheets.listfeeds.get"></a>24.8.4.1. Get a List-based Feed</h4></div></div></div>
<p>
                To retrieve a worksheet's list feed, use the
                <code>getListFeed</code> method of the Spreadsheets service.
            </p>
<pre class="code">
$query = new Zend_Gdata_Spreadsheets_ListQuery();
$query-&gt;setSpreadsheetKey($spreadsheetKey);
$query-&gt;setWorksheetId($worksheetId);
$listFeed = $spreadsheetService-&gt;getListFeed($query);
</pre>
<p>
                The resulting <code class="classname">Zend_Gdata_Spreadsheets_ListFeed</code>
                object <code>$listfeed</code> represents a response from the
                server. Among other things, this feed contains an array of
                <code class="classname">Zend_Gdata_Spreadsheets_ListEntry</code> objects
                (<code>$listFeed-&gt;entries</code>), each of which represents
                a single row in a worksheet.
            </p>
<p>
              Each <code class="classname">Zend_Gdata_Spreadsheets_ListEntry</code> contains an
              array, <code>custom</code>, which contains the data for that
              row. You can extract and display this array:
            </p>
<pre class="code">
$rowData = $listFeed-&gt;entries[1]-&gt;getCustom();
foreach($rowData as $customEntry) {
  echo $customEntry-&gt;getColumnName() . " = " . $customEntry-&gt;getText();
}
</pre>
<p>
              An alternate version of this array, <code>customByName</code>,
              allows direct access to an entry's cells by name. This is
              convenient when trying to access a specific header:
            </p>
<pre class="code">
$customEntry = $listFeed-&gt;entries[1]-&gt;getCustomByName('my_heading');
echo $customEntry-&gt;getColumnName() . " = " . $customEntry-&gt;getText();
</pre>
</div>
<div class="sect3" title="24.8.4.2. Reverse-sort Rows">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.spreadsheets.listfeeds.reverse"></a>24.8.4.2. Reverse-sort Rows</h4></div></div></div>
<p>
                By default, rows in the feed appear in the same order as the
                corresponding rows in the GUI; that is, they're in order by
                row number. To get rows in reverse order, set the reverse
                properties of the <code class="classname">Zend_Gdata_Spreadsheets_ListQuery</code>
                object to true:
            </p>
<pre class="code">
$query = new Zend_Gdata_Spreadsheets_ListQuery();
$query-&gt;setSpreadsheetKey($spreadsheetKey);
$query-&gt;setWorksheetId($worksheetId);
$query-&gt;setReverse('true');
$listFeed = $spreadsheetService-&gt;getListFeed($query);
</pre>
<p>
                Note that if you want to order (or reverse sort) by a
                particular column, rather than by position in the worksheet,
                you can set the <code>orderby</code> value of the
                <code class="classname">Zend_Gdata_Spreadsheets_ListQuery</code> object to
                <code>column:&lt;the header of that column&gt;</code>.
            </p>
</div>
<div class="sect3" title="24.8.4.3. Send a Structured Query">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.spreadsheets.listfeeds.sq"></a>24.8.4.3. Send a Structured Query</h4></div></div></div>
<p>
                You can set a <code class="classname">Zend_Gdata_Spreadsheets_ListQuery</code>'s
                <code>sq</code> value to produce a feed with entries that meet
                the specified criteria. For example, suppose you have a worksheet
                containing personnel data, in which each row represents
                information about a single person. You wish to retrieve all rows
                in which the person's name is "John" and the person's age is over
                25. To do so, you would set <code>sq</code> as follows:
            </p>
<pre class="code">
$query = new Zend_Gdata_Spreadsheets_ListQuery();
$query-&gt;setSpreadsheetKey($spreadsheetKey);
$query-&gt;setWorksheetId($worksheetId);
$query-&gt;setSpreadsheetQuery('name=John and age&gt;25');
$listFeed = $spreadsheetService-&gt;getListFeed($query);
</pre>
</div>
<div class="sect3" title="24.8.4.4. Add a Row">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.spreadsheets.listfeeds.addrow"></a>24.8.4.4. Add a Row</h4></div></div></div>
<p>
                Rows can be added to a spreadsheet by using the
                <code>insertRow</code> method of the Spreadsheet service.
            </p>
<pre class="code">
$insertedListEntry = $spreadsheetService-&gt;insertRow($rowData,
                                                    $spreadsheetKey,
                                                    $worksheetId);
</pre>
<p>
                The <code>$rowData</code> parameter contains an array of column
                keys to data values. The method returns a
                <code class="classname">Zend_Gdata_Spreadsheets_SpreadsheetsEntry</code> object
                which represents the inserted row.
            </p>
<p>
                Spreadsheets inserts the new row immediately after the last row
                that appears in the list-based feed, which is to say
                immediately before the first entirely blank row.
            </p>
</div>
<div class="sect3" title="24.8.4.5. Edit a Row">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.spreadsheets.listfeeds.editrow"></a>24.8.4.5. Edit a Row</h4></div></div></div>
<p>
                Once a <code class="classname">Zend_Gdata_Spreadsheets_ListEntry</code> object
                is fetched, its rows can be updated by using the
                <code>updateRow</code> method of the Spreadsheet service.
            </p>
<pre class="code">
$updatedListEntry = $spreadsheetService-&gt;updateRow($oldListEntry,
                                                   $newRowData);
</pre>
<p>
                The <code>$oldListEntry</code> parameter contains the list entry
                to be updated. <code>$newRowData</code> contains an array of
                column keys to data values, to be used as the new row data.
                The method returns a
                <code class="classname">Zend_Gdata_Spreadsheets_SpreadsheetsEntry</code> object
                which represents the updated row.
            </p>
</div>
<div class="sect3" title="24.8.4.6. Delete a Row">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.spreadsheets.listfeeds.deleterow"></a>24.8.4.6. Delete a Row</h4></div></div></div>
<p>
                To delete a row, simply invoke <code>deleteRow</code> on the
                <code class="classname">Zend_Gdata_Spreadsheets</code> object with the existing
                entry to be deleted:
            </p>
<pre class="code">
$spreadsheetService-&gt;deleteRow($listEntry);
</pre>
<p>
                Alternatively, you can call the <code>delete</code> method of
                the entry itself:
            </p>
<pre class="code">
$listEntry-&gt;delete();
</pre>
</div>
</div>
<div class="sect2" title="24.8.5. Interacting With Cell-based Feeds">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.gdata.spreadsheets.cellfeeds"></a>24.8.5. Interacting With Cell-based Feeds</h3></div></div></div>
<p>
            In a cell-based feed, each entry represents a single cell.
        </p>
<p>
            Note that we don't recommend interacting with both a cell-based
            feed and a list-based feed for the same worksheet at the same time.
        </p>
<div class="sect3" title="24.8.5.1. Get a Cell-based Feed">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.spreadsheets.cellfeeds.get"></a>24.8.5.1. Get a Cell-based Feed</h4></div></div></div>
<p>
                To retrieve a worksheet's cell feed, use the
                <code>getCellFeed</code> method of the Spreadsheets service.
            </p>
<pre class="code">
$query = new Zend_Gdata_Spreadsheets_CellQuery();
$query-&gt;setSpreadsheetKey($spreadsheetKey);
$query-&gt;setWorksheetId($worksheetId);
$cellFeed = $spreadsheetService-&gt;getCellFeed($query);
</pre>
<p>
                The resulting <code class="classname">Zend_Gdata_Spreadsheets_CellFeed</code>
                object <code>$cellFeed</code> represents a response from the
                server. Among other things, this feed contains an array of
                <code class="classname">Zend_Gdata_Spreadsheets_CellEntry</code> objects
                (<code>$cellFeed&gt;entries</code>), each of which represents
                a single cell in a worksheet. You can display this information:
            </p>
<pre class="code">
foreach($cellFeed as $cellEntry) {
  $row = $cellEntry-&gt;cell-&gt;getRow();
  $col = $cellEntry-&gt;cell-&gt;getColumn();
  $val = $cellEntry-&gt;cell-&gt;getText();
  echo "$row, $col = $val\n";
}
</pre>
</div>
<div class="sect3" title="24.8.5.2. Send a Cell Range Query">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.spreadsheets.cellfeeds.cellrangequery"></a>24.8.5.2. Send a Cell Range Query</h4></div></div></div>
<p>
                Suppose you wanted to retrieve the cells in the first column
                of a worksheet. You can request a cell feed containing only
                this column as follows:
            </p>
<pre class="code">
$query = new Zend_Gdata_Spreadsheets_CellQuery();
$query-&gt;setMinCol(1);
$query-&gt;setMaxCol(1);
$query-&gt;setMinRow(2);
$feed = $spreadsheetService-&gt;getCellsFeed($query);
</pre>
<p>
                This requests all the data in column 1, starting with row 2.
            </p>
</div>
<div class="sect3" title="24.8.5.3. Change Contents of a Cell">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.gdata.spreadsheets.cellfeeds.updatecell"></a>24.8.5.3. Change Contents of a Cell</h4></div></div></div>
<p>
                To modify the contents of a cell, call
                <code>updateCell</code> with the row, column,
                and new value of the cell.
            </p>
<pre class="code">
$updatedCell = $spreadsheetService-&gt;updateCell($row,
                                               $col,
                                               $inputValue,
                                               $spreadsheetKey,
                                               $worksheetId);
</pre>
<p>
                The new data is placed in the specified cell in the worksheet.
                If the specified cell contains data already, it will be
                overwritten. Note: Use <code>updateCell</code> to change
                the data in a cell, even if the cell is empty.
            </p>
</div>
</div>
</div>
<div class="revinfo"></div>


<!--start of htmlend-->

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->