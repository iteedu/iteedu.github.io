<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<!--end of htmlmiddle-->



<div class="chapter" title="第 41 章 Zend_ProgressBar">
<div class="titlepage"><div><div><h2 class="title">
<a name="zend.progressbar"></a>第 41 章 Zend_ProgressBar</h2></div></div></div>
<div class="toc">
<p><b>目录</b></p>
<dl>
<dt><span class="sect1"><a href="zend.progressbar.html#zend.progressbar.introduction">41.1. Zend_ProgressBar</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="zend.progressbar.html#zend.progressbar.whatisit">41.1.1. Introduction</a></span></dt>
<dt><span class="sect2"><a href="zend.progressbar.html#zend.progressbar.basic">41.1.2. Basic Usage of Zend_Progressbar</a></span></dt>
<dt><span class="sect2"><a href="zend.progressbar.html#zend.progressbar.persistent">41.1.3. Persistent progress</a></span></dt>
<dt><span class="sect2"><a href="zend.progressbar.html#zend.progressbar.adapters">41.1.4. Standard adapters</a></span></dt>
<dd><dl>
<dt><span class="sect3"><a href="zend.progressbar.html#zend.progressbar.adapter.console">41.1.4.1. Zend_ProgressBar_Adapter_Console</a></span></dt>
<dt><span class="sect3"><a href="zend.progressbar.html#zend.progressbar.adapter.jspush">41.1.4.2. Zend_ProgressBar_Adapter_JsPush</a></span></dt>
<dt><span class="sect3"><a href="zend.progressbar.html#zend.progressbar.adapter.jspull">41.1.4.3. Zend_ProgressBar_Adapter_JsPull</a></span></dt>
</dl></dd>
</dl></dd>
</dl>
</div>
<div class="sect1" title="41.1. Zend_ProgressBar">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.progressbar.introduction"></a>41.1. Zend_ProgressBar</h2></div></div></div>
<div class="sect2" title="41.1.1. Introduction">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.progressbar.whatisit"></a>41.1.1. Introduction</h3></div></div></div>
<p>
            <code class="classname">Zend_ProgressBar</code> is a component to create and update
            progressbars in different environments. It consists of a single
            backend, which outputs the progress through one of the multiple
            adapters. On every update, it takes an absolute value and optionally
            a status message, and then calls the adapter with some precalculated
            values like percentage and estimated time left.
        </p>
</div>
<div class="sect2" title="41.1.2. Basic Usage of Zend_Progressbar">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.progressbar.basic"></a>41.1.2. Basic Usage of Zend_Progressbar</h3></div></div></div>
<p>
            <code class="classname">Zend_ProgressBar</code> is quite easy in its usage. You
            simply create a new instance of <code class="classname">Zend_Progressbar</code>, defining a
            min- and a max-value, and choose an adapter to output the data. If
            you want to process a file, you would do something like:
        </p>
<pre class="code">
$progressBar = new Zend_ProgressBar($adapter, 0, $fileSize);

while (!feof($fp)) {
    // Do something

    $progressBar-&gt;update($currentByteCount);
}

$progressBar-&gt;finish();
</pre>
<p>
            In the first step, an instance of <code class="classname">Zend_ProgressBar</code> is
            created, with a specific adapter, a min-value of 0 and a max-value
            of the total filesize. Then a file is processed and in every loop
            the progressbar is updated with the current byte count. At the end
            of the loop, the progressbar status is set to finished.
        </p>
<p>
            You can also call the <code>update()</code> method of
            <code class="classname">Zend_ProgressBar</code> without arguments, which just
            recalculates ETA and notifies the adapter. This is useful when there
            is no data update but you want the progressbar to be updated.
        </p>
</div>
<div class="sect2" title="41.1.3. Persistent progress">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.progressbar.persistent"></a>41.1.3. Persistent progress</h3></div></div></div>
<p>
            If you want the progressbar to be persistent over multiple requests,
            you can give the name of a session namespace as fourth argument
            to the constructor. In that case, the progressbar will not notify
            the adapter within the constructor, but only when you call
            <code>update()</code> or <code>finish()</code>. Also the current
            value, the status text and the start time for ETA calculation will
            be fetched in the next request run again.
        </p>
</div>
<div class="sect2" title="41.1.4. Standard adapters">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.progressbar.adapters"></a>41.1.4. Standard adapters</h3></div></div></div>
<p>
            <code class="classname">Zend_ProgressBar</code> comes with the following three adapters:

            </p>
<div class="itemizedlist"><ul class="itemizedlist" type="opencircle">
<li class="listitem" style="list-style-type: circle"><p><a class="xref" href="zend.progressbar.html#zend.progressbar.adapter.console" title="41.1.4.1. Zend_ProgressBar_Adapter_Console">第 41.1.4.1 节 “Zend_ProgressBar_Adapter_Console”</a></p></li>
<li class="listitem" style="list-style-type: circle"><p><a class="xref" href="zend.progressbar.html#zend.progressbar.adapter.jspush" title="41.1.4.2. Zend_ProgressBar_Adapter_JsPush">第 41.1.4.2 节 “Zend_ProgressBar_Adapter_JsPush”</a></p></li>
<li class="listitem" style="list-style-type: circle"><p><a class="xref" href="zend.progressbar.html#zend.progressbar.adapter.jspull" title="41.1.4.3. Zend_ProgressBar_Adapter_JsPull">第 41.1.4.3 节 “Zend_ProgressBar_Adapter_JsPull”</a></p></li>
</ul></div>
<p>
        </p>
<div class="sect3" title="41.1.4.1. Zend_ProgressBar_Adapter_Console">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.progressbar.adapter.console"></a>41.1.4.1. Zend_ProgressBar_Adapter_Console</h4></div></div></div>
<p>
        <code class="classname">Zend_ProgressBar_Adapter_Console</code> is a text-based adapter
        for terminals. It can automatically detect terminal widths but supports
        custom widths as well. You can define which elements are displayed with
        the progressbar and as well customize the order of them. You can also
        define the style of the progressbar itself.
    </p>
<div class="note" title="Automatic console width recognition"><table border="0" summary="Note: Automatic console width recognition">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">Automatic console width recognition</th>
</tr>
<tr><td align="left" valign="top"><p>
            <code>shell_exec</code> is required for this feature to work on
            *nix based systems. On windows, there is always a fixed terminal
            width of 80 character, so no recognition is required there.
        </p></td></tr>
</table></div>
<p>
        You can set the adapter options either via the <code>set*</code> methods
        or give an array or a <code class="classname">Zend_Config</code> instance with options as first
        parameter to the constructor. The available options are:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                <code>outputStream</code>: A different output-stream, if you don't
                want to stream to STDOUT. Can be any other stream like
                <code>php://stderr</code> or a path to a file.
            </p></li>
<li class="listitem"><p>
                <code>width</code>: Either an integer or the <code>AUTO</code>
                constant of <code class="classname">Zend_Console_ProgressBar</code>.
            </p></li>
<li class="listitem">
<p>
                <code>elements</code>: Either <code class="constant">NULL</code> for default
                or an array with at least one of the following constants
                of <code class="classname">Zend_Console_ProgressBar</code> as value:
            </p>
<div class="itemizedlist"><ul class="itemizedlist" type="circle">
<li class="listitem"><p>
                        <code>ELEMENT_PERCENT</code>: The current value in percent.
                    </p></li>
<li class="listitem"><p>
                        <code>ELEMENT_BAR</code>: The visual bar which display
                        the percentage.
                    </p></li>
<li class="listitem"><p>
                        <code>ELEMENT_ETA</code>: The automatic calculated ETA.
                        This element is firstly displayed after five seconds,
                        because in this time, it is not able to calculate
                        accurate results.
                    </p></li>
<li class="listitem"><p>
                        <code>ELEMENT_TEXT</code>: An optional status message
                        about the current process.
                    </p></li>
</ul></div>
</li>
<li class="listitem"><p>
                <code>textWidth</code>: Width in characters of the
                <code>ELEMENT_TEXT</code> element. Default is 20.
            </p></li>
<li class="listitem"><p>
                <code>charset</code>: Charset of the
                <code>ELEMENT_TEXT</code> element. Default is utf-8.
            </p></li>
<li class="listitem"><p>
                <code>barLeftChar</code>: A string which is used left-hand
                of the indicator in the progressbar.
            </p></li>
<li class="listitem"><p>
                <code>barRightChar</code>: A string which is used right-hand
                of the indicator in the progressbar.
            </p></li>
<li class="listitem"><p>
                <code>barIndicatorChar</code>: A string which is used for
                the indicator in the progressbar. This one can be empty.
            </p></li>
</ul></div>
</div>
<div class="sect3" title="41.1.4.2. Zend_ProgressBar_Adapter_JsPush">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.progressbar.adapter.jspush"></a>41.1.4.2. Zend_ProgressBar_Adapter_JsPush</h4></div></div></div>
<p>
        <code class="classname">Zend_ProgressBar_Adapter_JsPush</code> is an adapter which let's
        you update a progressbar in a browser via Javascript Push. This means
        that no second connection is required to gather the status about a
        running process, but that the process itself sends its status directly
        to the browser.
    </p>
<p>
        You can set the adapter options either via the <code>set*</code> methods
        or give an array or a <code class="classname">Zend_Config</code> instance with options as first
        parameter to the constructor. The available options are:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                <code>updateMethodName</code>: The javascript method which
                should be called on every update. Default value is
                <code class="classname">Zend_ProgressBar_Update</code>.
            </p></li>
<li class="listitem"><p>
                <code>finishMethodName</code>: The javascript method which
                should be called after finish status was set. Default value is
                <code class="constant">NULL</code>, which means nothing is done.
            </p></li>
</ul></div>
<p>
        The usage of this adapter is quite simple. First you create a progressbar
        in your browser, either with JavaScript or previously created with plain
        HTML. Then you define the update method and optionally the finish method
        in JavaScript, both taking a json object as single argument. Then you
        call a webpage with the long-running process in a hidden
        <code>iframe</code> or <code>object</code> tag. While the process is
        running, the adapter will call the update method on every update with
        a json object, containing the following parameters:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                <code>current</code>: The current absolute value
            </p></li>
<li class="listitem"><p>
                <code>max</code>: The max absolute value
            </p></li>
<li class="listitem"><p>
                <code>percent</code>: The calculated percentage
            </p></li>
<li class="listitem"><p>
                <code>timeTaken</code>: The time how long the process ran yet
            </p></li>
<li class="listitem"><p>
                <code>timeRemaining</code>: The expected time for the process to
                finish
            </p></li>
<li class="listitem"><p>
                <code>text</code>: The optional status message, if given
            </p></li>
</ul></div>
<div class="example">
<a name="zend.progressbar-adapter.jspush.example"></a><p class="title"><b>例 41.1. Basic example for the client-side stuff</b></p>
<div class="example-contents">
<p>
            This example illustrates a basic setup of HTML, CSS and JavaScript
            for the JsPush adapter
        </p>
<pre class="code">
&lt;div id="zend-progressbar-container"&gt;
    &lt;div id="zend-progressbar-done"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;iframe src="long-running-process.html" id="long-running-process"&gt;&lt;/iframe&gt;
</pre>
<pre class="code">
#long-running-process {
    position: absolute;
    left: -100px;
    top: -100px;

    width: 1px;
    height: 1px;
}

#zend-progressbar-container {
    width: 100px;
    height: 30px;

    border: 1px solid #000000;
    background-color: #ffffff;
}

#zend-progressbar-done {
    width: 0;
    height: 30px;

    background-color: #000000;
}
</pre>
<pre class="code">
function Zend_ProgressBar_Update(data)
{
    document.getElementById('zend-progressbar-done').style.width = data.percent + '%';
}
</pre>
<p>
            This will create a simple container with a black border and a
            block which indicates the current process. You should not hide
            the <code>iframe</code> or <code>object</code> by <code>display: none;</code>,
            as some browsers like Safari 2 will not load the actual content then.
        </p>
<p>
            Instead of creating your custom progressbar, you may want to use
            one of the available JavaScript libraries like Dojo, jQuery etc.
            For example, there are:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>Dojo: http://dojotoolkit.org/book/dojo-book-0-9/part-2-dijit/user-assistance-and-feedback/progress-bar</p></li>
<li class="listitem"><p>jQuery: http://t.wits.sg/2008/06/20/jquery-progress-bar-11/</p></li>
<li class="listitem"><p>MooTools: http://davidwalsh.name/dw-content/progress-bar.html</p></li>
<li class="listitem"><p>Prototype: http://livepipe.net/control/progressbar</p></li>
</ul></div>
</div>
</div>
<br class="example-break"><div class="note" title="Interval of updates"><table border="0" summary="Note: Interval of updates">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[注意]" src="images/note.png"></td>
<th align="left">Interval of updates</th>
</tr>
<tr><td align="left" valign="top"><p>
            You should take care of not sending too many updates, as every update
            has a min-size of 1kb. This is a requirement for the Safari browser
            to actually render and execute the function call. Internet Explorer
            has a similar limitation of 256 bytes.
        </p></td></tr>
</table></div>
</div>
<div class="sect3" title="41.1.4.3. Zend_ProgressBar_Adapter_JsPull">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.progressbar.adapter.jspull"></a>41.1.4.3. Zend_ProgressBar_Adapter_JsPull</h4></div></div></div>
<p>
        <code class="classname">Zend_ProgressBar_Adapter_JsPull</code> is the opposite of jsPush,
        as it requires to pull for new updates, instead of pushing updates out
        to the browsers. Generally you should use the adapter with the
        persistence option of the <code class="classname">Zend_ProgressBar</code>. On notify,
        the adapter sends a JSON string to the browser, which looks exactly
        like the JSON string which is send by the jsPush adapter. The only
        difference is, that it contains an additional parameter,
        <code>finished</code>, which is either <code class="constant">FALSE</code> when
        <code>update()</code> is called or <code class="constant">TRUE</code>, when
        <code>finish()</code> is called.
    </p>
<p>
        You can set the adapter options either via the <code>set*</code> methods
        or give an array or a <code class="classname">Zend_Config</code> instance with options as first
        parameter to the constructor. The available options are:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
                <code>exitAfterSend</code>: Exits the current request after the
                data were send to the browser. Default is <code class="constant">TRUE</code>.
            </p></li></ul></div>
</div>
</div>
</div>
</div>
<div class="revinfo"></div>


<!--start of htmlend-->

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->