<!--hmt-->
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end --><!--end of htmlheader-->

<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<!--end of htmlmiddle-->



<div class="sect1" title="47.16. Zend_Service_Nirvanix">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.service.nirvanix"></a>47.16. Zend_Service_Nirvanix</h2></div></div></div>
<div class="sect2" title="47.16.1. Introduction">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.nirvanix.introduction"></a>47.16.1. Introduction</h3></div></div></div>
<p>
            Nirvanix provides an Internet Media File System (IMFS), an
            Internet storage service that allows applications to upload, store and
            organize files and subsequently access them using a standard Web
            Services interface. An IMFS is distributed clustered file system,
            accessed over the Internet, and optimized for dealing with media files
            (audio, video, etc). The goal of an IMFS is to provide massive
            scalability to deal with the challenges of media storage growth, with
            guaranteed access and availability regardless of time and location.
            Finally, an IMFS gives applications the ability to access data
            securely, without the large fixed costs associated with acquiring and
            maintaining physical storage assets.
        </p>
</div>
<div class="sect2" title="47.16.2. Registering with Nirvanix">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.nirvanix.registering"></a>47.16.2. Registering with Nirvanix</h3></div></div></div>
<p>
            Before you can get started with <code class="classname">Zend_Service_Nirvanix</code>, you must first
            register for an account. Please see the
            Getting Started
            page on the Nirvanix website for more information.
        </p>
<p>
            After registering, you will receive a Username, Password, and
            Application Key. All three are required to use <code class="classname">Zend_Service_Nirvanix</code>.
        </p>
</div>
<div class="sect2" title="47.16.3. API Documentation">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.nirvanix.apiDocumentation"></a>47.16.3. API Documentation</h3></div></div></div>
<p>
            Access to the Nirvanix IMFS is available through both SOAP and a faster
            REST service. <code class="classname">Zend_Service_Nirvanix</code> provides a
            relatively thin PHP 5 wrapper around the REST service.
        </p>
<p>
            <code class="classname">Zend_Service_Nirvanix</code> aims to make using the Nirvanix REST service
            easier but understanding the service itself is still essential to be successful
            with Nirvanix.
        </p>
<p>
            The Nirvanix API Documentation
            provides an overview as well as detailed information using the
            service. Please familiarize yourself with this document and refer back to it
            as you use <code class="classname">Zend_Service_Nirvanix</code>.
        </p>
</div>
<div class="sect2" title="47.16.4. Features">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.nirvanix.features"></a>47.16.4. Features</h3></div></div></div>
<p>
            Nirvanix's REST service can be used effectively with PHP using the
            SimpleXML
            extension and <code class="classname">Zend_Http_Client</code> alone. However, using it this way
            is somewhat inconvenient due to repetitive operations like passing the
            session token on every request and repeatedly checking the response body for
            error codes.
        </p>
<p>
            <code class="classname">Zend_Service_Nirvanix</code> provides the following functionality:

            </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
                        A single point for configuring your Nirvanix authentication
                        credentials that can be used across the Nirvanix namespaces.
                    </p></li>
<li class="listitem"><p>
                        A proxy object that is more convenient to use than an HTTP client
                        alone, mostly removing the need to manually construct HTTP POST
                        requests to access the REST service.
                    </p></li>
<li class="listitem"><p>
                        A response wrapper that parses each response body and throws an
                        exception if an error occurred, alleviating the need to repeatedly
                        check the success of many commands.
                    </p></li>
<li class="listitem"><p>
                        Additional convenience methods for some of the more common operations.
                    </p></li>
</ul></div>
<p>
        </p>
</div>
<div class="sect2" title="47.16.5. Getting Started">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.nirvanix.storing-your-first"></a>47.16.5. Getting Started</h3></div></div></div>
<p>
            Once you have registered with Nirvanix, you're ready to store your first
            file on the IMFS. The most common operations that you will need to do
            on the IMFS are creating a new file, downloading an existing file, and
            deleting a file. <code class="classname">Zend_Service_Nirvanix</code> provides convenience
            methods for these three operations.
        </p>
<pre class="code">
$auth = array('username' =&gt; 'your-username',
              'password' =&gt; 'your-password',
              'appKey'   =&gt; 'your-app-key');

$nirvanix = new Zend_Service_Nirvanix($auth);
$imfs = $nirvanix-&gt;getService('IMFS');

$imfs-&gt;putContents('/foo.txt', 'contents to store');

echo $imfs-&gt;getContents('/foo.txt');

$imfs-&gt;unlink('/foo.txt');
</pre>
<p>
            The first step to using <code class="classname">Zend_Service_Nirvanix</code> is always
            to authenticate against the service. This is done by passing your
            credentials to the <code class="classname">Zend_Service_Nirvanix</code> constructor
            above. The associative array is passed directly to Nirvanix as POST
            parameters.
        </p>
<p>
            Nirvanix divides its web services into
            namespaces.
            Each namespace encapsulates a group of related operations. After getting
            an instance of <code class="classname">Zend_Service_Nirvanix</code>, call the
            <code>getService()</code> method to create a proxy for the namespace
            you want to use. Above, a proxy for the <code>IMFS</code> namespace is created.
        </p>
<p>
            After you have a proxy for the namespace you want to use, call methods on it.
            The proxy will allow you to use any command available on the REST API. The
            proxy may also make convenience methods available, which wrap web service
            commands. The example above shows using the IMFS convenience methods to create a
            new file, retrieve and display that file, and finally delete the file.
        </p>
</div>
<div class="sect2" title="47.16.6. Understanding the Proxy">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.nirvanix.understanding-proxy"></a>47.16.6. Understanding the Proxy</h3></div></div></div>
<p>
            In the previous example, we used the <code>getService()</code> method to return
            a proxy object to the <code>IMFS</code> namespace. The proxy object allows
            you to use the Nirvanix REST service in a way that's closer to making a normal
            PHP method call, as opposed to constructing your own HTTP request objects.
        </p>
<p>
            A proxy object may provide convenience methods. These are methods that the
            <code class="classname">Zend_Service_Nirvanix</code> provides to simplify the use of
            the Nirvanix web services. In the previous example, the methods
            <code>putContents()</code>, <code>getContents()</code>, and <code>unlink()</code>
            do not have direct equivalents in the REST API. They are convenience methods
            provided by <code class="classname">Zend_Service_Nirvanix</code> that abstract more complicated
            operations on the REST API.
        </p>
<p>
            For all other method calls to the proxy object, the proxy will dynamically
            convert the method call to the equivalent HTTP POST request to the REST API.
            It does this by using the method name as the API command, and an associative
            array in the first argument as the POST parameters.
        </p>
<p>
            Let's say you want to call the REST API method
            RenameFile,
            which does not have a convenience method in <code class="classname">Zend_Service_Nirvanix</code>:
        </p>
<pre class="code">
$auth = array('username' =&gt; 'your-username',
              'password' =&gt; 'your-password',
              'appKey'   =&gt; 'your-app-key');

$nirvanix = new Zend_Service_Nirvanix($auth);
$imfs = $nirvanix-&gt;getService('IMFS');

$result = $imfs-&gt;renameFile(array('filePath' =&gt; '/path/to/foo.txt',
                                  'newFileName' =&gt; 'bar.txt'));
</pre>
<p>
            Above, a proxy for the <code>IMFS</code> namespace is created. A method,
            <code>renameFile()</code>, is then called on the proxy. This method does not
            exist as a convenience method in the PHP code, so it is trapped by
            <code>__call()</code> and converted into a POST request to the REST API where
            the associative array is used as the POST parameters.
        </p>
<p>
            Notice in the Nirvanix API documentation that <code>sessionToken</code> is required
            for this method but we did not give it to the proxy object. It is added
            automatically for your convenience.
        </p>
<p>
            The result of this operation will either be a <code class="classname">Zend_Service_Nirvanix_Response</code>
            object wrapping the XML returned by Nirvanix, or a <code class="classname">Zend_Service_Nirvanix_Exception</code>
            if an error occurred.
        </p>
</div>
<div class="sect2" title="47.16.7. Examining Results">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.nirvanix.examining-results"></a>47.16.7. Examining Results</h3></div></div></div>
<p>
            The Nirvanix REST API always returns its results in XML. <code class="classname">Zend_Service_Nirvanix</code>
            parses this XML with the <code>SimpleXML</code> extension and then decorates
            the resulting <code>SimpleXMLElement</code> with a <code class="classname">Zend_Service_Nirvanix_Response</code>
            object.
        </p>
<p>
            The simplest way to examine a result from the service is to use the
            built-in PHP functions like <code>print_r()</code>:
        </p>
<pre class="code">
&lt;?php
$auth = array('username' =&gt; 'your-username',
              'password' =&gt; 'your-password',
              'appKey'   =&gt; 'your-app-key');

$nirvanix = new Zend_Service_Nirvanix($auth);
$imfs = $nirvanix-&gt;getService('IMFS');

$result = $imfs-&gt;putContents('/foo.txt', 'fourteen bytes');
print_r($result);
?&gt;

Zend_Service_Nirvanix_Response Object
(
    [_sxml:protected] =&gt; SimpleXMLElement Object
        (
            [ResponseCode] =&gt; 0
            [FilesUploaded] =&gt; 1
            [BytesUploaded] =&gt; 14
        )
)
</pre>
<p>
            You can access any property or method of the decorated <code>SimpleXMLElement</code>.
            In the above example, <code>$result-&gt;BytesUploaded</code> could be used to see the
            number of bytes received. Should you want to access the <code>SimpleXMLElement</code>
            directly, just use <code>$result-&gt;getSxml()</code>.
        </p>
<p>
            The most common response from Nirvanix is success (<code>ResponseCode</code> of zero).
            It is not normally necessary to check <code>ResponseCode</code> because any non-zero
            result will throw a <code class="classname">Zend_Service_Nirvanix_Exception</code>. See the next
            section on handling errors.
        </p>
</div>
<div class="sect2" title="47.16.8. Handling Errors">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.nirvanix.handling-errors"></a>47.16.8. Handling Errors</h3></div></div></div>
<p>
            When using Nirvanix, it's important to anticipate errors that can be returned
            by the service and handle them appropriately.
        </p>
<p>
            All operations against the REST service result in an XML return payload that
            contains a <code>ResponseCode</code> element, such as the following example:
        </p>
<pre class="code">
&lt;Response&gt;
   &lt;ResponseCode&gt;0&lt;/ResponseCode&gt;
&lt;/Response&gt;
</pre>
<p>
            When the <code>ResponseCode</code> is zero such as in the example
            above, the operation was successful. When the operation is not
            successful, the <code>ResponseCode</code> is non-zero and an
            <code>ErrorMessage</code> element should be present.
        </p>
<p>
            To alleviate the need to repeatedly check if the <code>ResponseCode</code>
            is non-zero, <code class="classname">Zend_Service_Nirvanix</code> automatically checks each response
            returned by Nirvanix. If the <code>ResponseCode</code> indicates an
            error, a <code class="classname">Zend_Service_Nirvanix_Exception</code> will be thrown.
        </p>
<pre class="code">
$auth = array('username' =&gt; 'your-username',
              'password' =&gt; 'your-password',
              'appKey'   =&gt; 'your-app-key');
$nirvanix = new Zend_Service_Nirvanix($auth);

try {

  $imfs = $nirvanix-&gt;getService('IMFS');
  $imfs-&gt;unlink('/a-nonexistant-path');

} catch (Zend_Service_Nirvanix_Exception $e) {
  echo $e-&gt;getMessage() . "\n";
  echo $e-&gt;getCode();
}
</pre>
<p>
            In the example above, <code>unlink()</code> is a convenience method that wraps the
            <code>DeleteFiles</code> command on the REST API. The <code>filePath</code> parameter required by the
            DeleteFiles
            command contains a path that does not exist. This will result in a
            <code class="classname">Zend_Service_Nirvanix</code> exception being thrown with the message
            "Invalid path" and code 70005.
        </p>
<p>
            The Nirvanix
            API Documentation describes the errors associated with each command. Depending
            on your needs, you may wrap each command in a <code>try</code> block or
            wrap many commands in the same <code>try</code> block for convenience.
        </p>
</div>
</div>
<div class="revinfo"></div>


<!--start of htmlend-->

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->