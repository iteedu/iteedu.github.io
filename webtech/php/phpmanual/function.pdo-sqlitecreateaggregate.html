
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD COLSPAN="3"><DIV CLASS="NAVHEADER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR><TD><TABLE  SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TH  COLSPAN="3" ALIGN="center">PHP 手册</TH></TR><TR><TD  WIDTH="10%" ALIGN="left" VALIGN="bottom"><A  HREF="ref.pdo-sqlite.connection.html" ACCESSKEY="P">后退</A></TD><TD  WIDTH="80%" ALIGN="center" VALIGN="bottom"></TD><TD  WIDTH="10%" ALIGN="right" VALIGN="bottom"><A  HREF="function.pdo-sqlitecreatefunction.html" ACCESSKEY="N">前进</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR></TABLE></DIV></TD></TR><TR><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><BR><H1><A  NAME="function.PDO-sqliteCreateAggregate"></A>PDO::sqliteCreateAggregate</H1><DIV  CLASS="refnamediv"><A  NAME="AEN158369"></A><P>    (no version information, might be only in CVS)</P>PDO::sqliteCreateAggregate&nbsp;--&nbsp;
   Registers an aggregating User Defined Function for use in SQL statements
  </DIV><DIV  CLASS="refsect1"><A  NAME="AEN158372"></A><H2>说明</H2>bool <B  CLASS="methodname">PDO::sqliteCreateAggregate</B> ( string function_name, callback step_func, callback finalize_func [, int num_args] )<BR></BR><DIV  CLASS="warning"><P></P><TABLE  CLASS="warning" BORDER="1" WIDTH="100%"><TR><TD  ALIGN="CENTER"><B>警告</B></TD></TR><TR><TD  ALIGN="LEFT"><P>本函数是<SPAN  CLASS="emphasis"><I  CLASS="emphasis">实验性</I></SPAN>的。本函数的行为，包括函数名称以及其它任何关于本函数的文档可能会在没有通知的情况下随
PHP 以后的发布而改变。使用本函数风险自担。</P></TD></TR></TABLE></DIV><P>&#13;   <B  CLASS="function">PDO::sqliteCreateAggregate()</B> is similar to
   <B  CLASS="function">PDO::sqliteCreateFunction()</B> except that it registers
   functions that can be used to calculate a result aggregated across all the
   rows of a query.
  </P><P>&#13;   The key difference between this function and
   <B  CLASS="function">PDO::sqliteCreateFunction()</B> is that two functions are
   required to manage the aggregate; <VAR  CLASS="parameter">step_func</VAR> is
   called for each row of the result set.  Your PHP function should
   accumulate the result and store it into the aggregation context.
   Once all the rows have been processed,
   <VAR  CLASS="parameter">finalize_func</VAR> will be called and it should then
   take the data from the aggregation context and return the result.
   Callback functions should return a type understood by SQLite (i.e.
   <A  HREF="language/language.types.html#language.types.intro">scalar type</A>).
  </P></DIV><DIV  CLASS="refsect1"><A  NAME="AEN158400"></A><H2>参数</H2><P>&#13;   <P></P><DIV  CLASS="variablelist"><DL><DT><VAR  CLASS="parameter">function_name</VAR></DT><DD><P>&#13;       The name of the function used in SQL statements.
      </P></DD><DT><VAR  CLASS="parameter">step_func</VAR></DT><DD><P>&#13;       Callback function called for each row of the result set.
      </P></DD><DT><VAR  CLASS="parameter">finalize_func</VAR></DT><DD><P>&#13;       Callback function to aggregate the "stepped" data from each row.
      </P></DD><DT><VAR  CLASS="parameter">num_args</VAR></DT><DD><P>&#13;       Hint to the SQLite parser if the callback function accepts a
       predetermined number of arguments.
      </P></DD></DL></DIV>
  </P></DIV><DIV  CLASS="refsect1"><A  NAME="AEN158424"></A><H2>范例</H2><P>&#13;   <TABLE  WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV  CLASS="example"><A  NAME="AEN158427"></A><P><B>例子 1. max_length aggregation function example</B></P><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font  color="#000000">
<font  color="#0000BB">&lt;?php<br  />$data </font><font  color="#007700">= array(<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'one'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'two'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'three'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'four'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'five'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'six'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'seven'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'eight'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'nine'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;</font><font  color="#DD0000">'ten'</font><font  color="#007700">,<br  />&nbsp;&nbsp;&nbsp;);<br  /></font><font  color="#0000BB">$db </font><font  color="#007700">= new </font><font  color="#0000BB">PDO</font><font  color="#007700">(</font><font  color="#DD0000">'sqlite::memory:'</font><font  color="#007700">);<br  /></font><font  color="#0000BB">$db</font><font  color="#007700">-&gt;</font><font  color="#0000BB">exec</font><font  color="#007700">(</font><font  color="#DD0000">"CREATE TABLE strings(a)"</font><font  color="#007700">);<br  /></font><font  color="#0000BB">$insert </font><font  color="#007700">= </font><font  color="#0000BB">$db</font><font  color="#007700">-&gt;</font><font  color="#0000BB">prepare</font><font  color="#007700">(</font><font  color="#DD0000">'INSERT INTO strings VALUES (?)'</font><font  color="#007700">);<br  />foreach (</font><font  color="#0000BB">$data </font><font  color="#007700">as </font><font  color="#0000BB">$str</font><font  color="#007700">) {<br  />&nbsp;&nbsp;&nbsp;&nbsp;</font><font  color="#0000BB">$insert</font><font  color="#007700">-&gt;</font><font  color="#0000BB">execute</font><font  color="#007700">(array(</font><font  color="#0000BB">$str</font><font  color="#007700">));<br  />}<br  /></font><font  color="#0000BB">$insert </font><font  color="#007700">= </font><font  color="#0000BB">null</font><font  color="#007700">;<br  /><br  />function </font><font  color="#0000BB">max_len_step</font><font  color="#007700">(&amp;</font><font  color="#0000BB">$context</font><font  color="#007700">, </font><font  color="#0000BB">$string</font><font  color="#007700">) <br  />{<br  />&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font  color="#0000BB">strlen</font><font  color="#007700">(</font><font  color="#0000BB">$string</font><font  color="#007700">) &gt; </font><font  color="#0000BB">$context</font><font  color="#007700">) {<br  />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font  color="#0000BB">$context </font><font  color="#007700">= </font><font  color="#0000BB">strlen</font><font  color="#007700">(</font><font  color="#0000BB">$string</font><font  color="#007700">);<br  />&nbsp;&nbsp;&nbsp;&nbsp;}<br  />}<br  /><br  />function </font><font  color="#0000BB">max_len_finalize</font><font  color="#007700">(&amp;</font><font  color="#0000BB">$context</font><font  color="#007700">) <br  />{<br  />&nbsp;&nbsp;&nbsp;&nbsp;return </font><font  color="#0000BB">$context</font><font  color="#007700">;<br  />}<br  /><br  /></font><font  color="#0000BB">$db</font><font  color="#007700">-&gt;</font><font  color="#0000BB">sqliteCreateAggregate</font><font  color="#007700">(</font><font  color="#DD0000">'max_len'</font><font  color="#007700">, </font><font  color="#DD0000">'max_len_step'</font><font  color="#007700">, </font><font  color="#DD0000">'max_len_finalize'</font><font  color="#007700">);<br  /><br  /></font><font  color="#0000BB">var_dump</font><font  color="#007700">(</font><font  color="#0000BB">$db</font><font  color="#007700">-&gt;</font><font  color="#0000BB">query</font><font  color="#007700">(</font><font  color="#DD0000">'SELECT max_len(a) from strings'</font><font  color="#007700">)-&gt;</font><font  color="#0000BB">fetchAll</font><font  color="#007700">());<br  /><br  /></font><font  color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE></DIV></TD></TR></TABLE>
  </P><P>&#13;   In this example, we are creating an aggregating function that will
   calculate the length of the longest string in one of the columns of the
   table.  For each row, the <VAR  CLASS="literal">max_len_step</VAR> function is
   called and passed a <VAR  CLASS="parameter">context</VAR> parameter.  The context
   parameter is just like any other PHP variable and be set to hold an array
   or even an object value.  In this example, we are simply using it to hold
   the maximum length we have seen so far; if the
   <VAR  CLASS="parameter">string</VAR> has a length longer than the current
   maximum, we update the context to hold this new maximum length.
  </P><P>&#13;   After all of the rows have been processed, SQLite calls the
   <VAR  CLASS="literal">max_len_finalize</VAR> function to determine the aggregate
   result.  Here, we could perform some kind of calculation based on the
   data found in the <VAR  CLASS="parameter">context</VAR>.  In our simple example
   though, we have been calculating the result as the query progressed, so we
   simply need to return the context value.
  </P><DIV  CLASS="tip"><BLOCKQUOTE  CLASS="tip"><P><B>提示: </B>
    It is NOT recommended for you to store a copy of the values in the context
    and then process them at the end, as you would cause SQLite to use a lot of
    memory to process the query - just think of how much memory you would need
    if a million rows were stored in memory, each containing a string 32 bytes
    in length.
   </P></BLOCKQUOTE></DIV><DIV  CLASS="tip"><BLOCKQUOTE  CLASS="tip"><P><B>提示: </B>
    You can use <B  CLASS="function">PDO::sqliteCreateFunction()</B> and
    <B  CLASS="function">PDO::sqliteCreateAggregate()</B> to override SQLite native
    SQL functions.
   </P></BLOCKQUOTE></DIV><DIV  CLASS="note"><BLOCKQUOTE  CLASS="note"><P><B>注: </B>
    This method is not available with the SQLite2 driver.
    Use the old style sqlite API for that instead.
   </P></BLOCKQUOTE></DIV></DIV><DIV  CLASS="refsect1"><A  NAME="AEN158445"></A><H2>参见</H2><P>&#13;   <P></P><TABLE  BORDER="0"><TBODY><TR><TD><B  CLASS="function">PDO::sqliteCreateFunction()</B></TD></TR><TR><TD><A  HREF="function.sqlite-create-function.html"><B  CLASS="function">sqlite_create_function()</B></A></TD></TR><TR><TD><A  HREF="function.sqlite-create-aggregate.html"><B  CLASS="function">sqlite_create_aggregate()</B></A></TD></TR></TBODY></TABLE><P></P>
  </P></DIV><BR></TD><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3"><DIV CLASS="NAVFOOTER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR><TR><TD><TABLE  SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TD  WIDTH="33%" ALIGN="left" VALIGN="top"><A  HREF="ref.pdo-sqlite.connection.html" ACCESSKEY="P">后退</A></TD><TD  WIDTH="34%" ALIGN="center" VALIGN="top"><A  HREF="index.html" ACCESSKEY="H">起点</A></TD><TD  WIDTH="33%" ALIGN="right" VALIGN="top"><A  HREF="function.pdo-sqlitecreatefunction.html" ACCESSKEY="N">前进</A></TD></TR><TR><TD  WIDTH="33%" ALIGN="left" VALIGN="top">PDO_SQLITE DSN</TD><TD  WIDTH="34%" ALIGN="center" VALIGN="top"><A  HREF="ref.pdo-sqlite.html" ACCESSKEY="U">上一级</A></TD><TD  WIDTH="33%" ALIGN="right" VALIGN="top">PDO::sqliteCreateFunction</TD></TR></TABLE></TD></TR></TABLE></DIV></TD></TR></TABLE>

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->
