
<!-- header-start -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="/include/js/jquery.min.js" language="javascript"></script>
<script src="/include/js/jquery-ui.min.js" language="javascript"></script>
<link href="/include/css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
<link href="/include/css/main.css" rel="stylesheet" type="text/css" />

<SCRIPT>
	$(document).ready(function() {
		$( "#menu" ).menu({ position: { my: "left top", at: "right-100 top+35" } });
	});
</SCRIPT>

<!-- header-end -->
<!-- middle-start -->
﻿
<base target="_blank" />
</head>
<body>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https'){
   bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- topmenu-start -->
<header>
    <section id="global-nav">
        <nav>
            <ul class="projects">
                    <li><a href="/">ITeedu.com</a></li>
            </ul>
            <ul class="links">
                    <li><a>快捷导航</a>
                        <ul>
                            <li><a href="/plang/">编程语言</a></li>
                            <li><a href="/webtech/">WEB开发</a></li>
                            <li><a href="/handset/">手机开发</a></li>
                            <li><a href="/database/">数据库</a></li>
                            <li><a href="/os/">操作系统</a></li>
                            <li><a href="/embed/">嵌入式</a></li>
                            <li><a href="/opensource/">开源软件</a></li>
                            <li><a href="/works/">作品</a></li>

                        </ul>
                    </li>
                    <li><a href="/plang/asm/">编辑语言</a>
                        <ul>
                                <li><a href="/plang/asm/">汇编</a></li>
                                <li><a href="/plang/ccpp/">C/C++</a> </li>
                                <li><a href="/plang/java/">JAVA</a> </li>
                                <li><a href="/plang/python/">Python</a> </li>
                                <li><a href="/plang/ruby/">Ruby</a></li>
                        </ul>
                    </li>
                    <li><a href="/webtech/">WEB开发</a>
                        <ul>
                            <li><a href="/webtech/javascript/">javascript</a> </li>
                            <li><a href="/webtech/j2ee/">J2EE</a> </li>
                            <li><a href="/webtech/php/">PHP</a> </li>
                            <li><a href="/webtech/python/djangocn2/">Django</a> </li>
                        </ul>
                    </li>
					<li><a href="/me/contactme.htm">关于</a></li>
            </ul>
        </nav>
    </section>
</header>
<!-- topmenu-end -->

<div id="container" style="margin: 35px 120px 0px 120px;">
	<div id="logo-wapper">
		<div style="float:left;width:150px;" ><h1 class="logo">ITEEDU</h1></div>
		<div style="float:right;width:760px">

		</div>
		<div style="clear:both;"></div>
	</div>
<nav id="main-nav">
<!-- menunav-start -->
<div id="menu">
    <li><a href="/plang/">编程语言</a>
        <ul>
            <LI><a href="/plang/asm/">汇编</a></LI>
            <LI><a href="/plang/ccpp/">C/C++</a> </LI>
            <LI><a href="/plang/java/">JAVA</a> </LI>
            <LI><a href="/plang/python/">Python</a> </LI>
            <LI><a href="/plang/ruby/">Ruby</a></LI>
        </ul>
    </li>
    <li><a href="/webtech/index.php">WEB开发</a>
        <ul>
            <LI><a href="/webtech/j2ee/">J2EE</a></LI>
            <LI><a href="/webtech/php/">PHP</a> </LI>
            <LI><a href="/webtech/python/djangocn2/">djangocn2</a> </LI>
        </ul>
    </li>
    <li><a href="/handset/index.php">手机开发</a>
        <ul>
            <LI><a href="/handset/android/">android</a></LI>
            <LI><a href="/handset/iphone/">iphone</a> </LI>
        </ul>
    </li>
    <li><a href="/database/index.php">数据库</a>
        <ul>
            <LI><a href="/database/mysql/">MYSQL</a></LI>
            <LI><a href="/database/sqlite/">sqlite</a></LI>
    	</ul>
    </li>
    <li><a href="/os/">操作系统</a>
        <ul>
        	<LI><a href="/os/linux/">Linux</a></LI>
        	<LI><a href="/os/grub/">GRUB</a></LI>
    	</ul>
     </li>
     <li><a href="/embed/">嵌入式</a></li>
     <li><a href="/opensource/">开源软件</a></li>
</div>
<!-- menunav-end -->
</nav>
<div id="content-wrapper">
<div id="file-wrapper">


<!-- middle-end -->
<TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD COLSPAN="3"><DIV CLASS="NAVHEADER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR><TD><TABLE  SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TH  COLSPAN="3" ALIGN="center">PHP 手册</TH></TR><TR><TD  WIDTH="10%" ALIGN="left" VALIGN="bottom"><A  HREF="ref.runkit.html" ACCESSKEY="P">后退</A></TD><TD  WIDTH="80%" ALIGN="center" VALIGN="bottom"></TD><TD  WIDTH="10%" ALIGN="right" VALIGN="bottom"><A  HREF="function.runkit-class-adopt.html" ACCESSKEY="N">前进</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR></TABLE></DIV></TD></TR><TR><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><BR><H1><A  NAME="runkit.sandbox"></A>Runkit_Sandbox</H1><DIV  CLASS="refnamediv"><A  NAME="AEN141651"></A><P>    (no version information, might be only in CVS)</P>Runkit_Sandbox&nbsp;--&nbsp;
   Runkit Sandbox Class -- PHP Virtual Machine
  </DIV><DIV  CLASS="refsect1"><A  NAME="AEN141654"></A><H2>说明</H2><P>&#13;   Instantiating the <B  CLASS="classname">Runkit_Sandbox</B>
   class creates a new thread with its own scope
   and program stack.  Using a set of options passed to the constructor, this environment
   may be restricted to a subset of what the primary interpreter can do and provide a
   safer environment for executing user supplied code.
  </P><DIV  CLASS="note"><BLOCKQUOTE  CLASS="note"><P><B>注: </B>对沙盒的支持（是函数
<A  HREF="function.runkit-lint.html"><B  CLASS="function">runkit_lint()</B></A>、<A  HREF="function.runkit-lint-file.html"><B  CLASS="function">runkit_lint_file()</B></A>
和 Runkit_Sandbox 类所必须的）仅在 PHP 5.1 中，或在加过特别补丁的 PHP 5.0
中，并需要启用线程安全。请阅读 runkit 包中的 README 文件以了解更多信息。
</P></BLOCKQUOTE></DIV></DIV><DIV  CLASS="refsect1"><A  NAME="AEN141662"></A><H2>Constructor</H2>void <B  CLASS="methodname">Runkit_Sandbox::__construct</B> ( [array options] )<BR></BR><P>&#13;   <VAR  CLASS="parameter">options</VAR> is an associative array containing
   any combination of the special ini options listed below.
  </P><P>&#13;   <P></P><DIV  CLASS="variablelist"><DL><DT><VAR  CLASS="parameter">safe_mode</VAR></DT><DD><P>&#13;       If the outer script which is instantiating the
       <B  CLASS="classname">Runkit_Sandbox</B> class
       is configured with <VAR  CLASS="literal">safe_mode = off</VAR>, then safe_mode
       may be turned on for the sandbox environment.  This setting can not
       be used to disable <VAR  CLASS="literal">safe_mode</VAR> when it's already
       enabled in the outer script.
      </P></DD><DT><VAR  CLASS="parameter">safe_mode_gid</VAR></DT><DD><P>&#13;       If the outer script which is instantiating the
       <B  CLASS="classname">Runkit_Sandbox</B> class
       is configured with <VAR  CLASS="literal">safe_mode_gid = on</VAR>, then safe_mode_gid
       may be turned off for the sandbox environment.  This setting can not
       be used to enable <VAR  CLASS="literal">safe_mode_gid</VAR> when it's already
       disabled in the outer script.
      </P></DD><DT><VAR  CLASS="parameter">safe_mode_include_dir</VAR></DT><DD><P>&#13;       If the outer script which is instantiating the
       <B  CLASS="classname">Runkit_Sandbox</B> class
       is configured with a <VAR  CLASS="literal">safe_mode_include_dir</VAR>,
       then a new safe_mode_include_dir may be set for sandbox environments
       below the currently defined value.  safe_mode_include_dir may also be
       cleared to indicate that the bypass feature is disabled.
       If safe_mode_include_dir was blank in the outer script, but safe_mode
       was not enabled, then any arbitrary safe_mode_include_dir may be set
       while turning safe_mode on.
      </P></DD><DT><VAR  CLASS="parameter">open_basedir</VAR></DT><DD><P>&#13;       <VAR  CLASS="parameter">open_basedir</VAR> may be set to any path below the
       current setting of <VAR  CLASS="literal">open_basedir</VAR>. If
       <VAR  CLASS="literal">open_basedir</VAR> is not set within the global scope,
       then it is assumed to be the root directory and may be set to any location.
      </P></DD><DT><VAR  CLASS="parameter">allow_url_fopen</VAR></DT><DD><P>&#13;       Like <VAR  CLASS="parameter">safe_mode</VAR>, this setting can only be made more restrictive,
       in this case by setting it to <TT  CLASS="constant"><B>FALSE</B></TT> when it is previously set to <TT  CLASS="constant"><B>TRUE</B></TT>
      </P></DD><DT><VAR  CLASS="parameter">disable_functions</VAR></DT><DD><P>&#13;       Comma separated list of functions to disable within the sandbox sub-interpreter.
       This list need not contain the names of the currently disabled functions,
       they will remain disabled whether listed here or not.
      </P></DD><DT><VAR  CLASS="parameter">disable_classes</VAR></DT><DD><P>&#13;       Comma separated list of classes to disable within the sandbox sub-interpreter.
       This list need not contain the names of the currently disabled classes,
       they will remain disabled whether listed here or not.
      </P></DD><DT><VAR  CLASS="parameter">runkit.superglobal</VAR></DT><DD><P>&#13;       Comma separated list of variables to be treated as superglobals within the
       sandbox sub-interpreter.  These variables will be used in addition to any
       variables defined internally or through the global runkit.superglobal setting.
      </P></DD></DL></DIV>
  </P><TABLE  WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV  CLASS="example"><A  NAME="AEN141728"></A><P><B>例子 1. Instantiating a restricted sandbox</B></P><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font  color="#000000">
<font  color="#0000BB">&lt;?php<br  />$options </font><font  color="#007700">= array(<br  />&nbsp;&nbsp;</font><font  color="#DD0000">'safe_mode'</font><font  color="#007700">=&gt;</font><font  color="#0000BB">true</font><font  color="#007700">,<br  />&nbsp;&nbsp;</font><font  color="#DD0000">'open_basedir'</font><font  color="#007700">=&gt;</font><font  color="#DD0000">'/var/www/users/jdoe/'</font><font  color="#007700">,<br  />&nbsp;&nbsp;</font><font  color="#DD0000">'allow_url_fopen'</font><font  color="#007700">=&gt;</font><font  color="#DD0000">'false'</font><font  color="#007700">,<br  />&nbsp;&nbsp;</font><font  color="#DD0000">'disable_functions'</font><font  color="#007700">=&gt;</font><font  color="#DD0000">'exec,shell_exec,passthru,system'</font><font  color="#007700">,<br  />&nbsp;&nbsp;</font><font  color="#DD0000">'disable_classes'</font><font  color="#007700">=&gt;</font><font  color="#DD0000">'myAppClass'</font><font  color="#007700">);<br  /></font><font  color="#0000BB">$sandbox </font><font  color="#007700">= new </font><font  color="#0000BB">Runkit_Sandbox</font><font  color="#007700">(</font><font  color="#0000BB">$options</font><font  color="#007700">);<br  /></font><font  color="#FF8000">/* Non-protected ini settings may set normally */<br  /></font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">ini_set</font><font  color="#007700">(</font><font  color="#DD0000">'html_errors'</font><font  color="#007700">,</font><font  color="#0000BB">true</font><font  color="#007700">);<br  /></font><font  color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE></DIV></TD></TR></TABLE></DIV><DIV  CLASS="refsect1"><A  NAME="AEN141731"></A><H2>Accessing Variables</H2><P>&#13;   All variables in the global scope of the sandbox environment
   are accessible as properties of the sandbox object.
   The first thing to note is that because of the way memory
   between these two threads is managed, object and resource
   variables can not currently be exchanged between interpreters.
   Additionally, all arrays are deep copied and any references
   will be lost.  This also means that references between
   interpreters are not possible.
  </P><TABLE  WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV  CLASS="example"><A  NAME="AEN141734"></A><P><B>例子 2. Working with variables in a sandbox</B></P><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font  color="#000000">
<font  color="#0000BB">&lt;?php<br  />$sandbox </font><font  color="#007700">= new </font><font  color="#0000BB">Runkit_Sandbox</font><font  color="#007700">();<br  /><br  /></font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">foo </font><font  color="#007700">= </font><font  color="#DD0000">'bar'</font><font  color="#007700">;<br  /></font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">eval</font><font  color="#007700">(</font><font  color="#DD0000">'echo "$foo\n"; $bar = $foo . "baz";'</font><font  color="#007700">);<br  />echo </font><font  color="#DD0000">"</font><font  color="#007700">{</font><font  color="#DD0000">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#DD0000">bar</font><font  color="#007700">}\n</font><font  color="#DD0000">"</font><font  color="#007700">;<br  />if (isset(</font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">foo</font><font  color="#007700">)) unset(</font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">foo</font><font  color="#007700">);<br  /></font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">eval</font><font  color="#007700">(</font><font  color="#DD0000">'var_dump(isset($foo));'</font><font  color="#007700">);<br  /></font><font  color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE></DIV></TD></TR></TABLE><P>上例将输出：</P><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE  CLASS="screen">bar
barbaz
bool(false)</PRE></TD></TR></TABLE></DIV><DIV  CLASS="refsect1"><A  NAME="AEN141739"></A><H2>Calling PHP Functions</H2><P>&#13;   Any function defined within the sandbox may be called as
   a method on the sandbox object.  This also includes a few
   pseudo-function language constructs:  <A  HREF="function.eval.html"><B  CLASS="function">eval()</B></A>,
   <A  HREF="function.include.html"><B  CLASS="function">include()</B></A>, <A  HREF="function.include-once.html"><B  CLASS="function">include_once()</B></A>,
   <A  HREF="function.require.html"><B  CLASS="function">require()</B></A>, <A  HREF="function.require-once.html"><B  CLASS="function">require_once()</B></A>,
   <A  HREF="function.echo.html"><B  CLASS="function">echo()</B></A>, <A  HREF="function.print.html"><B  CLASS="function">print()</B></A>,
   <A  HREF="function.die.html"><B  CLASS="function">die()</B></A>, and <A  HREF="function.exit.html"><B  CLASS="function">exit()</B></A>.
  </P><TABLE  WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV  CLASS="example"><A  NAME="AEN141751"></A><P><B>例子 3. Calling sandbox functions</B></P><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font  color="#000000">
<font  color="#0000BB">&lt;?php<br  />$sandbox </font><font  color="#007700">= new </font><font  color="#0000BB">Runkit_Sandbox</font><font  color="#007700">();<br  /><br  />echo </font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">str_replace</font><font  color="#007700">(</font><font  color="#DD0000">'a'</font><font  color="#007700">,</font><font  color="#DD0000">'f'</font><font  color="#007700">,</font><font  color="#DD0000">'abc'</font><font  color="#007700">);<br  /></font><font  color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE></DIV></TD></TR></TABLE><P>上例将输出：</P><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE  CLASS="screen">fbc</PRE></TD></TR></TABLE><P>&#13;   When passing arguments to a sandbox function, the arguments
   are taken from the outer instance of PHP.  If you wish to pass
   arguments from the sandbox's scope, be sure to access them as
   properties of the sandbox object as illustrated above.
  </P><TABLE  WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV  CLASS="example"><A  NAME="AEN141757"></A><P><B>例子 4. Passing arguments to sandbox functions</B></P><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font  color="#000000">
<font  color="#0000BB">&lt;?php<br  />$sandbox </font><font  color="#007700">= new </font><font  color="#0000BB">Runkit_Sandbox</font><font  color="#007700">();<br  /><br  /></font><font  color="#0000BB">$foo </font><font  color="#007700">= </font><font  color="#DD0000">'bar'</font><font  color="#007700">;<br  /></font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">foo </font><font  color="#007700">= </font><font  color="#DD0000">'baz'</font><font  color="#007700">;<br  />echo </font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">str_replace</font><font  color="#007700">(</font><font  color="#DD0000">'a'</font><font  color="#007700">,</font><font  color="#0000BB">$foo</font><font  color="#007700">,</font><font  color="#DD0000">'a'</font><font  color="#007700">);<br  />echo </font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">str_replace</font><font  color="#007700">(</font><font  color="#DD0000">'a'</font><font  color="#007700">,</font><font  color="#0000BB">$sandbox</font><font  color="#007700">-&gt;</font><font  color="#0000BB">foo</font><font  color="#007700">,</font><font  color="#DD0000">'a'</font><font  color="#007700">);<br  /></font><font  color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE></DIV></TD></TR></TABLE><P>上例将输出：</P><TABLE  BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE  CLASS="screen">bar
baz</PRE></TD></TR></TABLE></DIV><BR></TD><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3"><DIV CLASS="NAVFOOTER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR><TR><TD><TABLE  SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TD  WIDTH="33%" ALIGN="left" VALIGN="top"><A  HREF="ref.runkit.html" ACCESSKEY="P">后退</A></TD><TD  WIDTH="34%" ALIGN="center" VALIGN="top"><A  HREF="index.html" ACCESSKEY="H">起点</A></TD><TD  WIDTH="33%" ALIGN="right" VALIGN="top"><A  HREF="function.runkit-class-adopt.html" ACCESSKEY="N">前进</A></TD></TR><TR><TD  WIDTH="33%" ALIGN="left" VALIGN="top">runkit Functions</TD><TD  WIDTH="34%" ALIGN="center" VALIGN="top"><A  HREF="ref.runkit.html" ACCESSKEY="U">上一级</A></TD><TD  WIDTH="33%" ALIGN="right" VALIGN="top">runkit_class_adopt</TD></TR></TABLE></TD></TR></TABLE></DIV></TD></TR></TABLE>

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->
E></TD></TR></TABLE></DIV></TD></TR></TABLE>

<!-- tail-start -->
﻿
<div style="clear:both;"></div>

</div>
<!--end of file-wrpper-->
</div>
<!--end of content-wrapper-->
</div>
<!--end of container-->


<footer>
<p class="copyright">版权所有 2014 <a href="http://www.iteedu.com">ITEEDU</a>, 京ICP备16069454号</p>
</footer>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>

<!--百度统计js-->
<p style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fa5213b08a76d4fc6b8a80eb382490e0b' type='text/javascript'%3E%3C/script%3E"));
</script>
</p>

</body>

</html>


<!-- tail-end -->
